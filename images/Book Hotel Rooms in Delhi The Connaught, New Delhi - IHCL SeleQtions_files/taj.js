(()=>{var wl=Object.create;var ut=Object.defineProperty,Dl=Object.defineProperties,Ra=Object.getOwnPropertyDescriptor,Sl=Object.getOwnPropertyDescriptors,Pl=Object.getOwnPropertyNames,zr=Object.getOwnPropertySymbols,Al=Object.getPrototypeOf,is=Object.prototype.hasOwnProperty,ka=Object.prototype.propertyIsEnumerable;var Ea=(r,e,t)=>e in r?ut(r,e,{enumerable:!0,configurable:!0,writable:!0,value:t}):r[e]=t,m=(r,e)=>{for(var t in e||(e={}))is.call(e,t)&&Ea(r,t,e[t]);if(zr)for(var t of zr(e))ka.call(e,t)&&Ea(r,t,e[t]);return r},S=(r,e)=>Dl(r,Sl(e)),Tl=r=>ut(r,"__esModule",{value:!0}),s=(r,e)=>ut(r,"name",{value:e,configurable:!0});var Ma=(r,e)=>{var t={};for(var n in r)is.call(r,n)&&e.indexOf(n)<0&&(t[n]=r[n]);if(r!=null&&zr)for(var n of zr(r))e.indexOf(n)<0&&ka.call(r,n)&&(t[n]=r[n]);return t};var y=(r,e)=>()=>(e||r((e={exports:{}}).exports,e),e.exports);var Cl=(r,e,t)=>{if(e&&typeof e=="object"||typeof e=="function")for(let n of Pl(e))!is.call(r,n)&&n!=="default"&&ut(r,n,{get:()=>e[n],enumerable:!(t=Ra(e,n))||t.enumerable});return r},P=r=>Cl(Tl(ut(r!=null?wl(Al(r)):{},"default",r&&r.__esModule&&"default"in r?{get:()=>r.default,enumerable:!0}:{value:r,enumerable:!0})),r),je=(r,e,t,n)=>{for(var i=n>1?void 0:n?Ra(e,t):e,a=r.length-1,o;a>=0;a--)(o=r[a])&&(i=(n?o(e,t,i):o(i))||i);return n&&i&&ut(e,t,i),i};var f=(r,e,t)=>new Promise((n,i)=>{var a=u=>{try{c(t.next(u))}catch(l){i(l)}},o=u=>{try{c(t.throw(u))}catch(l){i(l)}},c=u=>u.done?n(u.value):Promise.resolve(u.value).then(a,o);c((t=t.apply(r,e)).next())});var A=y((Qm,Yr)=>{var Na,La,Ka,Ua,$a,Ha,Ba,Ga,za,Vr,ss,Wa,Va,Ja,dt,Ya,Za,Xa,Qa,eo,to,ro,no,io,Jr;(function(r){var e=typeof global=="object"?global:typeof self=="object"?self:typeof this=="object"?this:{};typeof define=="function"&&undefined?define("tslib",["exports"],function(n){r(t(e,t(n)))}):typeof Yr=="object"&&typeof Yr.exports=="object"?r(t(e,t(Yr.exports))):r(t(e));function t(n,i){return n!==e&&(typeof Object.create=="function"?Object.defineProperty(n,"__esModule",{value:!0}):n.__esModule=!0),function(a,o){return n[a]=i?i(a,o):o}}s(t,"createExporter")})(function(r){var e=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(n,i){n.__proto__=i}||function(n,i){for(var a in i)Object.prototype.hasOwnProperty.call(i,a)&&(n[a]=i[a])};Na=s(function(n,i){if(typeof i!="function"&&i!==null)throw new TypeError("Class extends value "+String(i)+" is not a constructor or null");e(n,i);function a(){this.constructor=n}s(a,"__"),n.prototype=i===null?Object.create(i):(a.prototype=i.prototype,new a)},"__extends"),La=Object.assign||function(n){for(var i,a=1,o=arguments.length;a<o;a++){i=arguments[a];for(var c in i)Object.prototype.hasOwnProperty.call(i,c)&&(n[c]=i[c])}return n},Ka=s(function(n,i){var a={};for(var o in n)Object.prototype.hasOwnProperty.call(n,o)&&i.indexOf(o)<0&&(a[o]=n[o]);if(n!=null&&typeof Object.getOwnPropertySymbols=="function")for(var c=0,o=Object.getOwnPropertySymbols(n);c<o.length;c++)i.indexOf(o[c])<0&&Object.prototype.propertyIsEnumerable.call(n,o[c])&&(a[o[c]]=n[o[c]]);return a},"__rest"),Ua=s(function(n,i,a,o){var c=arguments.length,u=c<3?i:o===null?o=Object.getOwnPropertyDescriptor(i,a):o,l;if(typeof Reflect=="object"&&typeof Reflect.decorate=="function")u=Reflect.decorate(n,i,a,o);else for(var h=n.length-1;h>=0;h--)(l=n[h])&&(u=(c<3?l(u):c>3?l(i,a,u):l(i,a))||u);return c>3&&u&&Object.defineProperty(i,a,u),u},"__decorate"),$a=s(function(n,i){return function(a,o){i(a,o,n)}},"__param"),Ha=s(function(n,i){if(typeof Reflect=="object"&&typeof Reflect.metadata=="function")return Reflect.metadata(n,i)},"__metadata"),Ba=s(function(n,i,a,o){function c(u){return u instanceof a?u:new a(function(l){l(u)})}return s(c,"adopt"),new(a||(a=Promise))(function(u,l){function h(_){try{g(o.next(_))}catch(re){l(re)}}s(h,"fulfilled");function D(_){try{g(o.throw(_))}catch(re){l(re)}}s(D,"rejected");function g(_){_.done?u(_.value):c(_.value).then(h,D)}s(g,"step"),g((o=o.apply(n,i||[])).next())})},"__awaiter"),Ga=s(function(n,i){var a={label:0,sent:function(){if(u[0]&1)throw u[1];return u[1]},trys:[],ops:[]},o,c,u,l;return l={next:h(0),throw:h(1),return:h(2)},typeof Symbol=="function"&&(l[Symbol.iterator]=function(){return this}),l;function h(g){return function(_){return D([g,_])}}function D(g){if(o)throw new TypeError("Generator is already executing.");for(;a;)try{if(o=1,c&&(u=g[0]&2?c.return:g[0]?c.throw||((u=c.return)&&u.call(c),0):c.next)&&!(u=u.call(c,g[1])).done)return u;switch(c=0,u&&(g=[g[0]&2,u.value]),g[0]){case 0:case 1:u=g;break;case 4:return a.label++,{value:g[1],done:!1};case 5:a.label++,c=g[1],g=[0];continue;case 7:g=a.ops.pop(),a.trys.pop();continue;default:if(u=a.trys,!(u=u.length>0&&u[u.length-1])&&(g[0]===6||g[0]===2)){a=0;continue}if(g[0]===3&&(!u||g[1]>u[0]&&g[1]<u[3])){a.label=g[1];break}if(g[0]===6&&a.label<u[1]){a.label=u[1],u=g;break}if(u&&a.label<u[2]){a.label=u[2],a.ops.push(g);break}u[2]&&a.ops.pop(),a.trys.pop();continue}g=i.call(n,a)}catch(_){g=[6,_],c=0}finally{o=u=0}if(g[0]&5)throw g[1];return{value:g[0]?g[1]:void 0,done:!0}}},"__generator"),za=s(function(n,i){for(var a in n)a!=="default"&&!Object.prototype.hasOwnProperty.call(i,a)&&Jr(i,n,a)},"__exportStar"),Jr=Object.create?function(n,i,a,o){o===void 0&&(o=a);var c=Object.getOwnPropertyDescriptor(i,a);(!c||("get"in c?!i.__esModule:c.writable||c.configurable))&&(c={enumerable:!0,get:function(){return i[a]}}),Object.defineProperty(n,o,c)}:function(n,i,a,o){o===void 0&&(o=a),n[o]=i[a]},Vr=s(function(n){var i=typeof Symbol=="function"&&Symbol.iterator,a=i&&n[i],o=0;if(a)return a.call(n);if(n&&typeof n.length=="number")return{next:function(){return n&&o>=n.length&&(n=void 0),{value:n&&n[o++],done:!n}}};throw new TypeError(i?"Object is not iterable.":"Symbol.iterator is not defined.")},"__values"),ss=s(function(n,i){var a=typeof Symbol=="function"&&n[Symbol.iterator];if(!a)return n;var o=a.call(n),c,u=[],l;try{for(;(i===void 0||i-- >0)&&!(c=o.next()).done;)u.push(c.value)}catch(h){l={error:h}}finally{try{c&&!c.done&&(a=o.return)&&a.call(o)}finally{if(l)throw l.error}}return u},"__read"),Wa=s(function(){for(var n=[],i=0;i<arguments.length;i++)n=n.concat(ss(arguments[i]));return n},"__spread"),Va=s(function(){for(var n=0,i=0,a=arguments.length;i<a;i++)n+=arguments[i].length;for(var o=Array(n),c=0,i=0;i<a;i++)for(var u=arguments[i],l=0,h=u.length;l<h;l++,c++)o[c]=u[l];return o},"__spreadArrays"),Ja=s(function(n,i,a){if(a||arguments.length===2)for(var o=0,c=i.length,u;o<c;o++)(u||!(o in i))&&(u||(u=Array.prototype.slice.call(i,0,o)),u[o]=i[o]);return n.concat(u||Array.prototype.slice.call(i))},"__spreadArray"),dt=s(function(n){return this instanceof dt?(this.v=n,this):new dt(n)},"__await"),Ya=s(function(n,i,a){if(!Symbol.asyncIterator)throw new TypeError("Symbol.asyncIterator is not defined.");var o=a.apply(n,i||[]),c,u=[];return c={},l("next"),l("throw"),l("return"),c[Symbol.asyncIterator]=function(){return this},c;function l(q){o[q]&&(c[q]=function(Se){return new Promise(function(ns,xl){u.push([q,Se,ns,xl])>1||h(q,Se)})})}function h(q,Se){try{D(o[q](Se))}catch(ns){re(u[0][3],ns)}}function D(q){q.value instanceof dt?Promise.resolve(q.value.v).then(g,_):re(u[0][2],q)}function g(q){h("next",q)}function _(q){h("throw",q)}function re(q,Se){q(Se),u.shift(),u.length&&h(u[0][0],u[0][1])}},"__asyncGenerator"),Za=s(function(n){var i,a;return i={},o("next"),o("throw",function(c){throw c}),o("return"),i[Symbol.iterator]=function(){return this},i;function o(c,u){i[c]=n[c]?function(l){return(a=!a)?{value:dt(n[c](l)),done:c==="return"}:u?u(l):l}:u}},"__asyncDelegator"),Xa=s(function(n){if(!Symbol.asyncIterator)throw new TypeError("Symbol.asyncIterator is not defined.");var i=n[Symbol.asyncIterator],a;return i?i.call(n):(n=typeof Vr=="function"?Vr(n):n[Symbol.iterator](),a={},o("next"),o("throw"),o("return"),a[Symbol.asyncIterator]=function(){return this},a);function o(u){a[u]=n[u]&&function(l){return new Promise(function(h,D){l=n[u](l),c(h,D,l.done,l.value)})}}function c(u,l,h,D){Promise.resolve(D).then(function(g){u({value:g,done:h})},l)}},"__asyncValues"),Qa=s(function(n,i){return Object.defineProperty?Object.defineProperty(n,"raw",{value:i}):n.raw=i,n},"__makeTemplateObject");var t=Object.create?function(n,i){Object.defineProperty(n,"default",{enumerable:!0,value:i})}:function(n,i){n.default=i};eo=s(function(n){if(n&&n.__esModule)return n;var i={};if(n!=null)for(var a in n)a!=="default"&&Object.prototype.hasOwnProperty.call(n,a)&&Jr(i,n,a);return t(i,n),i},"__importStar"),to=s(function(n){return n&&n.__esModule?n:{default:n}},"__importDefault"),ro=s(function(n,i,a,o){if(a==="a"&&!o)throw new TypeError("Private accessor was defined without a getter");if(typeof i=="function"?n!==i||!o:!i.has(n))throw new TypeError("Cannot read private member from an object whose class did not declare it");return a==="m"?o:a==="a"?o.call(n):o?o.value:i.get(n)},"__classPrivateFieldGet"),no=s(function(n,i,a,o,c){if(o==="m")throw new TypeError("Private method is not writable");if(o==="a"&&!c)throw new TypeError("Private accessor was defined without a setter");if(typeof i=="function"?n!==i||!c:!i.has(n))throw new TypeError("Cannot write private member to an object whose class did not declare it");return o==="a"?c.call(n,a):c?c.value=a:i.set(n,a),a},"__classPrivateFieldSet"),io=s(function(n,i){if(i===null||typeof i!="object"&&typeof i!="function")throw new TypeError("Cannot use 'in' operator on non-object");return typeof n=="function"?i===n:n.has(i)},"__classPrivateFieldIn"),r("__extends",Na),r("__assign",La),r("__rest",Ka),r("__decorate",Ua),r("__param",$a),r("__metadata",Ha),r("__awaiter",Ba),r("__generator",Ga),r("__exportStar",za),r("__createBinding",Jr),r("__values",Vr),r("__read",ss),r("__spread",Wa),r("__spreadArrays",Va),r("__spreadArray",Ja),r("__await",dt),r("__asyncGenerator",Ya),r("__asyncDelegator",Za),r("__asyncValues",Xa),r("__makeTemplateObject",Qa),r("__importStar",eo),r("__importDefault",to),r("__classPrivateFieldGet",ro),r("__classPrivateFieldSet",no),r("__classPrivateFieldIn",io)})});var ir=y(pt=>{"use strict";Object.defineProperty(pt,"__esModule",{value:!0});pt.compose=pt.CompositeTransducer=void 0;var Zr=class{constructor(e,t){this.a=e,this.b=t}async_(e){return this.b.async_(this.a.async_(e))}sync(e){return this.b.sync(this.a.sync(e))}};s(Zr,"CompositeTransducer");pt.CompositeTransducer=Zr;function Ol(r,e){return new Zr(r,e)}s(Ol,"compose");pt.compose=Ol});var so=y(Xr=>{"use strict";Object.defineProperty(Xr,"__esModule",{value:!0});Xr.decompose=void 0;var Il=ir();function*as(r){r instanceof Il.CompositeTransducer?(yield*as(r.a),yield*as(r.b)):yield r}s(as,"decompose");Xr.decompose=as});var G=y(w=>{"use strict";Object.defineProperty(w,"__esModule",{value:!0});w.syncReturned=w.asyncReturned=w.isReturned=w.isYielded=w.AsyncIteratorHandler=w.by=w.toAsyncIterable=w.isArrayLike=w.asyncIterable=w.iterable=w.toIterable=w.isPromiseLike=w.isAsyncIterable=w.isIterable=w.value=w.key=w.comparators=w.descending=w.ascending=void 0;var Ne=A();function Qr(r,e){return r<e?-1:r>e?1:0}s(Qr,"ascending");w.ascending=Qr;function Rl(r,e){return r<e?1:r>e?-1:0}s(Rl,"descending");w.descending=Rl;function kl(...r){return(e,t)=>{for(let n of r){let i=n(e,t);if(i!=0)return i}return 0}}s(kl,"comparators");w.comparators=kl;function El(r){return Object.assign(e=>e[r],{name:r})}s(El,"key");w.key=El;function Ml(r){return e=>e[r]}s(Ml,"value");w.value=Ml;function ql(r){return typeof r=="object"&&Symbol.iterator in r}s(ql,"isIterable");w.isIterable=ql;function Fl(r){return typeof r=="object"&&Symbol.asyncIterator in r}s(Fl,"isAsyncIterable");w.isAsyncIterable=Fl;function jl(r){return typeof r=="object"&&"then"in r}s(jl,"isPromiseLike");w.isPromiseLike=jl;function Nl(...r){return r}s(Nl,"toIterable");w.toIterable=Nl;function*Ll(r){for(let e=0;e<r.length;e++)yield r[e]}s(Ll,"iterable");w.iterable=Ll;function Kl(r){return Ne.__asyncGenerator(this,arguments,s(function*(){for(let t of r)yield yield Ne.__await(t)},"asyncIterable_1"))}s(Kl,"asyncIterable");w.asyncIterable=Kl;function Ul(r){return typeof r=="object"&&typeof r.length=="number"}s(Ul,"isArrayLike");w.isArrayLike=Ul;function $l(r){return Ne.__asyncGenerator(this,arguments,s(function*(){yield yield Ne.__await(r)},"toAsyncIterable_1"))}s($l,"toAsyncIterable");w.toAsyncIterable=$l;function Hl(r,e=Qr){return typeof r=="function"?Gl(r,e):Bl(r,e)}s(Hl,"by");w.by=Hl;function Bl(r,e=Qr){return(t,n)=>e(t[r],n[r])}s(Bl,"byKey");function Gl(r,e=Qr){return(t,n)=>e(r(t),r(n))}s(Gl,"byFn");var os=class{constructor(){this.handlers=[],this.state=[]}value(e){this.newState({value:e,done:!1})}error(e){this.newState(e)}close(e){this.newState({value:e,done:!0})}[Symbol.asyncIterator](){return this}next(){return new Promise((e,t)=>{this.newHandler([e,t])})}newState(e){let t=this.handlers.shift();if(typeof t=="undefined")return this.state.push(e);let n=this.state.shift();if(typeof n=="undefined")return this.consume(e,t);this.consume(n,t),this.newState(e)}newHandler(e){let t=this.state.shift();if(typeof t=="undefined")return this.handlers.push(e);let n=this.handlers.shift();if(typeof n=="undefined")return this.consume(t,e);this.consume(t,n),this.newHandler(e)}consume(e,[t,n]){e instanceof Error?n(e):t(e)}};s(os,"AsyncIteratorHandler");w.AsyncIteratorHandler=os;function zl(r){return r&&typeof r=="object"&&"yielded"in r}s(zl,"isYielded");w.isYielded=zl;function Wl(r){return r&&typeof r=="object"&&"returned"in r}s(Wl,"isReturned");w.isReturned=Wl;function Vl(r){return Ne.__asyncGenerator(this,arguments,s(function*(){for(;;){let{value:t,done:n}=yield Ne.__await(r.next());if(n){yield yield Ne.__await({returned:t});break}else yield yield Ne.__await({yielded:t})}},"asyncReturned_1"))}s(Vl,"asyncReturned");w.asyncReturned=Vl;function*Jl(r){for(;;){let{value:e,done:t}=r.next();if(t){yield{returned:e};break}else yield{yielded:e}}}s(Jl,"syncReturned");w.syncReturned=Jl});var ao=y(mt=>{"use strict";Object.defineProperty(mt,"__esModule",{value:!0});mt.dedupe=mt.DedupeTransducer=void 0;var ft=A(),Yl=G(),en=class{constructor(e){this.comparator=e}async_(e){return ft.__asyncGenerator(this,arguments,s(function*(){var n,i;let a;try{for(var o=ft.__asyncValues(e),c;c=yield ft.__await(o.next()),!c.done;){let u=c.value;typeof a=="undefined"?yield yield ft.__await(u):this.comparator(u,a)!==0&&(yield yield ft.__await(u)),a=u}}catch(u){n={error:u}}finally{try{c&&!c.done&&(i=o.return)&&(yield ft.__await(i.call(o)))}finally{if(n)throw n.error}}},"async_1"))}*sync(e){let t;for(let n of e)typeof t=="undefined"?yield n:this.comparator(n,t)!==0&&(yield n),t=n}};s(en,"DedupeTransducer");mt.DedupeTransducer=en;function Zl(r=Yl.ascending){return new en(r)}s(Zl,"dedupe");mt.dedupe=Zl});var oo=y(yt=>{"use strict";Object.defineProperty(yt,"__esModule",{value:!0});yt.drop=yt.DropTransducer=void 0;var sr=A(),tn=class{constructor(e){if(this.count=e,typeof e=="undefined")throw new Error("Count can not be undefined")}async_(e){return sr.__asyncGenerator(this,arguments,s(function*(){var n,i;try{for(var a=sr.__asyncValues(e),o;o=yield sr.__await(a.next()),!o.done;){let c=o.value;--this.count<0&&(yield yield sr.__await(c))}}catch(c){n={error:c}}finally{try{o&&!o.done&&(i=a.return)&&(yield sr.__await(i.call(a)))}finally{if(n)throw n.error}}},"async_1"))}*sync(e){for(let t of e)--this.count<0&&(yield t)}};s(tn,"DropTransducer");yt.DropTransducer=tn;function Xl(r){return new tn(r)}s(Xl,"drop");yt.drop=Xl});var co=y(gt=>{"use strict";Object.defineProperty(gt,"__esModule",{value:!0});gt.dropWhile=gt.DropWhileTransducer=void 0;var ar=A(),rn=class{constructor(e){this.predicate=e}async_(e){return ar.__asyncGenerator(this,arguments,s(function*(){var n,i;let a=!0;try{for(var o=ar.__asyncValues(e),c;c=yield ar.__await(o.next()),!c.done;){let u=c.value;a&&(a=this.predicate(u)),a||(yield yield ar.__await(u))}}catch(u){n={error:u}}finally{try{c&&!c.done&&(i=o.return)&&(yield ar.__await(i.call(o)))}finally{if(n)throw n.error}}},"async_1"))}*sync(e){let t=!0;for(let n of e)t&&(t=this.predicate(n)),t||(yield n)}};s(rn,"DropWhileTransducer");gt.DropWhileTransducer=rn;function Ql(r){return new rn(r)}s(Ql,"dropWhile");gt.dropWhile=Ql});var sn=y(Le=>{"use strict";Object.defineProperty(Le,"__esModule",{value:!0});Le.accept=Le.filter=Le.FilterTransducer=void 0;var or=A(),nn=class{constructor(e){this.predicate=e}async_(e){return or.__asyncGenerator(this,arguments,s(function*(){var n,i;try{for(var a=or.__asyncValues(e),o;o=yield or.__await(a.next()),!o.done;){let c=o.value;this.predicate(c)&&(yield yield or.__await(c))}}catch(c){n={error:c}}finally{try{o&&!o.done&&(i=a.return)&&(yield or.__await(i.call(a)))}finally{if(n)throw n.error}}},"async_1"))}*sync(e){for(let t of e)this.predicate(t)&&(yield t)}};s(nn,"FilterTransducer");Le.FilterTransducer=nn;function uo(r){return new nn(r)}s(uo,"filter");Le.filter=uo;Le.accept=uo});var cs=y(bt=>{"use strict";Object.defineProperty(bt,"__esModule",{value:!0});bt.first=bt.FirstTransducer=void 0;var ht=A(),an=class{async_(e){return ht.__asyncGenerator(this,arguments,s(function*(){var n,i;try{for(var a=ht.__asyncValues(e),o;o=yield ht.__await(a.next()),!o.done;){let c=o.value;return yield ht.__await(yield yield ht.__await(c))}}catch(c){n={error:c}}finally{try{o&&!o.done&&(i=a.return)&&(yield ht.__await(i.call(a)))}finally{if(n)throw n.error}}},"async_1"))}*sync(e){for(let t of e)return yield t}};s(an,"FirstTransducer");bt.FirstTransducer=an;function ed(){return new an}s(ed,"first");bt.first=ed});var lo=y(on=>{"use strict";Object.defineProperty(on,"__esModule",{value:!0});on.find=void 0;var td=sn(),rd=cs(),nd=ir();function id(r){return(0,nd.compose)((0,td.filter)(r),(0,rd.first)())}s(id,"find");on.find=id});var po=y(vt=>{"use strict";Object.defineProperty(vt,"__esModule",{value:!0});vt.flatMap=vt.FlatMapTransducer=void 0;var Ye=A(),cn=class{constructor(e){this.mapper=e}async_(e){return Ye.__asyncGenerator(this,arguments,s(function*(){var n,i;try{for(var a=Ye.__asyncValues(e),o;o=yield Ye.__await(a.next()),!o.done;){let c=o.value;yield Ye.__await(yield*Ye.__asyncDelegator(Ye.__asyncValues(this.mapper(c))))}}catch(c){n={error:c}}finally{try{o&&!o.done&&(i=a.return)&&(yield Ye.__await(i.call(a)))}finally{if(n)throw n.error}}},"async_1"))}*sync(e){for(let t of e)yield*this.mapper(t)}};s(cn,"FlatMapTransducer");vt.FlatMapTransducer=cn;function sd(r){return new cn(r)}s(sd,"flatMap");vt.flatMap=sd});var mo=y(Ke=>{"use strict";Object.defineProperty(Ke,"__esModule",{value:!0});Ke.transducer=Ke.identity=Ke.IdentityTransducer=void 0;var un=class{async_(e){return e}sync(e){return e}};s(un,"IdentityTransducer");Ke.IdentityTransducer=un;function fo(){return new un}s(fo,"identity");Ke.identity=fo;Ke.transducer=fo});var us=y(xt=>{"use strict";Object.defineProperty(xt,"__esModule",{value:!0});xt.last=xt.LastTransducer=void 0;var cr=A(),ln=class{async_(e){return cr.__asyncGenerator(this,arguments,s(function*(){var n,i;let a;try{for(var o=cr.__asyncValues(e),c;c=yield cr.__await(o.next()),!c.done;)a=c.value}catch(u){n={error:u}}finally{try{c&&!c.done&&(i=o.return)&&(yield cr.__await(i.call(o)))}finally{if(n)throw n.error}}a!==void 0&&(yield yield cr.__await(a))},"async_1"))}*sync(e){let t;for(t of e);t!==void 0&&(yield t)}};s(ln,"LastTransducer");xt.LastTransducer=ln;function ad(){return new ln}s(ad,"last");xt.last=ad});var yo=y(wt=>{"use strict";Object.defineProperty(wt,"__esModule",{value:!0});wt.map=wt.MapTransducer=void 0;var ur=A(),dn=class{constructor(e){this.mapper=e}async_(e){return ur.__asyncGenerator(this,arguments,s(function*(){var n,i;try{for(var a=ur.__asyncValues(e),o;o=yield ur.__await(a.next()),!o.done;){let c=o.value;yield yield ur.__await(this.mapper(c))}}catch(c){n={error:c}}finally{try{o&&!o.done&&(i=a.return)&&(yield ur.__await(i.call(a)))}finally{if(n)throw n.error}}},"async_1"))}*sync(e){for(let t of e)yield this.mapper(t)}};s(dn,"MapTransducer");wt.MapTransducer=dn;function od(r){return new dn(r)}s(od,"map");wt.map=od});var ls=y(St=>{"use strict";Object.defineProperty(St,"__esModule",{value:!0});St.scan=St.ScanTransducer=void 0;var Dt=A(),pn=class{constructor(e,t){this.reducer=e,this.seed=t}async_(e){return Dt.__asyncGenerator(this,arguments,s(function*(){var n,i;let a=this.seed;yield yield Dt.__await(a);try{for(var o=Dt.__asyncValues(e),c;c=yield Dt.__await(o.next()),!c.done;){let u=c.value;yield yield Dt.__await(a=this.reducer(a,u))}}catch(u){n={error:u}}finally{try{c&&!c.done&&(i=o.return)&&(yield Dt.__await(i.call(o)))}finally{if(n)throw n.error}}},"async_1"))}*sync(e){let t=this.seed;yield t;for(let n of e)yield t=this.reducer(t,n)}};s(pn,"ScanTransducer");St.ScanTransducer=pn;function cd(r,e){return new pn(r,e)}s(cd,"scan");St.scan=cd});var go=y(fn=>{"use strict";Object.defineProperty(fn,"__esModule",{value:!0});fn.reduce=void 0;var ud=ir(),ld=us(),dd=ls();function pd(r,e){return(0,ud.compose)((0,dd.scan)(r,e),(0,ld.last)())}s(pd,"reduce");fn.reduce=pd});var ho=y(mn=>{"use strict";Object.defineProperty(mn,"__esModule",{value:!0});mn.reject=void 0;var fd=sn();function md(r){return new fd.FilterTransducer(e=>!r(e))}s(md,"reject");mn.reject=md});var bo=y(Pe=>{"use strict";Object.defineProperty(Pe,"__esModule",{value:!0});Pe.sum=Pe.subtract=Pe.add=Pe.increment=void 0;function yd(r){return r+1}s(yd,"increment");Pe.increment=yd;function gd(r,e){return e===void 0?t=>r+t:r+e}s(gd,"add");Pe.add=gd;function hd(r,e){return e===void 0?t=>t-r:r-e}s(hd,"subtract");Pe.subtract=hd;var bd=s((r,e)=>r+e,"sum");Pe.sum=bd});var Pt=y(Z=>{"use strict";Object.defineProperty(Z,"__esModule",{value:!0});Z.AsyncSequence=Z.Sequence=Z.sequence=Z.range=Z.repeat=Z.iterate=void 0;var ds=bo(),ps=G(),vo=z();function*yn(r,e){for(;;)yield e,e=r(e)}s(yn,"iterate");Z.iterate=yn;function*vd(r){for(;;)yield r()}s(vd,"repeat");Z.repeat=vd;function*xd(r,e,t=1){if(t===0)throw new Error("step can not be 0");if(e===void 0)yield*yn((0,ds.add)(t),r);else{let n=Math.abs(t);e<r?yield*fs(yn((0,ds.subtract)(n),r),(0,vo.takeWhile)(i=>i>=e)):yield*fs(yn((0,ds.add)(n),r),(0,vo.takeWhile)(i=>i<=e))}}s(xd,"range");Z.range=xd;function fs(r,...e){return(0,ps.isIterable)(r)?new lr(r,e):(0,ps.isArrayLike)(r)?new lr((0,ps.iterable)(r),e):new gn(r,e)}s(fs,"sequence");Z.sequence=fs;var lr=class{constructor(e,t){this.source=e,this.transducers=t}[Symbol.iterator](){return this.transducers.reduce((e,t)=>t.sync(e),this.source)[Symbol.iterator]()}};s(lr,"Sequence");Z.Sequence=lr;var gn=class{constructor(e,t){this.source=e,this.transducers=t}[Symbol.asyncIterator](){return this.transducers.reduce((e,t)=>t.async_(e),this.source)[Symbol.asyncIterator]()}};s(gn,"AsyncSequence");Z.AsyncSequence=gn});var Do=y(hn=>{"use strict";Object.defineProperty(hn,"__esModule",{value:!0});hn.single=void 0;var xo=A(),wd=G(),wo=Pt();function Dd(r,...e){return(0,wd.isIterable)(r)?Sd((0,wo.sequence)(r,...e)):Pd((0,wo.sequence)(r,...e))}s(Dd,"single");hn.single=Dd;function Sd(r){for(let e of r)return e;throw new Error("Expected a single value")}s(Sd,"toSingle");function Pd(r){var e,t,n,i;return xo.__awaiter(this,void 0,void 0,function*(){try{for(e=xo.__asyncValues(r);t=yield e.next(),!t.done;)return t.value}catch(a){n={error:a}}finally{try{t&&!t.done&&(i=e.return)&&(yield i.call(e))}finally{if(n)throw n.error}}throw new Error("Expected a single value")})}s(Pd,"toSinglePromise")});var ne=y(bn=>{"use strict";Object.defineProperty(bn,"__esModule",{value:!0});bn.array=void 0;var So=A(),Po=G(),Ao=Pt();function Ad(r,...e){return(0,Po.isIterable)(r)||(0,Po.isArrayLike)(r)?Td((0,Ao.sequence)(r,...e)):Cd((0,Ao.sequence)(r,...e))}s(Ad,"array");bn.array=Ad;function Td(r){let e=[];for(let t of r)e.push(t);return e}s(Td,"toArray");function Cd(r){var e,t,n,i;return So.__awaiter(this,void 0,void 0,function*(){let a=[];try{for(e=So.__asyncValues(r);t=yield e.next(),!t.done;){let o=t.value;a.push(o)}}catch(o){n={error:o}}finally{try{t&&!t.done&&(i=e.return)&&(yield i.call(e))}finally{if(n)throw n.error}}return a})}s(Cd,"toPromiseArray")});var Co=y(At=>{"use strict";Object.defineProperty(At,"__esModule",{value:!0});At.sort=At.SortTransducer=void 0;var dr=A(),_d=G(),To=ne(),vn=class{constructor(e){this.comparator=e}async_(e){return dr.__asyncGenerator(this,arguments,s(function*(){let n=yield dr.__await((0,To.array)(e));n.sort(this.comparator),yield dr.__await(yield*dr.__asyncDelegator(dr.__asyncValues(n)))},"async_1"))}*sync(e){let t=(0,To.array)(e);t.sort(this.comparator),yield*t}};s(vn,"SortTransducer");At.SortTransducer=vn;function Od(r=_d.ascending){return new vn(r)}s(Od,"sort");At.sort=Od});var _o=y(Tt=>{"use strict";Object.defineProperty(Tt,"__esModule",{value:!0});Tt.take=Tt.TakeTransducer=void 0;var Ze=A(),xn=class{constructor(e){if(this.count=e,typeof e=="undefined")throw new Error("Count can not be undefined")}async_(e){return Ze.__asyncGenerator(this,arguments,s(function*(){var n,i;if(this.count<1)return yield Ze.__await(void 0);try{for(var a=Ze.__asyncValues(e),o;o=yield Ze.__await(a.next()),!o.done;){let c=o.value;if(yield yield Ze.__await(c),--this.count<1)return yield Ze.__await(void 0)}}catch(c){n={error:c}}finally{try{o&&!o.done&&(i=a.return)&&(yield Ze.__await(i.call(a)))}finally{if(n)throw n.error}}},"async_1"))}*sync(e){if(!(this.count<1)){for(let t of e)if(yield t,--this.count<1)return}}};s(xn,"TakeTransducer");Tt.TakeTransducer=xn;function Id(r){return new xn(r)}s(Id,"take");Tt.take=Id});var Oo=y(_t=>{"use strict";Object.defineProperty(_t,"__esModule",{value:!0});_t.takeWhile=_t.TakeWhileTransducer=void 0;var Ct=A(),wn=class{constructor(e){this.predicate=e}async_(e){return Ct.__asyncGenerator(this,arguments,s(function*(){var n,i;try{for(var a=Ct.__asyncValues(e),o;o=yield Ct.__await(a.next()),!o.done;){let c=o.value;if(this.predicate(c))yield yield Ct.__await(c);else return yield Ct.__await(void 0)}}catch(c){n={error:c}}finally{try{o&&!o.done&&(i=a.return)&&(yield Ct.__await(i.call(a)))}finally{if(n)throw n.error}}},"async_1"))}*sync(e){for(let t of e)if(this.predicate(t))yield t;else return}};s(wn,"TakeWhileTransducer");_t.TakeWhileTransducer=wn;function Rd(r){return new wn(r)}s(Rd,"takeWhile");_t.takeWhile=Rd});var Ro=y(Io=>{"use strict";Object.defineProperty(Io,"__esModule",{value:!0})});var Re=y(Ue=>{"use strict";Object.defineProperty(Ue,"__esModule",{value:!0});Ue.container=Ue.lazy=Ue.replace=void 0;function ko(r,e,t){return Object.defineProperty(r,e,{value:t})}s(ko,"replace");Ue.replace=ko;function Eo(r,e,t){if(typeof t.get=="undefined")throw new Error("@lazy can only decorate getter methods");return Object.defineProperty(r,e,Object.assign(Object.assign({},t),{get(){return ko(this,e,t.get.call(this))[e]}}))}s(Eo,"lazy");Ue.lazy=Eo;function kd(r){return Object.keys(r).reduce((e,t)=>Eo(e,t,{configurable:!0,get:()=>r[t](e)}),{})}s(kd,"container");Ue.container=kd});var gs=y(Sn=>{"use strict";Object.defineProperty(Sn,"__esModule",{value:!0});Sn.AVLTree=void 0;var Mo=A(),Dn=G(),qo=Re(),fe=class{constructor(e){this.comparator=e}static empty(e=Dn.ascending){return new ms(e)}static create(e,t,n=Dn.ascending){let i=fe.empty(n);return new ie(n,e,t,i,i)}static of(e,t=Dn.ascending){return fe.preSorted(e.sort((0,Dn.by)(0)),t,fe.empty(t))}static preSorted(e,t,n){let i=e.length;switch(i){case 0:return n;case 1:{let[[a,o]]=e;return new ie(t,a,o,n,n)}default:{let a=Math.floor(i/2),o=fe.preSorted(e.slice(0,a),t,n),c=fe.preSorted(e.slice(a+1),t,n),[u,l]=e[a];return new ie(t,u,l,o,c)}}}};s(fe,"AVLTree");Sn.AVLTree=fe;var ms=class extends fe{constructor(e){super(e);this.isEmpty=!0,this.height=0,this.balance=0}insert(e,t){return new ie(this.comparator,e,t,this,this)}contains(e){return!1}lookup(e){}delete(e){return{tree:this}}first(){}last(){}removeFirst(){return{tree:this}}removeLast(){return{tree:this}}toString(){return""}*keys(){}*values(){}*entries(){return[]}};s(ms,"Empty");var ie=class extends fe{constructor(e,t,n,i,a){super(e);this.key=t,this.value=n,this.left=i,this.right=a,this.isEmpty=!1}insert(e,t){let n=this.comparator(e,this.key);return n===0?new ie(this.comparator,e,t,this.left,this.right):n<0?this.replaceLeft(this.left.insert(e,t)):this.replaceRight(this.right.insert(e,t))}contains(e){let t=this.comparator(e,this.key);return t===0?!0:t<0?this.left.contains(e):this.right.contains(e)}lookup(e){let t=this.comparator(e,this.key);return t===0?this.value:t<0?this.left.lookup(e):this.right.lookup(e)}delete(e){let t=this.comparator(e,this.key);if(t===0){if(this.left.isEmpty)return{tree:this.right,key:this.key,value:this.value};if(this.right.isEmpty)return{tree:this.left,key:this.key,value:this.value};let{tree:o,key:c,value:u}=this.left.removeLast();return{tree:ys(new ie(this.comparator,c,u,o,this.right)),key:this.key,value:this.value}}if(t<0){let{tree:o,key:c,value:u}=this.left.delete(e);return{tree:this.replaceLeft(o),key:c,value:u}}let{tree:n,key:i,value:a}=this.right.delete(e);return{tree:this.replaceRight(n),key:i,value:a}}first(){return this.left.isEmpty?this.value:this.left.first()}last(){return this.right.isEmpty?this.value:this.right.last()}removeFirst(){if(this.left.isEmpty)return{tree:this.right,key:this.key,value:this.value};let{tree:e,key:t,value:n}=this.left.removeFirst();return{tree:this.replaceLeft(e),key:t,value:n}}removeLast(){if(this.right.isEmpty)return{tree:this.left,key:this.key,value:this.value};let{tree:e,key:t,value:n}=this.right.removeLast();return{tree:this.replaceRight(e),key:t,value:n}}replaceLeft(e){return ys(new ie(this.comparator,this.key,this.value,e,this.right))}replaceRight(e){return ys(new ie(this.comparator,this.key,this.value,this.left,e))}toString(){return`(${this.left} ${this.key}=${this.value} ${this.right})`}get balance(){return this.left.height-this.right.height}get height(){return Math.max(this.left.height,this.right.height)+1}*keys(){yield*this.left.keys(),yield this.key,yield*this.right.keys()}*values(){yield*this.left.values(),yield this.value,yield*this.right.values()}*entries(){yield*this.left.entries(),yield[this.key,this.value],yield*this.right.entries()}};s(ie,"Node");Mo.__decorate([qo.lazy],ie.prototype,"balance",null);Mo.__decorate([qo.lazy],ie.prototype,"height",null);function ys(r){let e=r.balance;return e==-2?Md(r):e==2?Ed(r):r}s(ys,"balance");function Ed(r){let e=r.left.balance;return e==-1?qd(r):e==1?Fo(r):r}s(Ed,"balanceLeft");function Md(r){let e=r.right.balance;return e==1?Fd(r):e==-1?jo(r):r}s(Md,"balanceRight");function Fo(r){return Lo(r)}s(Fo,"balanceLeftLeft");function qd(r){let e=No(r.left);return Fo(r.replaceLeft(e))}s(qd,"balanceLeftRight");function jo(r){return No(r)}s(jo,"balanceRightRight");function Fd(r){let e=Lo(r.right);return jo(r.replaceRight(e))}s(Fd,"balanceRightLeft");function No(r){let e=r.right,t=e.left,n=r.replaceRight(t);return e.replaceLeft(n)}s(No,"rotateLeft");function Lo(r){let e=r.left,t=e.right,n=r.replaceLeft(t);return e.replaceRight(n)}s(Lo,"rotateRight")});var Uo=y(Ot=>{"use strict";Object.defineProperty(Ot,"__esModule",{value:!0});Ot.unique=Ot.UniqueTransducer=void 0;var pr=A(),jd=G(),Ko=gs(),Pn=class{constructor(e){this.comparator=e}async_(e){return pr.__asyncGenerator(this,arguments,s(function*(){var n,i;let a=Ko.AVLTree.empty(this.comparator);try{for(var o=pr.__asyncValues(e),c;c=yield pr.__await(o.next()),!c.done;){let u=c.value;a.contains(u)||(a=a.insert(u,void 0),yield yield pr.__await(u))}}catch(u){n={error:u}}finally{try{c&&!c.done&&(i=o.return)&&(yield pr.__await(i.call(o)))}finally{if(n)throw n.error}}},"async_1"))}*sync(e){let t=Ko.AVLTree.empty(this.comparator);for(let n of e)t.contains(n)||(t=t.insert(n,void 0),yield n)}};s(Pn,"UniqueTransducer");Ot.UniqueTransducer=Pn;function Nd(r=jd.ascending){return new Pn(r)}s(Nd,"unique");Ot.unique=Nd});var $o=y(Rt=>{"use strict";Object.defineProperty(Rt,"__esModule",{value:!0});Rt.WindowedTransducer=Rt.windowed=void 0;var It=A();function Ld(r,e=1,t=!1){return new An(r,e,t)}s(Ld,"windowed");Rt.windowed=Ld;var An=class{constructor(e,t,n){this.size=e,this.step=t,this.remainder=n}async_(e){return It.__asyncGenerator(this,arguments,s(function*(){var n,i;let a=[],o=0;try{for(var c=It.__asyncValues(e),u;u=yield It.__await(c.next()),!u.done;){let l=u.value;if(o>0){o--;continue}a.push(l),a.length===this.size&&(yield yield It.__await([...a]),a=a.slice(this.step),this.step>this.size&&(o=this.step-this.size))}}catch(l){n={error:l}}finally{try{u&&!u.done&&(i=c.return)&&(yield It.__await(i.call(c)))}finally{if(n)throw n.error}}this.remainder&&(yield yield It.__await([...a]))},"async_1"))}*sync(e){let t=[],n=0;for(let i of e){if(n>0){n--;continue}t.push(i),t.length===this.size&&(yield[...t],t=t.slice(this.step),this.step>this.size&&(n=this.step-this.size))}this.remainder&&(yield[...t])}};s(An,"WindowedTransducer");Rt.WindowedTransducer=An});var Bo=y($e=>{"use strict";Object.defineProperty($e,"__esModule",{value:!0});$e.zipWithIndex=$e.zip=$e.ZipTransducer=void 0;var Tn=A(),Ho=G(),Kd=Pt(),fr=class{constructor(e){this.other=e}async_(e){return Tn.__asyncGenerator(this,arguments,s(function*(){if(!(0,Ho.isAsyncIterable)(this.other))throw new Error("Unsupported operation exception");let n=e[Symbol.asyncIterator](),i=this.other[Symbol.asyncIterator]();for(;;){let[a,o]=yield Tn.__await(Promise.all([n.next(),i.next()]));if(a.done||o.done)return yield Tn.__await(void 0);yield yield Tn.__await([a.value,o.value])}},"async_1"))}*sync(e){if(!(0,Ho.isIterable)(this.other))throw new Error("Unsupported operation exception");let t=e[Symbol.iterator](),n=this.other[Symbol.iterator]();for(;;){let i=t.next(),a=n.next();if(i.done||a.done)return;yield[i.value,a.value]}}};s(fr,"ZipTransducer");$e.ZipTransducer=fr;function Ud(r){return new fr(r)}s(Ud,"zip");$e.zip=Ud;function $d(){return new fr((0,Kd.range)(0))}s($d,"zipWithIndex");$e.zipWithIndex=$d});var z=y(I=>{"use strict";Object.defineProperty(I,"__esModule",{value:!0});var k=A();k.__exportStar(ir(),I);k.__exportStar(so(),I);k.__exportStar(ao(),I);k.__exportStar(oo(),I);k.__exportStar(co(),I);k.__exportStar(sn(),I);k.__exportStar(lo(),I);k.__exportStar(cs(),I);k.__exportStar(po(),I);k.__exportStar(mo(),I);k.__exportStar(us(),I);k.__exportStar(yo(),I);k.__exportStar(go(),I);k.__exportStar(ho(),I);k.__exportStar(ls(),I);k.__exportStar(Do(),I);k.__exportStar(Co(),I);k.__exportStar(_o(),I);k.__exportStar(Oo(),I);k.__exportStar(Ro(),I);k.__exportStar(Uo(),I);k.__exportStar($o(),I);k.__exportStar(Bo(),I)});var Rn=y(Et=>{"use strict";Object.defineProperty(Et,"__esModule",{value:!0});Et.StoppedClock=Et.SystemClock=void 0;var hs=class{now(){return new Date}};s(hs,"SystemClock");Et.SystemClock=hs;var bs=class{constructor(e){this.value=e}now(){return this.value}};s(bs,"StoppedClock");Et.StoppedClock=bs});var Qe=y(R=>{"use strict";Object.defineProperty(R,"__esModule",{value:!0});R.Days=R.hasNativeToParts=R.yearOf=R.dayOf=R.monthOf=R.Month=R.weekdayOf=R.Weekday=R.defaultOptions=R.date=void 0;function Zo(r,e,t){if(e&&(e<1||e>12))throw new Error(`Invalid month ${e}`);if(t&&(t<1||t>31))throw new Error(`Invalid day ${t}`);let n=new Date(Date.UTC(r,e?e-1:0,t||1));if(r!==ws(n))throw new Error(`Invalid year ${r}`);if(e&&e!==vs(n))throw new Error(`Invalid month ${e}`);if(t&&t!==xs(n))throw new Error(`Invalid day ${t}`);return n}s(Zo,"date");R.date=Zo;R.defaultOptions={year:"numeric",month:"numeric",day:"numeric",weekday:"long"};var Xo;(function(r){r[r.Monday=1]="Monday",r[r.Tuesday=2]="Tuesday",r[r.Wednesday=3]="Wednesday",r[r.Thursday=4]="Thursday",r[r.Friday=5]="Friday",r[r.Saturday=6]="Saturday",r[r.Sunday=7]="Sunday"})(Xo=R.Weekday||(R.Weekday={}));function Vd(r){let e=r.getUTCDay();return e===0?Xo.Sunday:e}s(Vd,"weekdayOf");R.weekdayOf=Vd;var Jd;(function(r){r[r.January=1]="January",r[r.February=2]="February",r[r.March=3]="March",r[r.April=4]="April",r[r.May=5]="May",r[r.June=6]="June",r[r.July=7]="July",r[r.August=8]="August",r[r.September=9]="September",r[r.October=10]="October",r[r.November=11]="November",r[r.December=12]="December"})(Jd=R.Month||(R.Month={}));function vs(r){return r.getUTCMonth()+1}s(vs,"monthOf");R.monthOf=vs;function xs(r){return r.getUTCDate()}s(xs,"dayOf");R.dayOf=xs;function ws(r){return r.getUTCFullYear()}s(ws,"yearOf");R.yearOf=ws;R.hasNativeToParts=typeof Intl.DateTimeFormat.prototype.formatToParts=="function";var Xe=class{static startOf(e){return Zo(ws(e),vs(e),xs(e))}static add(e,t){let n=new Date(e.getTime());return n.setUTCDate(e.getUTCDate()+t),n}static subtract(e,t){return Xe.add(e,t*-1)}static between(e,t){return Math.abs((e.getTime()-t.getTime())/Xe.milliseconds)}};s(Xe,"Days");R.Days=Xe;Xe.milliseconds=24*60*60*1e3});var ke=y(M=>{"use strict";Object.defineProperty(M,"__esModule",{value:!0});M.splitByRegex=M.characters=M.removeUnicodeMarkers=M.different=M.suffix=M.prefix=M.replace=M.isNonMatch=M.isNamedMatch=M.NamedRegExp=void 0;var Yd=/\(\?<([^>]+)>/g,yr=class{constructor(e,t){this.pattern=e,this.names=t}static create(e,t){let n=[],i=Qo(Yd,e,a=>(n.push(a[1]),"("));return new yr(new RegExp(i,t),n)}match(e){let t=e.match(this.pattern);return t?this.namedMatch(t):[]}namedMatch(e){return e.slice(1).map((n,i)=>({name:this.names[i],value:n}))}*exec(e){let t=new RegExp(this.pattern.source,"g");for(;;){let n=t.exec(e);if(!n)break;yield this.namedMatch(n)}}*iterate(e){let t=0,n=new RegExp(this.pattern.source,"g");for(;;){let a=n.exec(e);if(!a)break;let o=e.substring(t,a.index);o&&(yield o),yield this.namedMatch(a),t=n.lastIndex}let i=e.substring(t);i&&(yield i)}toString(){return`Pattern: ${this.pattern} Names: ${JSON.stringify(this.names)}`}toJSON(){return{pattern:this.pattern.source,names:this.names}}};s(yr,"NamedRegExp");M.NamedRegExp=yr;function Zd(r){return Array.isArray(r)}s(Zd,"isNamedMatch");M.isNamedMatch=Zd;function Xd(r){return typeof r=="string"}s(Xd,"isNonMatch");M.isNonMatch=Xd;function Qo(r,e,t,n=i=>i){let i=[],a=0,o;for(;(o=r.exec(e))!=null;)i.push(n(e.substring(a,o.index))),i.push(t(o)),a=r.lastIndex;return i.push(n(e.substring(a))),i.join("")}s(Qo,"replace");M.replace=Qo;function Ds(r,e){for(let t=0;t<r.length;t++){let n=r[t],i=e[t];if(n!=i)return t}return r.length}s(Ds,"prefix");M.prefix=Ds;function ec(r,e){return Ds([...r].reverse(),[...e].reverse())}s(ec,"suffix");M.suffix=ec;function Qd(r){let e=r.map(rc),[t,n]=e.reduce(([i,a],o,c)=>{let u=c<e.length-1?e[c+1]:e[0],l=Ds(o,u),h=ec(o,u);return[l<i?l:i,h<a?h:a]},[Number.MAX_VALUE,Number.MAX_VALUE]);return e.map(i=>i.slice(t,n?-n:void 0).join(""))}s(Qd,"different");M.different=Qd;function tc(r){return r.replace(/[\u200E\u200F]/g,"")}s(tc,"removeUnicodeMarkers");M.removeUnicodeMarkers=tc;function rc(r){return ep(tc(r))}s(rc,"characters");M.characters=rc;function ep(r){return typeof Symbol=="function"&&r[Symbol.iterator]?[...r]:nc(r)}s(ep,"split");var tp=/(?=(?:[\0-\uD7FF\uE000-\uFFFF]|[\uD800-\uDBFF][\uDC00-\uDFFF]|[\uD800-\uDBFF](?![\uDC00-\uDFFF])|(?:[^\uD800-\uDBFF]|^)[\uDC00-\uDFFF]))/;function nc(r){return r.split(tp)}s(nc,"splitByRegex");M.splitByRegex=nc});var ae=y(Mt=>{"use strict";Object.defineProperty(Mt,"__esModule",{value:!0});Mt.caching=Mt.cache=void 0;function rp(r,e,t){if(typeof t.value!="function")throw new Error("@cache can only decorate methods");let n=new WeakMap;function i(a){let o=n.get(a);if(o)return o;let c=new Map;return n.set(a,c),c}return s(i,"getCache"),Object.defineProperty(r,e,Object.assign(Object.assign({},t),{value:function(...a){let o=JSON.stringify(a),c=i(this),u=c.get(o);if(typeof u!="undefined"||c.has(o))return u;let l=t.value.call(this,...a);return c.set(o,l),l}}))}s(rp,"cache");Mt.cache=rp;function np(r){let e=new Map;return function(...t){let n=JSON.stringify(t),i=e.get(n);if(typeof i!="undefined"||e.has(n))return i;let a=r(...t);return e.set(n,a),a}}s(np,"caching");Mt.caching=np});var hr=y(F=>{"use strict";Object.defineProperty(F,"__esModule",{value:!0});F.formatData=F.format=F.valueFromParts=F.SimpleFormat=F.ImprovedDateTimeFormat=F.Formatters=F.optionsFrom=F.partsFrom=F.dateTimeFormat=void 0;var ip=A(),ic=Qe(),sp=ne(),ap=z(),Ss=ke(),op=ae();function Ps(r,e){return new Intl.DateTimeFormat(r,Object.assign(Object.assign({},e),{timeZone:"UTC"}))}s(Ps,"dateTimeFormat");F.dateTimeFormat=Ps;function cp(r,e){if(r==="year"){if(e===4)return"numeric";if(e===2)return"2-digit"}if(r==="month"){if(e===4)return"long";if(e===3)return"short";if(e===2)return"2-digit";if(e===1)return"numeric"}if(r==="day"){if(e===2)return"2-digit";if(e===1)return"numeric"}if(r==="weekday"){if(e===4)return"long";if(e===3)return"short"}throw new Error(`Illegal Argument: ${r} ${e}`)}s(cp,"formatFrom");var up=Ss.NamedRegExp.create("(?:(?<year>y+)|(?<month>M+)|(?<day>d+)|(?<weekday>E+))","g");function As(r){return(0,sp.array)(up.iterate(r),(0,ap.map)(e=>{if((0,Ss.isNamedMatch)(e)){let[t]=e.filter(a=>Boolean(a.value)),n=t.name,i=cp(n,t.value.length);return{type:n,value:i}}else return{type:"literal",value:e}}))}s(As,"partsFrom");F.partsFrom=As;function sc(r){let e=typeof r=="string"?As(r):r,t=["year","month","day","weekday"];return e.filter(n=>t.indexOf(n.type)!=-1).reduce((n,i)=>(n[i.type]=i.value,n),typeof r=="string"?{format:r}:{})}s(sc,"optionsFrom");F.optionsFrom=sc;var qt=class{static create(e,t){return typeof t=="string"?new gr(e,t):typeof t.format=="string"?new gr(e,t.format):new kn(e,t)}};s(qt,"Formatters");ip.__decorate([op.cache],qt,"create",null);F.Formatters=qt;var kn=class{constructor(e,t,n=Ps(e,t)){this.locale=e,this.options=t,this.delegate=n}format(e){return(0,Ss.removeUnicodeMarkers)(this.delegate.format(e))}formatToParts(e){return this.delegate.formatToParts(e)}};s(kn,"ImprovedDateTimeFormat");F.ImprovedDateTimeFormat=kn;var gr=class{constructor(e,t){this.locale=e,this.formatString=t,this.partsInOrder=As(t),this.options=sc(this.partsInOrder)}format(e){return this.formatToParts(e).map(t=>t.value).join("")}formatToParts(e){let t=Ps(this.locale,this.options).formatToParts(e);return this.partsInOrder.map(n=>({type:n.type,value:this.valueFor(t,n.type,n.value)}))}valueFor(e,t,n){return t==="literal"?n:ac(e,t)}};s(gr,"SimpleFormat");F.SimpleFormat=gr;function ac(r,e){return r.filter(t=>t.type===e).map(t=>t.value).join("")}s(ac,"valueFromParts");F.valueFromParts=ac;function lp(r,e,t=ic.defaultOptions){if(r==null)throw new Error("Date format requires a value");return qt.create(e,t).format(r)}s(lp,"format");F.format=lp;function dp(r,e,t=ic.defaultOptions){return qt.create(e,t).formatToParts(r)}s(dp,"formatData");F.formatData=dp});var br=y(Ft=>{"use strict";Object.defineProperty(Ft,"__esModule",{value:!0});Ft.unique=Ft.flatten=void 0;function pp(r){return r.flatMap(e=>e)}s(pp,"flatten");Ft.flatten=pp;function oc(r){return typeof r=="function"&&r.toString().includes("native code")}s(oc,"isNativeFunction");var fp=oc(Set)&&new Set([1]).size===1;function mp(r){if(oc(Array.from)&&fp)return Array.from(new Set(r));let e=[];for(let t of r)e.indexOf(t)<0&&e.push(t);return e}s(mp,"unique");Ft.unique=mp});var vr=y(jt=>{"use strict";Object.defineProperty(jt,"__esModule",{value:!0});jt.get=jt.identity=void 0;function yp(){return r=>r}s(yp,"identity");jt.identity=yp;function gp(r,e=void 0){try{let t=r();return typeof t=="undefined"?e:t}catch(t){return e}}s(gp,"get");jt.get=gp});var Nt=y(T=>{"use strict";Object.defineProperty(T,"__esModule",{value:!0});T.extraDelimiters=T.CachingParser=T.all=T.AllParser=T.parsers=T.or=T.OrParser=T.FailParser=T.IdentityParser=T.mappingParser=T.MappingParser=T.preProcess=T.PreProcessor=T.namedRegexParser=T.NamedRegexParser=void 0;var cc=A(),uc=ke(),hp=z(),lc=ae(),dc=ne(),En=class{constructor(e){this.regex=e}parse(e){let t=this.regex.match(e);if(t.length===0)throw new Error(`Generated regex ${this.regex.pattern} did not match "${e}" `);return t}parseAll(e){return(0,dc.array)(this.regex.exec(e))}};s(En,"NamedRegexParser");T.NamedRegexParser=En;function bp(r){return new En(r)}s(bp,"namedRegexParser");T.namedRegexParser=bp;var Mn=class{constructor(e,t){this.delegate=e,this.mapper=t}parse(e){return this.delegate.parse(this.mapper(e))}parseAll(e){return this.delegate.parseAll(this.mapper(e))}};s(Mn,"PreProcessor");T.PreProcessor=Mn;function vp(r,e){return new Mn(r,e)}s(vp,"preProcess");T.preProcess=vp;var qn=class{constructor(e,t){this.parser=e,this.mapper=t}parse(e){return this.mapper(this.parser.parse((0,uc.removeUnicodeMarkers)(e)))}parseAll(e){return e?(0,dc.array)(this.parser.parseAll((0,uc.removeUnicodeMarkers)(e)),(0,hp.flatMap)(t=>{try{return[this.mapper(t)]}catch(n){return[]}})):[]}};s(qn,"MappingParser");T.MappingParser=qn;function xp(r,e){return new qn(r,e)}s(xp,"mappingParser");T.mappingParser=xp;var Ts=class{parse(e){return e}parseAll(e){return[e]}};s(Ts,"IdentityParser");T.IdentityParser=Ts;var Cs=class{parse(e){throw new Error}parseAll(e){return[]}};s(Cs,"FailParser");T.FailParser=Cs;var Fn=class{constructor(e){this.parsers=e}parse(e){for(let t of this.parsers)try{let n=t.parse(e);if(n)return n}catch(n){}throw new Error(`Unable to parse value: ${e}`)}parseAll(e){for(let t of this.parsers){let n=t.parseAll(e);if(n.length>0)return n}return[]}};s(Fn,"OrParser");T.OrParser=Fn;function pc(...r){return new Fn(r)}s(pc,"or");T.or=pc;function wp(...r){return pc(...r)}s(wp,"parsers");T.parsers=wp;var jn=class{constructor(e){this.parsers=e}parse(e){throw new Error("Not supported, please call AllParser.parseAll")}parseAll(e){return this.parsers.flatMap(t=>t.parseAll(e))}};s(jn,"AllParser");T.AllParser=jn;function Dp(...r){return new jn(r)}s(Dp,"all");T.all=Dp;var xr=class{constructor(e){this.parser=e}parse(e){return this.parser.parse(e)}parseAll(e){return this.parser.parseAll(e)}};s(xr,"CachingParser");cc.__decorate([lc.cache],xr.prototype,"parse",null);cc.__decorate([lc.cache],xr.prototype,"parseAll",null);T.CachingParser=xr;T.extraDelimiters=" -/"});var wr=y(Ae=>{"use strict";Object.defineProperty(Ae,"__esModule",{value:!0});Ae.atBoundaryOnly=Ae.cleanValue=Ae.boundaryDelimiters=void 0;Ae.boundaryDelimiters=",.";var Sp=new RegExp(`[${Ae.boundaryDelimiters}]$`);function Pp(r){return r.replace(Sp,"").trim()}s(Pp,"cleanValue");Ae.cleanValue=Pp;function Ap(r){return`(?:^|\\s)${r}(?=[\\s${Ae.boundaryDelimiters}]|$)`}s(Ap,"atBoundaryOnly");Ae.atBoundaryOnly=Ap});var mc=y(V=>{"use strict";Object.defineProperty(V,"__esModule",{value:!0});V.Row=V.PrefixTree=V.DEFAULT_COMPARATOR=V.pair=V.Trie=V.TrieFactory=void 0;var Lt=A(),Kt=Re(),Tp=ke(),Cp=G(),_p=gs(),Ut=Pt(),Q=z(),et=class{constructor(e=Cp.ascending){this.comparator=e}get avlTree(){return _p.AVLTree.empty(this.comparator)}get empty(){return new He(this,void 0,this.avlTree)}create(e,t=this.avlTree){return new He(this,e,t)}construct(e,t){if(e.length===0)return this.create(t);let[n,...i]=e;return this.create(void 0,this.avlTree.insert(n,this.construct(i,t)))}};s(et,"TrieFactory");Lt.__decorate([Kt.lazy],et.prototype,"avlTree",null);Lt.__decorate([Kt.lazy],et.prototype,"empty",null);V.TrieFactory=et;var He=class{constructor(e=new et,t,n=e.avlTree){this.factory=e,this.value=t,this.children=n}contains(e){return!!this.lookup(e)}get isEmpty(){return!this.value&&this.children.isEmpty}lookup(e){if(e.length==0)return this.value;let[t,...n]=e,i=this.children.lookup(t);return i&&i.lookup(n)}match(e){if(e.length==0){let a=this.value?[this.value]:[];return(0,Q.single)(this.children.values(),(0,Q.reduce)((o,c)=>o.concat(c.match(e)),a))}let[t,...n]=e,i=this.children.lookup(t);return i?i.match(n):[]}insert(e,t){if(e.length===0)return this.factory.create(t,this.children);let[n,...i]=e,a=this.children.lookup(n);return a?a=a.insert(i,t):a=this.factory.construct(i,t),this.factory.create(this.value,this.children.insert(n,a))}delete(e){return this.insert(e,void 0)}entries(){function*e(n,[i,a]){n=[...n,i],a.value&&(yield _s(n,a.value)),yield*t(a,n)}s(e,"recurse");function t(n,i){return(0,Ut.sequence)(n.children.entries(),(0,Q.flatMap)(a=>e(i,a)))}return s(t,"recurseChildren"),t(this,[])}keys(){return(0,Ut.sequence)(this.entries(),(0,Q.map)(([e])=>e))}values(){return(0,Ut.sequence)(this.entries(),(0,Q.map)(([,e])=>e))}get height(){return(0,Q.single)(this.children.values(),(0,Q.reduce)((e,t)=>Math.max(e,t.height+1),0))}toString(){return(this.value?`(${this.value})`:"")+this.children}};s(He,"Trie");Lt.__decorate([Kt.lazy],He.prototype,"isEmpty",null);Lt.__decorate([Kt.lazy],He.prototype,"height",null);V.Trie=He;function _s(r,e){return[r,e]}s(_s,"pair");V.pair=_s;var Op=new Intl.Collator(void 0,{usage:"sort",sensitivity:"base"}).compare;V.DEFAULT_COMPARATOR=Op;var Be=class{constructor(e=Tp.characters,t=V.DEFAULT_COMPARATOR,n=new He(new et(t))){this.converter=e,this.comparator=t,this.trie=n}contains(e){return!!this.lookup(e)}get isEmpty(){return this.trie.isEmpty}match(e){return this.trie.match(this.converter(e))}lookup(e){return this.trie.lookup(this.converter(e))}insert(e,t=e){return new Be(this.converter,this.comparator,this.trie.insert(this.converter(e),t))}delete(e){return new Be(this.converter,this.comparator,this.trie.insert(this.converter(e),void 0))}entries(){return(0,Ut.sequence)(this.trie.entries(),(0,Q.map)(([e,t])=>_s(e.join(""),t)))}keys(){return(0,Ut.sequence)(this.entries(),(0,Q.map)(([e])=>e))}values(){return(0,Ut.sequence)(this.entries(),(0,Q.map)(([,e])=>e))}get height(){return this.trie.height}search(e,t){let n=tt.create(this.converter(e),this.comparator);return(0,Q.single)(this.trie.children.entries(),(0,Q.reduce)((i,[a,o])=>i.concat(fc(o,a,n,t)),[]))}};s(Be,"PrefixTree");Lt.__decorate([Kt.lazy],Be.prototype,"isEmpty",null);Lt.__decorate([Kt.lazy],Be.prototype,"height",null);V.PrefixTree=Be;function fc(r,e,t,n){let i=t.next(e),a=[];return i.distance<=n&&r.value&&a.push({value:r.value,distance:i.distance}),i.minimal<=n?(0,Q.single)(r.children.entries(),(0,Q.reduce)((o,[c,u])=>o.concat(fc(u,c,i,n)),a)):a}s(fc,"recurse");var tt=class{constructor(e,t,n){this.keys=e,this.values=t,this.comparator=n}static create(e,t){let n=[];for(let i=0;i<=e.length;i++)n[i]=i;return new tt(e,n,t)}next(e){let t=this.keys.reduce((n,i,a)=>(n[a+1]=this.comparator(i,e)===0?this.values[a]:1+Math.min(n[a],this.values[a],this.values[a+1]),n),[this.values[0]+1]);return new tt(this.keys,t,this.comparator)}get distance(){return this.values[this.keys.length]}get minimal(){return Math.min(...this.values)}};s(tt,"Row");V.Row=tt});var Dr=y(K=>{"use strict";Object.defineProperty(K,"__esModule",{value:!0});K.Weekdays=K.Months=K.numberFormatter=K.Numerals=K.numberOf=K.DatumLookup=K.uniqueMatch=void 0;var Ip=A(),yc=mc(),gc=wr(),Os=br(),Is=ke(),Rp=vr(),kp=ne(),hc=z(),Ep=Re(),Mp=ae();function bc(r,e){let t=(0,Os.flatten)(r.match(e)),n=(0,Os.unique)(t.map(i=>i.value));if(n.length==1)return n[0]}s(bc,"uniqueMatch");K.uniqueMatch=bc;var $t=class{constructor(e,t=yc.DEFAULT_COMPARATOR){this.data=e,this.prefixTree=this.data.reduce((n,i)=>{let a=n.lookup(i.name)||[];return a.push(i),n.insert(i.name,a)},new yc.PrefixTree(void 0,t))}parse(e,t=bc){let n=t(this.prefixTree,e);if(typeof n=="undefined")throw new Error(`${this.constructor.name} - Unable to parse: ${e}`);return n}get pattern(){return`[${this.characters.join("")}]{1,${this.max}}`}get max(){return this.data.reduce((e,t)=>{let n=(0,Is.characters)(t.name).length;return Math.max(e,n)},Number.MIN_VALUE)}get characters(){return(0,Os.unique)(this.data.map(e=>e.name).flatMap(Is.characters)).sort()}};s($t,"DatumLookup");K.DatumLookup=$t;function vc(r){return!r||r.trim().length===0?NaN:Number(r)}s(vc,"numberOf");K.numberOf=vc;var oe=class extends $t{constructor(e,t){super(e);this.locale=t}static get(e,t=[]){return oe.cache[e]=oe.cache[e]||oe.create(e,t)}static create(e,t=[]){return new oe([...oe.generateData(e),...t],e)}static generateData(e){let t=(0,K.numberFormatter)(e).format(1234567890).replace(/[,. ']/g,"");return(0,kp.array)((0,Is.characters)(t),(0,hc.zip)([1,2,3,4,5,6,7,8,9,0]),(0,hc.map)(([n,i])=>({name:n,value:i})))}parse(e){let t=vc(e);return isNaN(t)?super.parse(e):t}get pattern(){let e=this.characters.join("");return e==="0123456789"?"\\d":`\\d${e}`}format(e){return(0,K.numberFormatter)(this.locale).format(e)}};s(oe,"Numerals");oe.cache={};Ip.__decorate([Ep.lazy],oe.prototype,"pattern",null);K.Numerals=oe;K.numberFormatter=(0,Mp.caching)(r=>new Intl.NumberFormat(r,{useGrouping:!1}));var Rs=class extends $t{constructor(e,t){super(e);this.numerals=oe.get(t)}parse(e){let t=(0,Rp.get)(()=>this.numerals.parse(e));return isNaN(t)?super.parse((0,gc.cleanValue)(e)):t}};s(Rs,"Months");K.Months=Rs;var ks=class extends $t{parse(e){return super.parse((0,gc.cleanValue)(e))}};s(ks,"Weekdays");K.Weekdays=ks});var Kn=y(J=>{"use strict";Object.defineProperty(J,"__esModule",{value:!0});J.weekdays=J.WeekdaysBuilder=J.months=J.MonthsBuilder=J.additionalMonthsDatum=J.monthDatum=void 0;var Sr=A(),xc=Qe(),Nn=hr(),wc=wr(),Pr=ae(),Dc=Dr();function Sc(r,e){let t=[];for(let n=r;n<=e;n++)t.push(n);return t}s(Sc,"range");function Ln(r){return r.map((e,t)=>({name:e,value:t+1}))}s(Ln,"monthDatum");J.monthDatum=Ln;var Pc=[{name:"Mrz",value:3},{name:"Sep.",value:9}],Ac=[["jan\xFAar","febr\xFAar","mars","apr\xEDl","ma\xED","j\xFAn\xED","j\xFAl\xED","\xE1g\xFAst","september","okt\xF3ber","n\xF3vember","desember"],["jan.","feb.","mar.","apr.","ma\xED","j\xFAn.","j\xFAl.","\xE1g\xFA.","sep.","okt.","n\xF3v.","des."]].flatMap(Ln),Tc=Ln(["gener","febrer","mar\xE7","abril","maig","juny","juliol","agost","setembre","octubre","novembre","desembre"]),Cc=[{name:"ene",value:1},{name:"abr",value:4},{name:"ago",value:8},{name:"dic",value:12}];J.additionalMonthsDatum={de:Pc,"de-DE":Pc,ca:Tc,"ca-ES":Tc,es:Cc,"es-ES":Cc,is:Ac,"is-IS":Ac};var Te=class{constructor(e={}){this.monthsData=e}static create(e){return new Te(e.monthsData)}build(e){let t=Te.formats.flatMap(n=>this.datumFor(e,n));return new Dc.Months([...this.monthsData[e]||[],...J.additionalMonthsDatum[e]||[],...t],e)}datumFor(e,t){return Ln(this.namesFor(e,t))}namesFor(e,t){let n=Sc(1,12).map(a=>(0,xc.date)(2e3,a,1)),i=Nn.Formatters.create(e,t);return n.map(a=>(0,Nn.valueFromParts)(i.formatToParts(a),"month")).map(wc.cleanValue)}};s(Te,"MonthsBuilder");Te.formats=[{month:"long"},{month:"short"},{year:"numeric",month:"long",day:"numeric"},{year:"numeric",month:"short",day:"numeric"}];Sr.__decorate([Pr.cache],Te.prototype,"build",null);Sr.__decorate([Pr.cache],Te.prototype,"namesFor",null);J.MonthsBuilder=Te;function qp(r,e="long"){let t=Object.assign({},typeof e=="string"?{month:e}:e);return Te.create(t).namesFor(r,t)}s(qp,"months");J.months=qp;var me=class{constructor(e={}){this.weekdayData=e}static create(e){let t=e.weekdaysData;return this._create(t)}static _create(e){return new me(e)}build(e){let t=me.formats.flatMap(n=>this.datumFor(e,n));return new Dc.Weekdays([...this.weekdayData[e]||[],...t])}datumFor(e,t){return this.namesFor(e,t).map((n,i)=>({name:n,value:i+1}))}namesFor(e,t){let n=Sc(1,7).map(a=>(0,xc.date)(2e3,1,a+2)),i=Nn.Formatters.create(e,t);return n.map(a=>(0,Nn.valueFromParts)(i.formatToParts(a),"weekday")).map(wc.cleanValue)}};s(me,"WeekdaysBuilder");me.formats=[{weekday:"long"},{weekday:"short"},{year:"numeric",month:"numeric",day:"numeric",weekday:"long"},{year:"numeric",month:"numeric",day:"numeric",weekday:"short"}];Sr.__decorate([Pr.cache],me.prototype,"build",null);Sr.__decorate([Pr.cache],me.prototype,"namesFor",null);Sr.__decorate([Pr.cache],me,"_create",null);J.WeekdaysBuilder=me;function Fp(r,e="long"){let t=Object.assign({},typeof e=="string"?{weekday:e}:e);return me.create(t).namesFor(r,t)}s(Fp,"weekdays");J.weekdays=Fp});var Ls=y(b=>{"use strict";Object.defineProperty(b,"__esModule",{value:!0});b.formatBuilder=b.parser=b.defaultParserOptions=b.DefaultDateFactory=b.dateFrom=b.DateTimeFormatPartParser=b.DateParser=b.escapeCharacters=b.RegexBuilder=b.inferDecimalSeparator=b.numberParser=b.NumberParser=b.decimalSeparator=b.isDecimalSeparator=b.separatorsOf=b.mapIgnoreError=b.numberPattern=b.Spaces=void 0;var Un=A(),jp=Re(),Ar=ke(),_c=z(),Tr=ae(),Oc=ne(),Es=Qe(),Ic=br(),Ms=vr(),Ht=Nt(),qs=hr(),Fs=wr(),Bt=Dr(),$n=Kn(),se=class{static handle(e){return se.codes.indexOf(e)!=-1?se.spaces:e}static remove(e){return e&&e.replace(se.pattern,"")}};s(se,"Spaces");b.Spaces=se;se.codes=[32,160,8239].map(r=>String.fromCharCode(r));se.spaces=se.codes.join("");se.pattern=new RegExp(`[${se.spaces}]`,"g");var Rc=`\u066C\u066B,.'\u2019\u2018${se.spaces}`;b.numberPattern=(0,Tr.caching)(r=>{let e=Bt.Numerals.get(r).pattern;return`-?(?:[${e}]+[${Rc}])*[${e}]+`});function kc(r){return(0,_c.flatMap)(e=>{try{return[r(e)]}catch(t){return[]}})}s(kc,"mapIgnoreError");b.mapIgnoreError=kc;var Np=Ar.NamedRegExp.create(`(?<separator>[${Rc}])`);function Ec(r){return(0,Oc.array)(Np.exec(r),(0,_c.map)(([e])=>e.value))}s(Ec,"separatorsOf");b.separatorsOf=Ec;function js(r){return r&&typeof r=="string"&&r==="."||r===","||r==="\u066B"}s(js,"isDecimalSeparator");b.isDecimalSeparator=js;function Mc(r){if(js(r))return r;throw new Error(`Invalid decimal separator${r}`)}s(Mc,"decimalSeparator");b.decimalSeparator=Mc;var Hn=class{constructor(e,t){this.decimalSeparator=e,this.locale=t,this.strictNumberPattern=new RegExp(`^${(0,b.numberPattern)(t)}$`),this.globalNumberPattern=Ar.NamedRegExp.create(`(?<number>${(0,b.numberPattern)(t)})`,"g")}parse(e){if(!this.strictNumberPattern.test(e))throw new Error(`Unable to parse '${e}'`);return this.parseSingle(e)}parseAll(e){return(0,Oc.array)(this.globalNumberPattern.exec(e),kc(([t])=>this.parseSingle(t.value.trim())))}parseSingle(e,t=this.decimalSeparator(e)){let n=Ec(e);if(n.length===0)return this.numberOf(e,t);let a=n[n.length-1]===t?n.slice(0,n.length-1):n;if(a.indexOf(t)!==-1)throw new Error(`Unable to parse '${e}'`);if((0,Ic.unique)(a).length>1)throw new Error(`Unable to parse '${e}'`);return this.numberOf(e,t)}convert(e,t){let n=Bt.Numerals.get(this.locale);return(0,Ar.characters)(e).map(i=>{if(i===t)return".";if(i==="-")return"-";let a=(0,Ms.get)(()=>n.parse(i));return isNaN(a)?"":a.toString()}).join("")}numberOf(e,t){let n=this.convert(e,t),i=(0,Bt.numberOf)(n);if(isNaN(i))throw new Error(`Unable to parse '${e}'`);return i}};s(Hn,"NumberParser");b.NumberParser=Hn;function Bn(r,e="en"){return r?js(r)?new Hn(t=>r,e):Bn((0,b.inferDecimalSeparator)(r),r):Bn(e)}s(Bn,"numberParser");b.numberParser=Bn;b.inferDecimalSeparator=(0,Tr.caching)(r=>(0,Ms.get)(()=>Mc(new Intl.NumberFormat(r).formatToParts(.1).find(e=>e.type==="decimal").value),"."));var Ee=class{constructor(e,t=Es.defaultOptions,n){this.locale=e,this.options=t,this.formatted=n}static create(e,t=Es.defaultOptions){return typeof t=="string"?Ns(e,t):typeof t.format=="string"?Ns(e,t.format,t.strict):new Ee(e,t,(0,qs.formatData)(new Date,e,t))}get pattern(){let e=this.formatted.map((t,n)=>{switch(t.type){case"year":return`(?<year>[${Bt.Numerals.get(this.locale).pattern}]{${this.lengthOf(t.value)}})`;case"month":return`(?<month>${this.monthsPattern()})`;case"day":return`(?<day>[${Bt.Numerals.get(this.locale).pattern}]{1,2})`;case"weekday":return`(?<weekday>${$n.WeekdaysBuilder.create(this.options).build(this.locale).pattern.toLocaleLowerCase(this.locale)})`;default:{let i=(0,Ic.unique)((0,Ar.characters)(qc(this.addExtraLiterals(t)))).join("").replace(" ","\\s"),o=n===this.formatted.length-1?"*":"+";return`[${i}]${o}?`}}}).join("");return(0,Fs.atBoundaryOnly)(e)}lengthOf(e){return e.length===2||e==="2-digit"?2:4}addExtraLiterals(e){return this.options.strict?e.value:this.options.format?e.value+(this.options.separators||Fs.boundaryDelimiters):e.value+(this.options.separators||Fs.boundaryDelimiters+Ht.extraDelimiters)}monthsPattern(){let e=`[${Bt.Numerals.get(this.locale).pattern}]{1,2}`,t=$n.MonthsBuilder.create(this.options).build(this.locale).pattern.toLocaleLowerCase(this.locale);return this.options.month==="2-digit"||this.options.month==="numeric"?e:this.options.month==="short"||this.options.month==="long"?t:`(?:${e}|${t})`}};s(Ee,"RegexBuilder");Un.__decorate([jp.lazy],Ee.prototype,"pattern",null);Un.__decorate([Tr.cache],Ee,"create",null);b.RegexBuilder=Ee;function qc(r){return r.replace(/[\-]/g,"\\$&")}s(qc,"escapeCharacters");b.escapeCharacters=qc;var Gt=class{static create(e,t){let n=Ee.create(e,t).pattern;return(0,Ht.mappingParser)(Cr.create(Ar.NamedRegExp.create(n),e),i=>Fc(i,e,t))}};s(Gt,"DateParser");Un.__decorate([Tr.cache],Gt,"create",null);b.DateParser=Gt;var Cr=class{static create(e,t){return(0,Ht.preProcess)((0,Ht.mappingParser)((0,Ht.namedRegexParser)(e),n=>this.convert(n,t)),n=>this.preProcess(n,t))}static convert(e,t){return e.map(n=>({type:n.name,value:n.value.toLocaleUpperCase(t)}))}static preProcess(e,t){return e.toLocaleLowerCase(t)}};s(Cr,"DateTimeFormatPartParser");Un.__decorate([Tr.cache],Cr,"create",null);b.DateTimeFormatPartParser=Cr;function Fc(r,e,t){var n;let i=Bn(".",e),a=r.find(_=>_.type==="day");if(!a)throw new Error("No day found");let o=i.parse(a.value),c=r.find(_=>_.type==="month");if(!c)throw new Error("No month found");let u=$n.MonthsBuilder.create(t).build(e).parse(c.value),l=r.find(_=>_.type==="year"),h=l?i.parse(l.value):void 0,D=r.find(_=>_.type==="weekday"),g=D?(0,Ms.get)(()=>$n.WeekdaysBuilder.create(t).build(e).parse(D.value)):void 0;return((n=t.factory)!==null&&n!==void 0?n:new Gn).create({year:h,month:u,day:o,weekday:g})}s(Fc,"dateFrom");b.dateFrom=Fc;var Gn=class{create({year:e,month:t,day:n}){if(typeof e=="undefined")throw new Error("No year found");return(0,Es.date)(e,t,n)}};s(Gn,"DefaultDateFactory");b.DefaultDateFactory=Gn;b.defaultParserOptions=[{year:"numeric",month:"long",day:"numeric",weekday:"long"},{year:"numeric",month:"short",day:"numeric",weekday:"short"},{year:"numeric",month:"numeric",day:"numeric"},{year:"numeric",month:"short",day:"numeric"},{year:"numeric",month:"long",day:"numeric"}];function jc(r,e){switch(typeof e){case"string":return Gt.create(r,{format:e});case"object":return Gt.create(r,e);default:return(0,Ht.or)(...b.defaultParserOptions.map(t=>jc(r,t)))}}s(jc,"parser");b.parser=jc;function Ns(r,e,t=!1){return new Ee(r,Object.assign(Object.assign({},(0,qs.optionsFrom)(e)),{strict:t}),(0,qs.partsFrom)(e))}s(Ns,"formatBuilder");b.formatBuilder=Ns});var Uc=y(U=>{"use strict";Object.defineProperty(U,"__esModule",{value:!0});U.SmartDate=U.Pivot=U.InferYear=U.InferDirection=U.InferYearViaWeekday=U.compositeDateFactory=U.parse=void 0;var Nc=z(),zn=Rn(),Lc=Pt(),Lp=ne(),ye=Qe(),Kc=Ls();function Kp(r,e,t){return(0,Kc.parser)(e,t).parse(r)}s(Kp,"parse");U.parse=Kp;var Ks=class{constructor(e){this.factories=e}create(e){for(let t of this.factories)try{return t.create(e)}catch(n){}throw new Error(`Unable to create date for ${JSON.stringify(e)}`)}};s(Ks,"CompositeDateFactory");function Up(...r){return new Ks(r)}s(Up,"compositeDateFactory");U.compositeDateFactory=Up;var _r=class{constructor(e){this.clock=e}static create(e=new zn.SystemClock){return new _r(e)}create({year:e,month:t,day:n,weekday:i}){if(e)return(0,ye.date)(e,t,n);if(!i)throw new Error("No weekday provided");let a=this.candidates(t,n).find(o=>(0,ye.weekdayOf)(o)===i);if(a)return a;throw new Error("No candidate date found that matches")}candidates(e,t){let n=ye.Days.startOf(this.clock.now());return(0,Lp.array)((0,Lc.range)(0,-6),(0,Nc.zip)((0,Lc.range)(1,6)),(0,Nc.flatMap)(i=>i),(0,Kc.mapIgnoreError)(i=>(0,ye.date)((0,ye.yearOf)(n)+i,e,t)))}};s(_r,"InferYearViaWeekday");U.InferYearViaWeekday=_r;var Or;(function(r){r[r.Before=-1]="Before",r[r.After=1]="After"})(Or=U.InferDirection||(U.InferDirection={}));var ge=class{constructor(e,t){this.direction=t,this.date=ye.Days.startOf(e)}static before(e){return new ge(e,Or.Before)}static after(e){return new ge(e,Or.After)}static sliding(e=new zn.SystemClock){let t=e.now();return ge.before((0,ye.date)((0,ye.yearOf)(t)+50,1,1))}create({year:e,month:t,day:n}){if(e&&e<10)throw new Error("Illegal year");if(e&&e>=100&&e<1e3)throw new Error("Illegal year");if(e&&e>=1e3)return(0,ye.date)(e,t,n);let i=this.calculateYear(e),a=(0,ye.date)(i,t,n);if(this.direction==Or.Before&&a<this.date||this.direction==Or.After&&a>this.date)return a;let o=this.calculateYearIncrement(e);return a.setUTCFullYear(a.getUTCFullYear()+o*this.direction),a}calculateYearIncrement(e){return typeof e=="undefined"?1:100}calculateYear(e){if(typeof e=="undefined")return this.date.getUTCFullYear();let t=Math.floor(this.date.getUTCFullYear()/100)*100;return e+t}};s(ge,"InferYear");U.InferYear=ge;var Us=class{static on(e){return ge.before((0,ye.date)(e,1,1))}static sliding(e=new zn.SystemClock){return ge.sliding(e)}};s(Us,"Pivot");U.Pivot=Us;var $s=class{constructor(e=new zn.SystemClock){this.clock=e}create(e){return typeof e.year=="undefined"?ge.after(this.clock.now()).create(e):ge.sliding(this.clock).create(e)}};s($s,"SmartDate");U.SmartDate=$s});var Hc=y(ee=>{"use strict";Object.defineProperty(ee,"__esModule",{value:!0});ee.LearningDateFormatter=ee.FromFormatStringWeekdayExtractor=ee.FromFormatStringMonthExtractor=ee.FromFormatStringDataExtractor=ee.exactFormat=ee.BaseDataExtractor=void 0;var he=A(),Wn=Qe(),zt=ke(),$p=ae(),Ce=Re(),$c=hr(),Hp=ne(),Bp=z(),Hs=Dr(),Ir=Kn(),Vn=class{constructor(e,t,n,i){this.locale=e,this.options=t,this.dates=n,this.partType=i}};s(Vn,"BaseDataExtractor");ee.BaseDataExtractor=Vn;function Bs(r,e,t){let n=$c.Formatters.create(r,e);return t.map(i=>n.format(i))}s(Bs,"exactFormat");ee.exactFormat=Bs;var Rr=class extends Vn{extract(){let e=Object.keys(this.options).length==1,t=Bs(this.locale,this.options,this.dates);if(e)return t;let n=Bs(this.locale,{[this.partType]:this.options[this.partType]},this.dates),i=this.diff(t),a=[];for(let o=0;o<n.length;o++){let c=t[o],u=n[o],l=i[o];a.push(c.indexOf(u)!=-1&&u.length>l.length&&isNaN(parseInt(l))?u:l)}return a}diff(e){return(0,zt.different)(e)}};s(Rr,"FromFormatStringDataExtractor");ee.FromFormatStringDataExtractor=Rr;var Ge=class extends Rr{constructor(e,t,n){super(e,t,n,"month")}diff(e){if(!this.options.weekday)return super.diff(e);let t=[],n=(0,Ir.weekdays)(this.locale,this.options),i=n[this.day(this.dates[8])];for(let a=0;a<e.length;a++){let c=this.replaceYearMonthDay(e[a]).replace(this.weekday(n,a),i);t[a]=this.restoreYearMonthDay(c)}return super.diff(t)}weekday(e,t){return e[this.day(this.dates[t])]}replaceYearMonthDay(e){return(0,zt.replace)(Ge.replaceYMD,e,t=>{let n=t[1],i=t[2];if(i==="\u5E74")return`${n}year`;if(i==="\u6708")return`${n}month`;if(i==="\u65E5")return`${n}day`;throw new Error(`Unknown delimiter ${i}`)})}restoreYearMonthDay(e){return(0,zt.replace)(Ge.restoreYMD,e,t=>{let n=t[1];if(n==="year")return"\u5E74";if(n==="month")return"\u6708";if(n==="day")return"\u65E5";throw new Error(`Unknown delimiter ${n}`)})}day(e){let t=e.getUTCDay();return t==0?6:t-1}};s(Ge,"FromFormatStringMonthExtractor");ee.FromFormatStringMonthExtractor=Ge;Ge.replaceYMD=/(\d)([])/g;Ge.restoreYMD=/(year|month|day)/g;var Gs=class extends Rr{constructor(e,t,n){super(e,t,n,"weekday")}diff(e){if(!this.options.day)return super.diff(e);let t=[],n=this.dates[0].getUTCDate().toString();for(let i=0;i<e.length;i++){let a=e[i],o=this.convertToNumeral(this.dates[i].getUTCDate()),c=a.replace(o,n);t[i]=c}return super.diff(t)}convertToNumeral(e){return(0,Hs.numberFormatter)(this.locale).format(e)}};s(Gs,"FromFormatStringWeekdayExtractor");ee.FromFormatStringWeekdayExtractor=Gs;var W=class{constructor(e,t=Wn.defaultOptions,n=3333,i=11,a=20,o=Wn.Weekday.Friday,c=Hs.Numerals.get(e)){this.locale=e,this.options=t,this.yearValue=n,this.monthValue=i,this.dayValue=a,this.weekdayValue=o,this.numerals=c}static create(e,t=Wn.defaultOptions){return new W(e,t)}get formatter(){return $c.Formatters.create(this.locale,this.options)}get formatted(){return this.formatter.format((0,Wn.date)(this.yearValue,this.monthValue,this.dayValue))}get months(){return Ir.MonthsBuilder.create(this.options).build(this.locale)}get month(){return Ir.MonthsBuilder.create(this.options).namesFor(this.locale,this.options)[this.monthValue-1]}get weekdays(){return Ir.WeekdaysBuilder.create(this.options).build(this.locale)}get weekday(){return(0,Ir.weekdays)(this.locale,this.options)[this.weekdayValue-1]}get year(){return this.numerals.format(this.yearValue)}get day(){return this.numerals.format(this.dayValue)}get learningNamesPattern(){let e=s(i=>`(?<${i}>${this[i]})`,"template"),n=`(?:${Object.keys(this.options).map(i=>e(i)).join("|")})`;return zt.NamedRegExp.create(n)}get actualNamesPattern(){let e=Hs.Numerals.get(this.locale).pattern,t=this.learningNamesPattern,n=(0,Hp.array)(t.iterate(this.formatted),(0,Bp.map)(a=>{if((0,zt.isNamedMatch)(a)){let[o]=a.filter(c=>Boolean(c.value)).map(c=>c.name);if(!o)throw new Error;if(o=="year")return`(?<year>[${e}]{4})`;if(o=="day")return`(?<day>[${e}]{1,2})`;if(o=="month")return`(?<month>(?:[${e}]{1,2}|${this.months.pattern}))`;if(o=="weekday")return`(?<weekday>${this.weekdays.pattern})`}else return`(?<literal>[${a}]+?)`})),i="^"+n.join("")+"$";return zt.NamedRegExp.create(i)}format(e){return this.formatter.format(e)}formatToParts(e){let t=this.actualNamesPattern,n=this.formatter.format(e),i=t.match(n);if(i.length===0)throw new Error(`${t} did not match ${n}`);let a=i.map(o=>({type:this.getType(o.name,o.value),value:o.value}));return this.collapseLiterals(a)}collapseLiterals(e){for(let t=0;t<e.length;t++){let n=e[t];if(n.type==="literal"){let i=t+1;for(;;){let a=e[i];if(!(a&&a.type==="literal"))break;n.value=n.value+a.value,e.splice(i,1)}}}return e}getType(e,t){return e==="month"||e==="weekday"?this.parsable(this.months,t)?"month":this.parsable(this.weekdays,t)?"weekday":"literal":e}parsable(e,t){try{return Boolean(e.parse(t))}catch(n){return!1}}};s(W,"LearningDateFormatter");he.__decorate([Ce.lazy],W.prototype,"formatter",null);he.__decorate([Ce.lazy],W.prototype,"formatted",null);he.__decorate([Ce.lazy],W.prototype,"months",null);he.__decorate([Ce.lazy],W.prototype,"month",null);he.__decorate([Ce.lazy],W.prototype,"weekdays",null);he.__decorate([Ce.lazy],W.prototype,"weekday",null);he.__decorate([Ce.lazy],W.prototype,"year",null);he.__decorate([Ce.lazy],W.prototype,"day",null);he.__decorate([Ce.lazy],W.prototype,"learningNamesPattern",null);he.__decorate([Ce.lazy],W.prototype,"actualNamesPattern",null);he.__decorate([$p.cache],W,"create",null);ee.LearningDateFormatter=W});var qe=y(be=>{"use strict";Object.defineProperty(be,"__esModule",{value:!0});var Me=A();Me.__exportStar(Rn(),be);Me.__exportStar(Qe(),be);Me.__exportStar(hr(),be);Me.__exportStar(Ls(),be);Me.__exportStar(wr(),be);Me.__exportStar(Uc(),be);Me.__exportStar(Dr(),be);Me.__exportStar(Hc(),be);Me.__exportStar(Kn(),be)});var Qc=y(Qn=>{"use strict";Object.defineProperty(Qn,"__esModule",{value:!0});Qn.currencies=void 0;Qn.currencies={AFN:{decimals:2,symbols:["Afs","\u060B"]},EUR:{decimals:2,symbols:["\u20AC"]},ALL:{decimals:2,symbols:["L"]},DZD:{decimals:2,symbols:["DA"]},USD:{decimals:2,symbols:["$","US$"]},AOA:{decimals:2,symbols:["Kz"]},XCD:{decimals:2,symbols:["EC$","$"]},ARS:{decimals:2,symbols:["$"]},AMD:{decimals:2,symbols:["\u058F"]},AWG:{decimals:2,symbols:["\u0192"]},AUD:{decimals:2,symbols:["A$","AU$","AUD","$"]},AZN:{decimals:2,symbols:["\u20BC","A.M."]},BSD:{decimals:2,symbols:["B$","$"]},BHD:{decimals:3,symbols:["BD"]},BDT:{decimals:2,symbols:["\u09F3"]},BBD:{decimals:2,symbols:["Bds$","$"]},BYN:{decimals:2,symbols:["Br"]},BZD:{decimals:2,symbols:["Bz$","$"]},XOF:{decimals:0,symbols:["F"]},BMD:{decimals:2,symbols:["BD$","$"]},INR:{decimals:2,symbols:["\u20B9","Rs"]},BTN:{decimals:2,symbols:["Nu"]},BOB:{decimals:2,symbols:["Bs"]},BOV:{decimals:2,symbols:[]},BAM:{decimals:2,symbols:["KM"]},BWP:{decimals:2,symbols:["P"]},NOK:{decimals:2,symbols:["kr"]},BRL:{decimals:2,symbols:["R$"]},BND:{decimals:2,symbols:["B$","$"]},BGN:{decimals:2,symbols:["\u043B\u0432.","\u043B\u0432"]},BIF:{decimals:0,symbols:["FBu"]},CVE:{decimals:2,symbols:[]},KHR:{decimals:2,symbols:["\u17DB"]},XAF:{decimals:0,symbols:[]},CAD:{decimals:2,symbols:["C$","CAD$","$","\xA2"]},KYD:{decimals:2,symbols:["CI$","$"]},CLP:{decimals:0,symbols:["CLP$","$"]},CLF:{decimals:4,symbols:[]},CNY:{decimals:2,symbols:["\xA5","\uFFE5"]},COP:{decimals:2,symbols:["COL$","$"]},COU:{decimals:2,symbols:["COU$"]},KMF:{decimals:0,symbols:["CF"]},CDF:{decimals:2,symbols:["CF"]},NZD:{decimals:2,symbols:["NZ$","$"]},CRC:{decimals:2,symbols:["\u20A1"]},HRK:{decimals:2,symbols:["kn"]},CUP:{decimals:2,symbols:["$MN","$"]},CUC:{decimals:2,symbols:["CUC$","$"]},ANG:{decimals:2,symbols:["\u0192","NA\u0192","CMg"]},CZK:{decimals:2,symbols:["K\u010D"]},DKK:{decimals:2,symbols:["kr","kr."]},DJF:{decimals:0,symbols:["Fdj"]},DOP:{decimals:2,symbols:["RD$","$"]},EGP:{decimals:2,symbols:["LE","\xA3"]},SVC:{decimals:2,symbols:[]},ERN:{decimals:2,symbols:["Nfk"]},SZL:{decimals:2,symbols:["E"]},ETB:{decimals:2,symbols:["Br"]},FKP:{decimals:2,symbols:["\xA3"]},FJD:{decimals:2,symbols:["F$","FJ$","$"]},XPF:{decimals:0,symbols:["\u20A3"]},GMD:{decimals:2,symbols:["D"]},GEL:{decimals:2,symbols:["\u20BE"]},GHS:{decimals:2,symbols:["GH\u20B5"]},GIP:{decimals:2,symbols:["\xA3"]},GTQ:{decimals:2,symbols:["Q"]},GBP:{decimals:2,symbols:["\xA3"]},GNF:{decimals:0,symbols:["FG"]},GYD:{decimals:2,symbols:["G$","GY$","$"]},HTG:{decimals:2,symbols:["Gde.","G"]},HNL:{decimals:2,symbols:["L"]},HKD:{decimals:2,symbols:["\u5143","HK$","$"]},HUF:{decimals:2,symbols:["Ft"]},ISK:{decimals:0,symbols:["kr"]},IDR:{decimals:2,symbols:["Rp","Rs"]},XDR:{decimals:0,symbols:[]},IRR:{decimals:2,symbols:["\uFDFC"]},IQD:{decimals:3,symbols:["\u062F.\u0639","ID"]},ILS:{decimals:2,symbols:["\u20AA"]},JMD:{decimals:2,symbols:["J$","$"]},JPY:{decimals:0,symbols:["\u5186","\xA5","\uFFE5"]},JOD:{decimals:3,symbols:["JD"]},KZT:{decimals:2,symbols:["\u20B8"]},KES:{decimals:2,symbols:["Ksh","KSh"]},KPW:{decimals:2,symbols:["\u20A9"]},KRW:{decimals:0,symbols:["\u20A9"]},KWD:{decimals:3,symbols:["KD","\u062F.\u0643"]},KGS:{decimals:2,symbols:["\u20C0"]},LAK:{decimals:2,symbols:["\u20AD"]},LBP:{decimals:2,symbols:["\u0644.\u0644.","LL","\xA3"]},LSL:{decimals:2,symbols:["M"]},ZAR:{decimals:2,symbols:["R"]},LRD:{decimals:2,symbols:["Lib$","L$","$"]},LYD:{decimals:3,symbols:["LD"]},CHF:{decimals:2,symbols:["Fr"]},MOP:{decimals:2,symbols:["MOP$"]},MKD:{decimals:2,symbols:["DEN","\u0434\u0435\u043D"]},MGA:{decimals:2,symbols:["Ar"]},MWK:{decimals:2,symbols:["MK"]},MYR:{decimals:2,symbols:["RM"]},MVR:{decimals:2,symbols:["\u0783","Rf","MRF"]},MRU:{decimals:2,symbols:[]},MUR:{decimals:2,symbols:["\u20A8"]},XUA:{decimals:0,symbols:[]},MXN:{decimals:2,symbols:["$"]},MXV:{decimals:2,symbols:[]},MDL:{decimals:2,symbols:["L"]},MNT:{decimals:2,symbols:["\u20AE"]},MAD:{decimals:2,symbols:["DH"]},MZN:{decimals:2,symbols:["MT","MTn"]},MMK:{decimals:2,symbols:["K"]},NAD:{decimals:2,symbols:["N$","$"]},NPR:{decimals:2,symbols:["N\u20A8","\u0930\u0941","\u20A8","Re"]},NIO:{decimals:2,symbols:["C$"]},NGN:{decimals:2,symbols:["\u20A6"]},OMR:{decimals:3,symbols:["\u0631.\u0639."]},PKR:{decimals:2,symbols:["\u20A8","Rs"]},PAB:{decimals:2,symbols:["B/."]},PGK:{decimals:2,symbols:["K"]},PYG:{decimals:0,symbols:["\u20B2"]},PEN:{decimals:2,symbols:["S/."]},PHP:{decimals:2,symbols:["\u20B1"]},PLN:{decimals:2,symbols:["z\u0142"]},QAR:{decimals:2,symbols:["QR"]},RON:{decimals:2,symbols:["lei"]},RUB:{decimals:2,symbols:["\u20BD"]},RWF:{decimals:0,symbols:["FRw"]},SHP:{decimals:2,symbols:["\xA3"]},WST:{decimals:2,symbols:["WS$"]},STN:{decimals:2,symbols:["Db","\u20A1"]},SAR:{decimals:2,symbols:["SR"]},RSD:{decimals:2,symbols:["\u0434\u0438\u043D","din"]},SCR:{decimals:2,symbols:["SRe"]},SLL:{decimals:2,symbols:["Le"]},SLE:{decimals:2,symbols:["Le"]},SGD:{decimals:2,symbols:["S$","$"]},XSU:{decimals:0,symbols:["Sucre"]},SBD:{decimals:2,symbols:["$","SI$"]},SOS:{decimals:2,symbols:["Sh.So."]},SSP:{decimals:2,symbols:["Db","\xA3"]},LKR:{decimals:2,symbols:["Rs","\u0DBB\u0DD4","\u0BB0\u0BC2"]},SDG:{decimals:2,symbols:["\u062C.\u0633","sud\xA3","\xA3"]},SRD:{decimals:2,symbols:["$"]},SEK:{decimals:2,symbols:["kr"]},CHE:{decimals:2,symbols:[]},CHW:{decimals:2,symbols:[]},SYP:{decimals:2,symbols:["syr\xA3","LS","\xA3"]},TWD:{decimals:2,symbols:["NT$","$"]},TJS:{decimals:2,symbols:["SM"]},TZS:{decimals:2,symbols:["TSh"]},THB:{decimals:2,symbols:["\u0E3F"]},TOP:{decimals:2,symbols:["T$"]},TTD:{decimals:2,symbols:["TT$","$"]},TND:{decimals:3,symbols:["DT"]},TRY:{decimals:2,symbols:["YTL","\u20BA"]},TMT:{decimals:2,symbols:["T"]},UGX:{decimals:0,symbols:["Ush"]},UAH:{decimals:2,symbols:["\u20B4"]},AED:{decimals:2,symbols:["DH","\u062F.\u0625","Dhs"]},USN:{decimals:2,symbols:[]},UYU:{decimals:2,symbols:["$U","$"]},UYI:{decimals:0,symbols:[]},UYW:{decimals:4,symbols:[]},UZS:{decimals:2,symbols:["So'm"]},VUV:{decimals:0,symbols:["VT"]},VES:{decimals:2,symbols:["Bs.S"]},VED:{decimals:2,symbols:[]},VND:{decimals:0,symbols:["\u20AB","\u0111"]},YER:{decimals:2,symbols:["\uFDFC'"]},ZMW:{decimals:2,symbols:["K","ZK"]},ZWL:{decimals:2,symbols:[]},XBA:{decimals:0,symbols:[]},XBB:{decimals:0,symbols:[]},XBC:{decimals:0,symbols:[]},XBD:{decimals:0,symbols:[]},XTS:{decimals:0,symbols:[]},XXX:{decimals:0,symbols:[]},XAU:{decimals:0,symbols:[]},XPD:{decimals:0,symbols:[]},XPT:{decimals:0,symbols:[]},XAG:{decimals:0,symbols:[]},ADP:{symbols:["Pta"],decimals:2}}});var eu=y(ei=>{"use strict";Object.defineProperty(ei,"__esModule",{value:!0});ei.PreferredCurrencies=void 0;var L=class{static dollarSymbol(e){return e&&L.dollarCountries[e]||"USD"}static poundSymbol(e){return e&&L.poundCountries[e]||"GBP"}static yenSymbol(e){return e&&L.yenCountries[e]||"JPY"}static kroneSymbol(e){return e&&L.kroneCountries[e]||"DKK"}static rupeeSymbol(e){return e&&L.rupeeCountries[e]||"INR"}static for(e){return[L.dollarSymbol(e),L.poundSymbol(e),L.yenSymbol(e),L.kroneSymbol(e),L.rupeeSymbol(e)]}};s(L,"PreferredCurrencies");ei.PreferredCurrencies=L;L.dollarCountries={AG:"XCD",AR:"ARS",AU:"AUD",BS:"BSD",BB:"BBD",BZ:"BZD",BM:"BMD",BN:"BND",CA:"CAD",CO:"COP",CL:"CLP",CU:"CUP",DM:"XCD",DO:"DOP",EC:"USD",FM:"USD",KY:"KYD",FJ:"FJD",GD:"XCD",GY:"GYD",HK:"HKD",JM:"JMD",KI:"AUD",KN:"XCD",LC:"XCD",LR:"LRD",MH:"USD",MX:"MXN",NA:"NAD",NZ:"NZD",SG:"SGD",SB:"SBD",SR:"SRD",SV:"USD",TL:"USD",TW:"TWD",TT:"TTD",TV:"AUD",US:"USD",UY:"UYU",VC:"XCD",ZW:"USD"};L.poundCountries={EG:"EGP",FK:"FKP",GB:"GBP",GI:"GIP",GG:"GBP",IM:"GBP",JE:"GBP",LB:"LBP",SH:"SHP",SS:"SSP",SD:"SDG",SY:"SYP"};L.yenCountries={CN:"CNY",JP:"JPY"};L.kroneCountries={DK:"DKK",FO:"DKK",GL:"DKK",IS:"ISK",NO:"NOK",SE:"SEK"};L.rupeeCountries={IN:"INR",ID:"IDR",MU:"MUR",NP:"NPR",PK:"PKR",LK:"LKR"}});var ti=y(Vt=>{"use strict";Object.defineProperty(Vt,"__esModule",{value:!0});Vt.infer=Vt.prefer=void 0;var tu=br(),sf=eu();function af(...r){if(r.filter(Boolean).length!==0)return(e,t)=>{let n=e.lookup(t)||[],i=(0,tu.unique)(n.map(a=>a.value));if(i.length!==0)return i.length===1?i[0]:i.find(a=>r.indexOf(a)!==-1)}}s(af,"prefer");Vt.prefer=af;function of(r){return r?r.split(/[-_]/).filter(Boolean):[]}s(of,"localeParts");function cf(r){let[,e]=of(r),t=sf.PreferredCurrencies.for(e);return(n,i)=>{let a=n.lookup(i)||[],o=(0,tu.unique)(a.map(u=>u.value));if(o.length===0)return;if(o.length===1)return o[0];let c=o.filter(u=>u.startsWith(e));return c.length===1?c[0]:o.find(u=>t.indexOf(u)!==-1)}}s(cf,"infer");Vt.infer=cf});var Fr=y(v=>{"use strict";Object.defineProperty(v,"__esModule",{value:!0});v.IntegerGroupParser=v.PartsFromFormat=v.NumberFormatPartParser=v.MoneyParser=v.RegexBuilder=v.symbolFor=v.CurrencySymbols=v.parseToParts=v.parser=v.parse=v.FormatToParts=v.toPartsPonyfill=v.format=v.partsFrom=v.hasNativeToParts=v.Formatter=v.decimalsFor=v.moneyFrom=v.money=void 0;var it=A(),We=ke(),ue=z(),ri=G(),Ys=Qc(),ru=Re(),Zs=Nt(),Er=ae(),uf=vr(),Mr=ne(),le=qe(),lf=ti();function ni(r,e){return{amount:e,currency:r}}s(ni,"money");v.money=ni;function Xs(r,e,t){let{currency:n}=(0,ue.single)(r,(0,ue.filter)(u=>u.type==="currency"),(0,ue.flatMap)(u=>{try{let l=H.get(e).parse(u.value,t&&t.strategy);return[{currency:l,exactMatch:l===u.value}]}catch(l){return[]}}),(0,ue.sort)((0,ri.by)("exactMatch",ri.descending)),(0,ue.first)()),i=r.filter(u=>u.type==="integer"||u.type==="decimal"||u.type==="fraction"),a=(0,uf.get)(()=>r.filter(u=>u.type==="decimal")[0].value,"."),o=i.map(u=>u.value).join(""),c=(0,le.numberParser)(a,e).parse(o);return ni(n,c)}s(Xs,"moneyFrom");v.moneyFrom=Xs;function nu(r){let e=Ys.currencies[r];return e?e.decimals:2}s(nu,"decimalsFor");v.decimalsFor=nu;var _e=class{static create(e,t,n="code"){return new Intl.NumberFormat(t,{currencyDisplay:n,currency:e,style:"currency",minimumFractionDigits:0,maximumFractionDigits:nu(e)})}};s(_e,"Formatter");it.__decorate([Er.cache],_e,"create",null);v.Formatter=_e;v.hasNativeToParts=typeof Intl.NumberFormat.prototype.formatToParts=="function";function Qs(r,e,t="code",n=v.hasNativeToParts){let i=_e.create(r.currency,e,t);return n?i.formatToParts(r.amount):iu(r,e,t)}s(Qs,"partsFrom");v.partsFrom=Qs;function df(r,e,t="code"){return _e.create(r.currency,e,t).format(r.amount)}s(df,"format");v.format=df;function iu(r,e,t="code"){let n=r.currency,i=r.amount;return st.create(n,e,t).format(i)}s(iu,"toPartsPonyfill");v.toPartsPonyfill=iu;var su=ni("GBP",111222.3333),st=class{constructor(e,t,n,i){this.currency=e,this.currencyDisplay=t,this.parser=n,this.locale=i}static create(e,t,n="code"){let i=_e.create(e,t,n).format(su.amount),a=Oe.examplePattern(t).parse(i),o=qr.buildFrom(a,t),c=at.create(t,o);return new st(e,n,c,t)}format(e){let t=_e.create(this.currency,this.locale,this.currencyDisplay);return this.parser.parse(t.format(e))}};s(st,"FormatToParts");it.__decorate([Er.cache],st,"create",null);v.FormatToParts=st;function pf(r,e,t){return Xs(au(r,e,t),e,t)}s(pf,"parse");v.parse=pf;function ff(r,e){return ii.create(r,e)}s(ff,"parser");v.parser=ff;function au(r,e,t){return at.create(e,t).parse(r)}s(au,"parseToParts");v.parseToParts=au;var H=class extends le.DatumLookup{constructor(e,t){super(e.map(n=>({name:(0,le.cleanValue)(n.name),value:n.value})),ri.ascending);this.locale=t}static get(e,t=[]){return H.cache[e]=H.cache[e]||H.create(e,t)}static set(e,t){return H.cache[e]=t}static create(e,t=[]){return new H([...H.generateData(e),...t],e)}static generateData(e){return Object.keys(Ys.currencies).flatMap(t=>H.dataFor(e,t,Ys.currencies[t]))}static dataFor(e,t,n){return[{name:t,value:t},{name:ou(e,t),value:t},...(0,Mr.array)(n.symbols,(0,ue.flatMap)(i=>{let a=[{name:i,value:t}];if(H.generateAdditionalSymbols.indexOf(i)!==-1){let o=t.substring(0,2);a.push({name:i+o,value:t}),a.push({name:o+i,value:t}),a.push({name:t+i,value:t})}return a}))]}parse(e,t=(0,lf.infer)(this.locale)){return super.parse((0,le.cleanValue)(e),t)}};s(H,"CurrencySymbols");v.CurrencySymbols=H;H.cache={};H.generateAdditionalSymbols=["$","\xA5","\xA3"];var mf=/GBP|GB|GB|UK|UK/;function ou(r,e,t=v.hasNativeToParts){if(t){let n=Qs(ni(e,0),r,"symbol"),[i]=n.filter(a=>a.type==="currency");if(!i)throw new Error("No currency found");return le.Spaces.remove(i.value)}else{let n=_e.create("GBP",r,"symbol").format(1).replace(mf,"@@@"),i=_e.create(e,r,"symbol").format(1),[,a]=(0,We.different)([n,i]);return a?le.Spaces.remove(a):"\xA3"}}s(ou,"symbolFor");v.symbolFor=ou;var qr=class{static buildFromOptions(e,t){return t&&t.format?this.buildFrom(Oe.format.parse(t.format),e,!0):this.buildPattern(e,t&&t.strict||!1)}static buildPattern(e,t=!1){return this.buildFrom(Qs(su,e),e,t)}static buildFrom(e,t,n=!1){let i=this.buildParts(e,n),[a=""]=e.filter(u=>u.type==="group").map(u=>u.value),o=le.Numerals.get(t).pattern,c=i.map(u=>{switch(u.type){case"currency":return`(?<currency>${H.get(t).pattern})?`;case"decimal":return`(?<decimal>[${u.value}]?)`;case"fraction":return`(?<fraction>[${o}]*)`;case"integer":return`(?<integer-group>[${o}${le.Spaces.handle(a)}]*[${o}]+)`;default:return`(?<${u.type}>[${le.Spaces.handle(u.value)}]?)`}}).join("");return(0,le.atBoundaryOnly)(c)}static buildParts(e,t=!1){let n=[...e];if(!t){let i=n[0],a=n[n.length-1],o={type:"literal",value:" "};i.type==="currency"?(n.push(o,i),n.splice(1,0,o)):a.type==="currency"&&(n.unshift(a,o),n.splice(n.length-2,0,o))}return(0,Mr.array)(n,(0,ue.filter)(i=>i.type!=="group"),(0,ue.dedupe)((0,ri.by)("type")))}};s(qr,"RegexBuilder");v.RegexBuilder=qr;var ii=class{static create(e,t){return(0,Zs.mappingParser)(at.create(e,t),n=>Xs(n,e,t))}};s(ii,"MoneyParser");v.MoneyParser=ii;var at=class{static create(e,t){let n=typeof t=="string"?t:qr.buildFromOptions(e,t);return(0,Zs.mappingParser)((0,Zs.namedRegexParser)(We.NamedRegExp.create(n)),i=>this.convert(i,e))}static convert(e,t){return(0,Mr.array)(e,(0,ue.filter)(n=>Boolean(n.value)),(0,ue.flatMap)(n=>n.name==="integer-group"?xe.digits(t).parse(n.value):[{type:n.name,value:n.value}]))}};s(at,"NumberFormatPartParser");it.__decorate([Er.cache],at,"create",null);v.NumberFormatPartParser=at;var Oe=class{constructor(e,t){this.formatRegex=e,this.integerGroupParser=t}parse(e){return(0,Mr.array)(this.formatRegex.iterate(e),(0,ue.flatMap)(t=>{if((0,We.isNamedMatch)(t)){let[n,i,a]=t.filter(o=>Boolean(o.value));if(n.name==="currency")return[{type:n.name,value:n.value}];{let o=this.integerGroupParser.parse(n.value);return i?[...o,{type:i.name,value:i.value},{type:a.name,value:a.value}]:o}}else return[{type:"literal",value:t}]}))}static get format(){let e=We.NamedRegExp.create("(?:(?<integer-group>(?:i.*i|i))(?:(?<decimal>[^f])(?<fraction>f+))?|(?<currency>C+))");return new Oe(e,xe.integerFormat)}static examplePattern(e){let t=le.Numerals.get(e),n=We.NamedRegExp.create(`(?:(?<integer-group>${t.format(1)}.*${t.format(2)})(?:(?<decimal>.)(?<fraction>${t.format(3)}+))?|(?<currency>${H.get(e).pattern}))`);return new Oe(n,xe.digits(e))}};s(Oe,"PartsFromFormat");it.__decorate([ru.lazy],Oe,"format",null);it.__decorate([Er.cache],Oe,"examplePattern",null);v.PartsFromFormat=Oe;var xe=class{constructor(e){this.regex=e}parse(e){return(0,Mr.array)(this.regex.iterate(e),(0,ue.map)(t=>(0,We.isNamedMatch)(t)?{type:"integer",value:t[0].value}:{type:"group",value:t}))}static digits(e){return new xe(We.NamedRegExp.create(`(?<integer>[${le.Numerals.get(e).pattern}]+)`))}static get integerFormat(){return new xe(We.NamedRegExp.create("(?<integer>i+)"))}};s(xe,"IntegerGroupParser");it.__decorate([Er.cache],xe,"digits",null);it.__decorate([ru.lazy],xe,"integerFormat",null);v.IntegerGroupParser=xe});var ai=y(si=>{"use strict";Object.defineProperty(si,"__esModule",{value:!0});var cu=A();cu.__exportStar(Fr(),si);cu.__exportStar(ti(),si)});var na=y(de=>{"use strict";Object.defineProperty(de,"__esModule",{value:!0});de.implicitMoneyParser=de.findDecimalSeparator=de.flexibleMoneyParser=de.FlexibleMoneyParser=de.flexibleParse=void 0;var uu=A(),Jt=Fr(),yf=Nt(),ea=ke(),ot=z(),lu=G(),gf=br(),hf=ae(),bf=Re(),vf=vr(),xf=ne(),we=qe(),du=ti();function wf(r,e="en",t){return new Fe(e,t).parse(r)}s(wf,"flexibleParse");de.flexibleParse=wf;var Fe=class{constructor(e,t){this.locale=e,this.options=t}get pattern(){return Fe.patternFor(this.locale)}static patternFor(e){return ea.NamedRegExp.create((0,we.atBoundaryOnly)(`(?<currency>${Jt.CurrencySymbols.get(e).pattern})?(?<literal>[${we.Spaces.spaces}])?(?<number>${(0,we.numberPattern)(e)})(?<literal>[${we.Spaces.spaces}])?(?<currency>${Jt.CurrencySymbols.get(e).pattern})?`))}parse(e){try{return this.parseSingle(this.pattern.match((0,ea.removeUnicodeMarkers)(e)))}catch(t){throw new Error(`Unable to parse ${e}`)}}parseAll(e){return(0,xf.array)(this.pattern.exec((0,ea.removeUnicodeMarkers)(e)),(0,we.mapIgnoreError)(t=>this.parseSingle(t)))}parseSingle(e){let{currency:t}=(0,ot.single)(e,(0,ot.filter)(a=>a.name==="currency"&&a.value!==void 0),(0,ot.flatMap)(a=>{try{let o=Jt.CurrencySymbols.get(this.locale).parse(a.value,this.options&&this.options.strategy||(0,du.infer)(this.locale));return[{currency:o,exactMatch:o===a.value}]}catch(o){return[]}}),(0,ot.sort)((0,lu.by)("exactMatch",lu.descending)),(0,ot.first)()),n=(0,ot.single)(e,(0,ot.find)(a=>a.name==="number"&&a.value!==void 0)).value,i=(0,we.numberParser)(this.options&&this.options.decimalSeparator||ta(t,n),this.locale);return(0,Jt.money)(t,i.parse(n))}};s(Fe,"FlexibleMoneyParser");uu.__decorate([bf.lazy],Fe.prototype,"pattern",null);uu.__decorate([hf.cache],Fe,"patternFor",null);de.FlexibleMoneyParser=Fe;function Df(r="en",e){return new Fe(r,e)}s(Df,"flexibleMoneyParser");de.flexibleMoneyParser=Df;function pu(r){return r==="."?",":"."}s(pu,"flip");function ta(r,e){let t=(0,we.separatorsOf)(e);if(t.length===0)return".";let n=t[t.length-1],i=e.length-e.lastIndexOf(n)-1,a=(0,Jt.decimalsFor)(r);if(t.length===1){if(i===3){if(a===3)throw new Error(`Can not parse ${e} as separator is ambiguous`);return pu(n)}return(0,we.decimalSeparator)(n)}return(0,gf.unique)(t).length===1?pu(n):(0,we.decimalSeparator)(n)}s(ta,"findDecimalSeparator");de.findDecimalSeparator=ta;var ra=class{constructor(e,t,n=new we.NumberParser(i=>(0,vf.get)(()=>ta(e,i),(0,we.inferDecimalSeparator)(t)),t)){this.currency=e,this.parser=n}parse(e){let t=this.parser.parse(e);return{currency:this.currency,amount:t}}parseAll(e){return this.parser.parseAll(e).map(t=>({amount:t,currency:this.currency}))}};s(ra,"ImplicitMoneyParser");function Sf({currency:r,locale:e="en",strategy:t=(0,du.infer)(e)}){return r?new ra(Jt.CurrencySymbols.get(e).parse(r,t),e):new yf.FailParser}s(Sf,"implicitMoneyParser");de.implicitMoneyParser=Sf});var Zm=new Set(["Unknown","PossibleIdentifier"]),Wr=new Set(["HotelName","HotelCode","ChainCode"]);function qa(r){return r&&typeof r=="object"&&r.checkin instanceof Date&&r.checkout instanceof Date}s(qa,"hasSearchDates");var x;(function(l){l.Search="Search",l.RoomsAndRates="RoomsAndRates",l.Confirmation="Confirmation",l.Checkout="Checkout",l.Payment="Payment",l.Group="Group",l.Advert="Advert",l.Partial="Partial",l.Unknown="Unknown"})(x||(x={}));var _l=[x.Payment,x.Confirmation,x.RoomsAndRates,x.Checkout,x.Search,x.Partial,x.Group,x.Unknown,x.Advert];function Fa(r){return _l.indexOf(r)}s(Fa,"pageRanking");var ja;(function(n){n.Singleton="Singleton",n.ApplicationHost="ApplicationHost",n.DataSource="DataSource"})(ja||(ja={}));function lt(r){return r?typeof r=="object"&&("integrationId"in r||"clientKey"in r||"apiKey"in r||"identifiers"in r||"type"in r):!1}s(lt,"isScrapedIdentifiers");var Go=P(z()),zo=P(G()),Hd=P(z());function Bd(r){switch(typeof r){case"undefined":return!0;case"string":return r.trim()==="";case"number":return isNaN(r);case"object":{if(r==null)return!0;if(p.isObject(r))return Object.keys(r).length===0;if(Array.isArray(r))return r.length===0}}return!1}s(Bd,"isEmpty");var kt=class{static noWhitespace(e){return e&&typeof e=="string"?e.replace(/\s+/g,""):""}static startWith(e,t){return e?e.substring(0,t.length)===t:e===t}static endsWith(e,t){return e.substring(e.length-t.length,e.length)===t}static isEmpty(e){return e===void 0||e===null?!0:e.trim().length===0}static isEmail(e){return typeof e=="string"&&this.validEmailPattern.test(e)}static isLowerCase(e){return e===e.toLowerCase()&&e!==e.toUpperCase()}static isUpperCase(e){return e===e.toUpperCase()&&e!==e.toLowerCase()}static kebabCase(e){return kt.delimiterCase(e,"-")}static snakeCase(e){return kt.delimiterCase(e,"_")}static delimiterCase(e,t){return e.replace(/([A-Z][a-z]+|\d+)/gm,`${t}$1`).replace(new RegExp(`^${t}`),"").toLowerCase()}static titleCase(e){return kt.isEmpty(e)?"":e.replace(/\w\S*/g,t=>t.charAt(0).toUpperCase()+t.substr(1).toLowerCase())}static camelCase(e){return kt.isEmpty(e)?"":e.replace(/([A-Za-z]+|\d+)/gm,t=>t.charAt(0).toUpperCase()+t.substr(1).toLowerCase()).replace(new RegExp("^."),t=>t.toLowerCase()).replace(new RegExp(/[_\-\s]/g),"")}},j=kt;s(j,"Strings"),j.validEmailPattern=/^[a-zA-Z0-9.!#$%&'*+/=?^_`{|}~-]+@[a-zA-Z0-9](?:[a-zA-Z0-9-]{0,61}[a-zA-Z0-9])?(?:\.[a-zA-Z0-9](?:[a-zA-Z0-9-]{0,61}[a-zA-Z0-9])?)*$/;function mr(r,e,t){if(e(r))return t(r);switch(typeof r){case"undefined":return;case"object":{if(r===null)return null;if(Array.isArray(r))return r.map(n=>mr(n,e,t));if(p.isObject(r))return p.keys(r).sort().reduce((n,i)=>{let a=r[i];return n[i]=mr(a,e,t),n},{})}}return r}s(mr,"walkValues");function Cn(r,e){switch(typeof r){case"undefined":return;case"object":{if(r===null)return null;if(Array.isArray(r))return r.map(t=>Cn(t,e));if(p.isObject(r))return p.keys(r).sort().reduce((t,n)=>{let i=r[n];return t[e(String(n))]=Cn(i,e),t},{})}}return r}s(Cn,"walkKeys");var p=class{static isObject(e){return e&&typeof e=="object"&&(e.constructor===Object||/Object.*native/.test(e.constructor.toString()))}static keys(e){return Object.keys(e)}static values(e){return Object.keys(e).map(t=>e[t])}static entries(e){return Object.keys(e).map(t=>[t,e[t]])}static removeEmpty(e){return e&&(p.isObject(e)?Object.keys(e).reduce((t,n)=>{let i=p.removeEmpty(e[n]);return Bd(i)||(t[n]=i),t},{}):e)}static sort(e){return e&&(Array.isArray(e)?e.map(p.sort):p.isObject(e)?Object.keys(e).sort().reduce((t,n)=>{let i=e[n];return t[n]=p.sort(i),t},{}):e)}static toLowerCase(e){return typeof e=="string"?e.toLowerCase():Array.isArray(e)?e.map(p.toLowerCase):d(()=>p.isObject(e))?Object.entries(e).reduce((t,[n,i])=>(t[n]=p.toLowerCase(i),t),{}):e}static snakeCase(e){return Cn(e,j.snakeCase)}static camelCase(e){return Cn(e,j.camelCase)}static filter(e,t){let n=p.keys(e).filter(t);return p.pick(e,...n)}static omit(e,...t){return t.reduce((n,i)=>(Reflect.deleteProperty(n,i),n),e)}static pick(e,...t){return t.reduce((n,i)=>(n[i]=e[i],n),{})}};s(p,"Objects");var C=class{static from(e){return Array.from(e)}static find(e,t){if(e.find)return e.find(t);let[n]=e.filter(t);return n}static findLastIndex(e,t){let n=[...e].reverse().findIndex(t);return n===-1?n:e.length-n-1}static toObject(e){return e.reduce((t,n)=>(Object.keys(n).forEach(i=>{i in t||(t[i]=n[i])}),t),{})}static flatten(e){return e.reduce((t,n)=>t.concat(n),[])}static flatMap(e,t){return e.flatMap?e.flatMap(t):C.flatten(e.map(t))}static unique(e){return Array.from(new Set(e))}static clean(e){return e.filter(Boolean)}static trim(e){return e.map(t=>t.trim())}static includes(e,t){return"includes"in e?e.includes(t):e.indexOf(t)!==-1}static first(e){return e[0]}static last(e){return e[e.length-1]}static safeReverse(e){return e?e.slice().reverse():[]}static shuffle(e){return e.map(t=>({value:t,order:Math.random()})).sort((0,zo.by)("order")).map(({value:t})=>t)}};s(C,"Arrays");var _n=class{static path(e){let t=[e];for(;e.parentElement;)e=e.parentElement,t.push(e);return t}};s(_n,"Elements");function d(r,e=void 0){try{let t=r();return typeof t=="undefined"?e:t}catch(t){return e}}s(d,"get");function Gd(r,e){let t=e.toLowerCase(),n=C.find(Object.keys(r),a=>a.toLowerCase()===t);if(!n)return;let i=r[n];return typeof i=="string"?i.trim():i}s(Gd,"getValue");function On(r,...e){if(!r)return[];if(Array.isArray(r))return C.clean(C.flatten(r.map(t=>On(t,...e))));if(typeof r=="object"){let[t,...n]=e,i=Gd(r,t);return typeof i=="object"?On(i,...n):n.length===0&&Boolean(i)?[i]:[]}return[]}s(On,"getAll");var X=(()=>typeof self!="undefined"?self:typeof window!="undefined"?window:typeof global!="undefined"?global:typeof module!="undefined"?module:Function("return this")())();function In(r,e,t){let n=r[e];return typeof n=="undefined"?r[e]=t:Array.isArray(n)?n.indexOf(t)==-1&&n.push(t):r[e]=[n,t],r}s(In,"accumulateMultipleValues");function zd(r,e,t,n=i=>i){let i=[],a=0,o;for(;(o=r.exec(e))!=null;)i.push(n(e.substring(a,o.index))),i.push(t(o)),a=r.lastIndex;return i.push(n(e.substring(a))),i.join("")}s(zd,"regexReplace");function Wo(r){return zd(/\w+/g,r,e=>Wd(e[0]))}s(Wo,"titleCase");function Wd(r){return r.substr(0,1).toUpperCase()+r.substr(1).toLowerCase()}s(Wd,"caseWord");function Vo(r,e){return r.slice(0,e)}s(Vo,"limit");function Jo(r){return d(()=>C.last(r.constructor.name.split("$")),"")}s(Jo,"getClassName");function Yo(r){return r?r.replace(/\s+/g," ").trim():""}s(Yo,"cleanText");var Vs=P(qe());var Bc=P(ae()),Gc=P(Re());function ce(r=X){return r.triptease=r.triptease||{},r.triptease.onboard=r.triptease.onboard||{},{triptease:r.triptease,onboard:r.triptease.onboard}}s(ce,"globalObjects");var rt;(function(n){n.Native="native",n.NonNative="non-native",n.NotImplemented="not-implemented"})(rt||(rt={}));function zc(r,e){return d(()=>e.split(".").reduce((t,n)=>t[n],r))}s(zc,"getProperty");function Gp(r){return r==null?rt.NotImplemented:typeof r=="function"?r.toString().includes("native code")?rt.Native:rt.NonNative:rt.Native}s(Gp,"isNative");var Jn=class{static exposeApi(){let e=ce(X).triptease;e.native||(e.native=Jn)}static getProperty(e){let t=zc(X,e);return Gp(t)!==rt.NonNative?t:zc(Jn.window,e)}static get window(){let e=X;if(!e.document)return e;try{let t=e.document,n=t.querySelector("[name='triptease.native']");if(n)return n.contentWindow;let i=t.createElement("iframe");return i.style.display="none",i.setAttribute("title","blank"),i.setAttribute("aria-hidden","true"),i.setAttribute("name","triptease.native"),t.documentElement.appendChild(i),i.contentWindow}catch(t){return e}}},te=Jn;s(te,"Native"),je([Bc.cache],te,"getProperty",1),je([Gc.lazy],te,"window",1);var zp=/^\d{4}-\d{2}-\d{2}(?:T\d{2}:\d{2}:\d{2}\.\d{3}Z)?$/;function Wp(r){return mr(r,e=>typeof e=="string"&&zp.test(e),e=>{let t=new Date(e);return isNaN(t.valueOf())?e:t})}s(Wp,"convertDates");var Vp=te.getProperty("JSON.parse"),Jp=te.getProperty("JSON.stringify"),Yp=te.getProperty("Date.prototype.toISOString"),$=class{static parse(e){return Vp(e)}static parseWithDates(e){return Wp($.parse(e))}static stringify(e){return Jp(this.clean(e))}static clean(e){return mr(e,t=>{let n=typeof t;switch(n){case"undefined":case"string":case"number":case"boolean":return!0;case"object":{if(t===null)return!0;if(Array.isArray(t)||p.isObject(t))return!1;if("toJSON"in t)return!0}}throw new Error(`Illegal JsonValue: ${n} ${t} `)},t=>t instanceof Date?Yp.call(t):t)}};s($,"Json");var E=class{static same(e,t){return $.stringify(e)===$.stringify(t)}static isSuperset(e,t){return e===null||t===null?E.same(e,t):Array.isArray(e)&&Array.isArray(t)?e.length>t.length?!1:e.every(n=>t.some(i=>E.isSuperset(n,i))):d(()=>p.isObject(e))&&d(()=>p.isObject(t))?Object.keys(e).reduce((n,i)=>n&&E.isSuperset(e[i],t[i]),!0):E.same(e,t)}static compress(e){let t=E.groupValues(e);return this.compressGrouped(t)}static compressGrouped(e){return Object.entries(e).reduce(({shared:t,unique:n},[i,a])=>{if(d(()=>p.isObject(a))){let o=E.compressGrouped(a);Object.keys(o.shared).length>0&&(t[i]=o.shared),o.unique.forEach((c,u)=>{n[u]=n[u]||{},Object.keys(c).length>0&&(n[u][i]=c)})}return Array.isArray(a)&&a.forEach((o,c)=>{n[c]=n[c]||{},C.unique(a.map(u=>$.stringify(u))).length===1?t[i]=o:o!==void 0&&(n[c][i]=o)}),{shared:t,unique:n}},{shared:{},unique:[]})}static groupValues(e){let t=Array.from(e.reduce((o,c)=>Object.keys(c).reduce((u,l)=>u.add(l),o),new Set)),[n,i]=e.reduce((o,c)=>t.reduce(([u,l],h)=>{let D=c[h];return d(()=>p.isObject(D))?(l[h]=l[h]||[],l[h].push(D)):(u[h]=u[h]||[],u[h].push(D)),[u,l]},o),[{},{}]),a=Object.entries(i).reduce((o,[c,u])=>(o[c]=E.groupValues(u),o),{});return m(m({},n),a)}static decompress(e){return e.unique.map(t=>this.merge(e.shared,t))}static merge(e,t){return[...Object.keys(e),...Object.keys(t)].reduce((i,a)=>{let o=e[a],c=t[a];return d(()=>p.isObject(o))&&d(()=>p.isObject(c))?i[a]=E.merge(o,c):i[a]=c!=null?c:o,i},{})}};s(E,"JsonValues");function ve(r,e=!0){return r?(r.indexOf("?")==0&&(r=r.substring(1,r.length)),r.split("&").map(function(t){return t.split("=")}).reduce(function(t,n){let i=n[0],a=n[1];if(!i)return t;let o=Wc(a),c=e?Zp(o):o;return In(t,Wc(i),c)},{})):{}}s(ve,"queryObject");function Wc(r){return d(()=>decodeURIComponent(r.replace(/\+/g,"%20")),r)}s(Wc,"decode");function Zp(r){try{return $.parse(r)}catch(e){return r}}s(Zp,"coerce");var Vc=P(ne()),Jc=P(G()),ze=P(z());function Yc(r){return r?r.trim().split(/[-_]/).filter(Boolean).map((e,t)=>t===0?e.toLowerCase():t===1&&e.length===2?e.toUpperCase():e):[]}s(Yc,"localeParts");function Xp(r){let[e]=Yc(r);return e}s(Xp,"languageOf");function Qp(r){let e=Yc(r);if(e.length!==0)return e.join("-")}s(Qp,"cleanLocale");var zs=class{localeOf(e){return[e.documentElement.lang,e.documentElement.getAttribute("xml:lang")].filter(Boolean)}};s(zs,"DocumentLocaleDetector");var Ws=class{localeOf(e){var n;let t=ve((n=e.defaultView)==null?void 0:n.location.search).lang;return typeof t!="string"?[]:[t]}};s(Ws,"QueryStringLocaleDetector");var Wt=class{constructor(e){this.tld=e}static create(e){let[,t]=d(()=>e.defaultView.location.hostname.match(Wt.pattern))||[];return new Wt(t)}enrich(e){let t=d(()=>Wt.mapping[this.tld],this.tld);return t&&Wt.validate(`${e}-${t}`)||e}static validate(e){try{let[t]=Intl.DateTimeFormat.supportedLocalesOf(e);return t}catch(t){}}},Yn=Wt;s(Yn,"CountryCodeTLDEnricher"),Yn.pattern=/\.(\w{2})$/,Yn.mapping={uk:"GB",co:"US"};function ef(r){if(!r)return!1;if(r==="is"||r==="is-IS")return!0;try{let[e]=Intl.DateTimeFormat.supportedLocalesOf(r);return!!e}catch(e){}return!1}s(ef,"isLocaleValid");var Zn=class{constructor(){this.detectors=[new Ws,new zs]}static detectLocale(e){let[t]=Zn.instance.localeOf(e);return t}localeOf(e){return(0,Vc.array)(this.detectors,(0,ze.flatMap)(t=>t.localeOf(e)),(0,ze.map)(Qp),(0,ze.filter)(ef),(0,ze.unique)((0,Jc.by)(Xp)))}},kr=Zn;s(kr,"SimpleLocaleDetector"),kr.instance=new Zn;var Zc;(function(t){t.rate="rate",t.room="room"})(Zc||(Zc={}));function N(r){return r&&[r.innerText,r.textContent,r.value,r.defaultValue].map(Yo).find(Boolean)||""}s(N,"innerText");function nt(r){return kr.detectLocale(r.document)}s(nt,"getLanguageFromDocument");function Xc(r){return nt(r)||r.navigator.language}s(Xc,"getLanguageFromDocumentOrBrowser");function tf(r,e){if(j.isEmpty(e))return[];let t=new RegExp(`[${Vs.Numerals.get(r).pattern}]+`,"g"),n=Vs.Numerals.get(r);return(e.match(t)||[]).map(i=>n.parse(i))}s(tf,"parseNumbers");var rf={adultsIndex:0,strict:!0,includeInfants:!1};function nf(r){let e=E.merge(rf,r);return e.childrenIndex===void 0&&(e.childrenIndex=e.adultsIndex+1),e.infantIndex===void 0&&(e.infantIndex=e.childrenIndex+1),e}s(nf,"setDefaultOccupancyOptions");function Xn(r,e,t=0,n=t+1){return new Js(r,{adultsIndex:t,childrenIndex:n,strict:!1}).parseOrUndefined(e)}s(Xn,"parseOccupancy");var Js=class{constructor(e,t={}){this.locale=e;this.options=nf(t)}parseOrUndefined(e){let t=tf(this.locale,e);if(t.length!==0&&!(this.options.strict&&t.length!==this.expectedLength()))return{adults:t[this.options.adultsIndex],children:this.calculateChildren(t)}}expectedLength(){return Math.max(this.options.adultsIndex,this.options.childrenIndex,this.options.includeInfants?this.options.infantIndex:0)+1}calculateChildren(e){let t=e[this.options.childrenIndex];if(t===void 0)return 0;if(this.options.includeInfants){let n=e[this.options.infantIndex]||0;return t+n}return t}parse(e){let t=this.parseOrUndefined(e);if(!t)throw new Error("No occupancy found");return t}parseAll(e){let t=this.parseOrUndefined(e);return t?[t]:[]}};s(Js,"OccupancyParser");var fu=P(qe()),mu=P(ae()),yu=P(ai()),gu=P(Nt()),hu=P(na()),bu=P(Fr()),jr=class{constructor(e=e){this.window=e;this.dateParser=(0,fu.parser)("en-GB","dd MMM yyyy")}getMoneyParser(e,t){let n={strategy:(0,yu.prefer)(t)};return(0,gu.parsers)((0,hu.flexibleMoneyParser)(e,n),(0,bu.parser)(e,n))}getDates(){let e=N(this.window.document.querySelector(".ca-booking-date-range")),[t,n]=this.dateParser.parseAll(e);return{checkin:t,checkout:n}}getRateDetails(e){let t=d(()=>this.window.document.querySelector(".selected-currency").dataset.selectedCurrency),n=this.getMoneyParser(e,t);return Array.from(this.window.document.querySelectorAll('div[data-component-id="room-card"]')).filter(a=>a.dataset.bedTypeOpts!=="{}").flatMap(a=>{let o=N(a.querySelector(".rate-card-room-heading"));return Array.from(a.querySelectorAll(".more-rate-card-container")).flatMap(u=>{let l=u.querySelector(".more-rate-title"),h=N(l),D=l.dataset.ratePlanCode,g=u.querySelector(".present-rate:not(.hidden)"),_=N(g.querySelector("span.rc-selected-currency:not(.hidden)")),re=N(g.querySelector("span.rc-total-amount:not(.hidden)")),q=`${_}${re}`,[Se]=n.parseAll(q);return Se?{price:Se.amount,currency:Se.currency,rateName:h,rateCode:D,roomName:o}:[]})})}integrationData(){if(d(()=>this.window.document.querySelector(".tab-selected").dataset.rateFilterCode)!=="STD")return;let t=nt(this.window),n=this.getRateDetails(t),i=Xn(t,N(this.window.document.querySelector(".room-selection-data")),1);return p.removeEmpty(S(m(m({type:x.RoomsAndRates},this.getDates()),i),{rooms:1,language:t,rateDetails:n,ratesModified:this.getRatesModified(n.length),total:!1}))}getRatesModified(e){let t=!!this.window.document.querySelector(".room-rate-unavailable.visible"),n=Array.from(this.window.document.querySelectorAll(".soldOut, #sold-out")).map(i=>this.window.getComputedStyle(i).display!=="none").some(i=>i);if(e===0&&(n||t))return"noAvailability"}};s(jr,"TajRoomsAndRates"),je([mu.cache],jr.prototype,"getMoneyParser",1);var vu=P(ai()),ia=P(qe()),oi=class{constructor(e=window){this.browserWindow=e}integrationData(){let e=N(this.browserWindow.document.querySelector(".cart-currency-symbol")),t=d(()=>this.browserWindow.totalRevenue,""),n=nt(this.browserWindow),i=`${e}${t}`,a=(0,vu.parse)(`${i}`,n);return{type:x.Confirmation,checkin:(0,ia.parse)(this.browserWindow.ArrivalDtYYYYMMDD,n,"yyyy/MM/dd"),checkout:(0,ia.parse)(this.browserWindow.DepartDtYYYYMMDD,n,"yyyy/MM/dd"),currency:a.currency,basePrice:void 0,price:a.amount,reference:this.browserWindow.reservationNumber}}};s(oi,"TajConfirmation");var xu=P(Rn());var ci=class{static get(){return d(()=>{let e="7014.87142";return e?"v"+e:"latest"})}};s(ci,"Version");var ui=class{constructor(e,t=new xu.SystemClock){this.window=e;this.clock=t}app(){return{name:d(()=>ce(this.window).onboard.integrationName.canonical),version:ci.get()}}address(){return{}}scrape(){return p.removeEmpty({address:d(()=>this.address())})}};s(ui,"Integration");var sa=P(ae()),wu=P(ai()),Du=P(Nt()),Su=P(na()),Pu=P(Fr()),Au=P(qe()),Tu=P(ne()),li=P(z()),Yt=class{constructor(e){this.window=e}getDateParser(e){return(0,Au.parser)(e,{day:"numeric",month:"short",year:"numeric"})}getMoneyParser(e,t){let n={strategy:(0,wu.prefer)(t)};return(0,Du.parsers)((0,Su.flexibleMoneyParser)(e,n),(0,Pu.parser)(e,n))}getDates(e){let[t,n]=Array.from(this.window.document.querySelectorAll("#check-in, #check-out")).flatMap(i=>this.getDateParser(e).parseAll(N(i)));return{checkin:t,checkout:n}}getReservations(e,t){let n=Array.from(this.window.document.querySelectorAll(".confirmation-selected-rooms-card")),i=Array.from(this.window.document.querySelectorAll(".summary-charges-room-total-price .summary-charges-item-value")).map(N);return(0,Tu.array)(n,(0,li.zip)(i),(0,li.flatMap)(([a,o])=>{let c=N(a.querySelector(".room-reservation-number")),{adults:u,children:l}=Xn(e,N(a.querySelector(".room-details")),1)||{},h=d(()=>N(a.querySelector("#roomTypeCode").childNodes[0])),D=N(a.querySelector(".cart-amenities-description")),g=Array.from(a.querySelectorAll(".confirmation-price-con span")).map(N).join(" "),[_]=this.getMoneyParser(e,t).parseAll(g),[re]=this.getMoneyParser(e,t).parseAll(o);return[p.removeEmpty({reference:c,reservationStatus:"confirmed",adults:u,children:l,roomName:h,rateName:D,price:d(()=>_.amount),basePrice:d(()=>re.amount),currency:d(()=>_.currency,re.currency)})]}))}integrationData(){let e=nt(this.window),{selectedCurrency:t}=d(()=>this.window.document.querySelector("span[data-selected-currency]").dataset,{}),n=N(this.window.document.querySelector("#itineraryNumber")),i=N(this.window.document.querySelector("#summaryTotalCharges.summary-charges-item-value")).replace("*",""),[a]=this.getMoneyParser(e,t).parseAll(i),o=this.getReservations(e,t);return p.removeEmpty(S(m({type:x.Confirmation,language:e,itinerary:n,reference:o.map(c=>c.reference).concat(n).filter(Boolean).sort().join(","),price:d(()=>a.amount),currency:d(()=>a.currency)},this.getDates(e)),{reservations:o}))}};s(Yt,"TajConfirmationV2"),je([sa.cache],Yt.prototype,"getDateParser",1),je([sa.cache],Yt.prototype,"getMoneyParser",1);var di=class extends ui{constructor(){super(...arguments);this.pages=[new Yt(this.window),new oi(this.window),new jr(this.window)]}scrape(){return p.removeEmpty({clientKey:"QJk3eOvpNV",identifiers:[{identifier:d(()=>window.dataLayerData.hotelCode),type:"Trusted",identifierType:"HotelCode"},{identifier:d(()=>window.dataLayerData.hotelName),type:"Trusted",identifierType:"HotelName"}].filter(e=>e.identifier)})}};s(di,"Taj");var aa=class{constructor(e){let t=aa.RFC_3986.exec(e);if(!t)throw new Error(`Invalid Uri: ${e}`);let[,,n,,i,a,,o,,c]=t;this.scheme=n,this.authority=i?new pi(i):void 0,this.path=a,this.query=o,this.fragment=c}toString(){let e=[];return typeof this.scheme!="undefined"&&e.push(this.scheme,":"),typeof this.authority!="undefined"&&e.push("//",this.authority.toString()),e.push(this.path),typeof this.query!="undefined"&&e.push("?",this.query),typeof this.fragment!="undefined"&&e.push("#",this.fragment),e.join("")}get host(){return this.authority&&this.authority.host}get port(){return this.authority&&this.authority.port}get userInfo(){return this.authority&&this.authority.userInfo}},Y=aa;s(Y,"Uri"),Y.RFC_3986=/^(([^:/?#]+):)?(\/\/([^/?#]*))?([^?#]*)(\?([^#]*))?(#(.*))?/;var oa=class{constructor(e){let t=oa.RFC_3986.exec(e);if(!t)throw new Error(`Invalid Authority: ${e}`);let[,n,i,a]=t;this.userInfo=n,this.host=i,this.port=a}toString(){let e=[];return typeof this.userInfo!="undefined"&&e.push(this.userInfo,"@"),typeof this.host!="undefined"&&e.push(this.host),typeof this.port!="undefined"&&e.push(":",this.port),e.join("")}},pi=oa;s(pi,"Authority"),pi.RFC_3986=/(?:([^@]+)@)?([^:]+)(?::([\d]+))?/;var Cu=te.getProperty("console.log"),Pf=te.getProperty("console.error"),Af=te.getProperty("console.debug"),ca=class{constructor(e=Cu,t=Pf,n=Af||Cu){this.log=e;this.error=t;this.debug=n}};s(ca,"ConsoleLogger");var ua=class{constructor(){this.log=s(()=>{},"log");this.error=s(()=>{},"error");this.debug=s(()=>{},"debug")}};s(ua,"NoOpLogger");var _u="triptease-debug",Tf=256;function la(r,e=_u){let t=d(()=>{var n;return ve((n=r.location)==null?void 0:n.search,!1)[e]})||d(()=>{var n;return ve(new Y((n=r.location)==null?void 0:n.originalHref).query,!1)[e]})||d(()=>{var n,i;return(i=(n=r.process)==null?void 0:n.env)==null?void 0:i.DEBUG})||d(()=>{var n;return((n=r.localStorage)==null?void 0:n.getItem)&&r.localStorage.getItem(e)})||d(()=>{var n;return((n=r.sessionStorage)==null?void 0:n.getItem)&&r.sessionStorage.getItem(e)})||"";return d(()=>t.substring(0,Tf),"")}s(la,"globalParameter");function Cf(r){return la(r,_u).split(",").map(e=>e.trim())}s(Cf,"debugPatterns");function Ou(r){let e=r.replace(/\./g,"\\.").replace(/\*/g,".*");return new RegExp("^"+e+"$")}s(Ou,"wildcardToRegexp");function _f(r,e=X){try{let t=Cf(e),n=t.filter(i=>i[0]==="!").map(i=>i.substr(1));return n.length>0?!n.some(i=>Ou(i).test(r)):t.some(i=>i==="true"||Ou(i).test(r))}catch(t){return!1}}s(_f,"nameMatches");var da=class{constructor(e){this.name=e;this.console=new ca}debug(e,...t){this.console.debug(`[${this.name}] ${e}`,...t)}log(e,...t){this.console.log(`[${this.name}] ${e}`,...t)}error(e,...t){this.console.error(`[${this.name}] ${e}`,...t)}};s(da,"NamedLogger");function O(r,e=X){return _f(r,e)?new da(r):new ua}s(O,"namedLogger");function fi(r){return r&&typeof r=="object"?r.constructor===Date&&!isNaN(r.getTime()):!1}s(fi,"isDate");function Iu(r){if(r===void 0||!r.type)return!1;switch(r.type){case x.RoomsAndRates:return pa(r);case x.Confirmation:return fa(r);case x.Checkout:return If(r);default:return!0}}s(Iu,"isPageValid");function Of(r){return Array.isArray(r)&&r.some(e=>e.price>0&&e.currency)}s(Of,"hasValidRates");function pa(r){return r&&typeof r=="object"?fi(r.checkin)&&fi(r.checkout)&&r.checkin.getTime()<r.checkout.getTime()&&typeof r.adults=="number"&&typeof r.children=="number"&&(Of(r.rateDetails)||!!r.ratesModified):!1}s(pa,"isRoomsAndRatesPageData");function fa(r){return r&&typeof r=="object"?typeof r.reference=="string"&&!j.isEmpty(r.reference)&&typeof r.price=="number"&&typeof r.currency=="string":!1}s(fa,"isConfirmationPageData");function If(r){var e,t;return r&&typeof r=="object"?typeof((e=r.pii)==null?void 0:e.email)=="string"&&Array.isArray((t=r.pii)==null?void 0:t.processingConditions)&&r.pii.processingConditions.length>0&&!j.isEmpty(r.pii.email)&&j.isEmail(r.pii.email):!1}s(If,"isCheckoutPageData");function Rf(r){if(r===void 0||!r.type)return!1;switch(r.type){case x.RoomsAndRates:return Nr(r);case x.Confirmation:return kf(r);case x.Checkout:return Ef(r);default:return!1}}s(Rf,"isPartialPage");function Nr(r){return r&&typeof r=="object"?Array.isArray(r.rateDetails)&&r.rateDetails.length>0||!!r.ratesModified:!1}s(Nr,"isPartialRoomsAndRates");function kf(r){return r&&typeof r=="object"?typeof r.reference=="string"&&!j.isEmpty(r.reference):!1}s(kf,"isPartialConfirmation");function Ef(r){return r&&typeof r=="object"?typeof r.pii.email=="string"&&!j.isEmpty(r.pii.email):!1}s(Ef,"isPartialCheckout");function Ru(r){let[e]=r.map(p.removeEmpty).filter(Rf);if(!!e)return S(m({},e),{type:x.Partial,partialType:e.type})}s(Ru,"findPartial");function ma(r){let{rateDetails:e}=r;if(!e)return[];let t=e.filter(n=>n.price>0&&!j.isEmpty(n.currency));return C.unique(t.map(n=>n.currency)).length>1?[]:t}s(ma,"validRates");function ku(r){let e=new Set;return r.reduce((t,n)=>{let i=$.stringify(n);return e.has(i)||(e.add(i),t.push(n)),t},[])}s(ku,"deDuplicateRates");function Eu(r){var e,t;if(r===void 0||!r.type)return r;switch(r.type){case x.RoomsAndRates:let n=m({},r);return"ratesModified"in n&&n.ratesModified==="noAvailability"&&(n.adults=(e=n.adults)!=null?e:2,n.children=(t=n.children)!=null?t:0),n;default:return r}}s(Eu,"addDefaultData");function Mf(r){try{let{target:e,method:t}=jf(r.type);if(e&&t)return!0}catch(e){}return!1}s(Mf,"isOnboardMessage");var Lr=class{constructor(e,t,n=qf,i=O("messaging")){this.listener=e;this.allowedOrigins=n;this.logger=i;this.target=this.listener!==t?t:void 0}addListener(e){this.listener&&this.listener.addEventListener("message",t=>{this.disallowedOrigin(t)||!Mf(t.data)||e(t.data,new Lr(void 0,t.source||this.target))})}disallowedOrigin(e){return e.origin&&this.allowedOrigins.length>0&&this.allowedOrigins.indexOf(new Y(e.origin).host)===-1}send(e){if(this.target)try{this.target.postMessage(e,"*")}catch(t){this.target.postMessage(JSON.parse(JSON.stringify(e)),"*")}}};s(Lr,"WindowHandler");var qf=["onboard.triptease.io","localhost"],Ff=/^(.*)\.([^.]+)$/;function jf(r){let[,e,t]=r.match(Ff)||[];return{target:e,method:t}}s(jf,"targetAndMethod");function ya(r){let e={};return function(...t){let n=JSON.stringify(t),i=e[n];return typeof i!="undefined"?i:e[n]=r(...t)}}s(ya,"caching");function Nf(r){return r.document.querySelector('iframe[name="triptease.onboard.kernel"]')}s(Nf,"kernelFrame");function Mu(r){let e=Nf(r);if(e&&e.contentWindow)return new Lr(r,e.contentWindow)}s(Mu,"handlerFor");function qu(r){return r&&typeof r=="object"&&"name"in r&&typeof r.name=="string"&&"message"in r&&typeof r.message=="string"&&"stack"in r&&typeof r.stack=="string"}s(qu,"isError");var mi,Lf=new Uint8Array(16);function ga(){if(!mi&&(mi=typeof crypto!="undefined"&&crypto.getRandomValues&&crypto.getRandomValues.bind(crypto)||typeof msCrypto!="undefined"&&typeof msCrypto.getRandomValues=="function"&&msCrypto.getRandomValues.bind(msCrypto),!mi))throw new Error("crypto.getRandomValues() not supported. See https://github.com/uuidjs/uuid#getrandomvalues-not-supported");return mi(Lf)}s(ga,"rng");var Fu=/^(?:[0-9a-f]{8}-[0-9a-f]{4}-[1-5][0-9a-f]{3}-[89ab][0-9a-f]{3}-[0-9a-f]{12}|00000000-0000-0000-0000-000000000000)$/i;function Kf(r){return typeof r=="string"&&Fu.test(r)}s(Kf,"validate");var ju=Kf;var B=[];for(yi=0;yi<256;++yi)B.push((yi+256).toString(16).substr(1));var yi;function Uf(r){var e=arguments.length>1&&arguments[1]!==void 0?arguments[1]:0,t=(B[r[e+0]]+B[r[e+1]]+B[r[e+2]]+B[r[e+3]]+"-"+B[r[e+4]]+B[r[e+5]]+"-"+B[r[e+6]]+B[r[e+7]]+"-"+B[r[e+8]]+B[r[e+9]]+"-"+B[r[e+10]]+B[r[e+11]]+B[r[e+12]]+B[r[e+13]]+B[r[e+14]]+B[r[e+15]]).toLowerCase();if(!ju(t))throw TypeError("Stringified UUID is invalid");return t}s(Uf,"stringify");var Nu=Uf;function $f(r,e,t){r=r||{};var n=r.random||(r.rng||ga)();if(n[6]=n[6]&15|64,n[8]=n[8]&63|128,e){t=t||0;for(var i=0;i<16;++i)e[t+i]=n[i];return e}return Nu(n)}s($f,"v4");var ha=$f;var Hf=s(()=>d(()=>crypto.randomUUID())||ha(),"uuid"),gi=class{generate(e){if(typeof e!="undefined")throw new Error("UuidGenerator does not support custom lengths");return Hf().replace(/-/g,"")}};s(gi,"UUIDGenerator");var ba=class{constructor(e,t){this.messaging=e;this.idGenerator=t}get(e,t,n){return(...i)=>f(this,null,function*(){let a=this.idGenerator.generate(),{payload:o}=yield this.messaging.handle({type:"triptease.onboard.request",requestType:String(t),payload:i,correlationId:a});if(qu(o))throw o;return o})}};s(ba,"MessageProxy");function hi(r,e=new gi){return new Proxy({},new ba(r,e))}s(hi,"messageProxy");var bi=class{constructor(e,t=hi(e)){this.proxy=t;this.applicationConfig=ya(e=>f(this,null,function*(){return yield this.proxy.applicationConfig(e)}));this.generateConfig=ya(e=>f(this,null,function*(){return yield this.proxy.generateConfig(e)}))}};s(bi,"KernelProxy");var vi=class{constructor(e,t){this.providers=e;this.logger=t}scrape(){return f(this,null,function*(){return(yield Promise.all(this.providers.map(t=>f(this,null,function*(){try{return this.clean(yield t.scrape())}catch(n){return this.logger.error("Scraper threw error, probable identification failure",n),{}}})))).reduce((t,n)=>m(m({},t),n),{})})}clean(e){let t=p.removeEmpty(e);return t.identifiers&&(t.identifiers=t.identifiers.filter(n=>!!n.identifier).map(n=>p.removeEmpty({identifier:n.identifier.toString().trim(),type:n.type,identifierType:n.identifierType,source:n.source})).filter(n=>!j.isEmpty(n.identifier))),t}};s(vi,"CompositeScraper");function Kr(r){if(j.isEmpty(r))return{};if(r.indexOf(":")!==-1){let[e,t]=r.split(":");return{clientKey:e,identifiers:[{identifier:t,type:"Trusted",identifierType:"HotelCode"}]}}return{apiKey:r}}s(Kr,"processApiKey");function xi(r){if(!lt(r))return{};let{integrationId:e,clientKey:t,apiKey:n,identifiers:i,type:a}=r,o=Kr(n);return e&&(o.integrationId=e),t&&(o.clientKey=t),i&&(o.identifiers=i),a&&(o.type=a),o}s(xi,"processIdentifiers");var Zt=class{constructor(e){this.window=e;this.scripts=new Set}static create(e){let t=ce(e).onboard,n=t.stackScriptFinder;return n||(t.stackScriptFinder=new Zt(e))}capture(){let e=Gf();e&&this.scripts.add(e);let t=this.window.document.currentScript;t&&"src"in t&&this.scripts.add(t.src)}get(){return Array.from(this.scripts).map(e=>new Y(e))}};s(Zt,"StackScriptFinder");var Bf=/(https?.*):\d+:\d+/;function Gf(){try{throw new Error}catch(r){if(!r.stack)return;let e=r.stack.match(Bf);return e?e[1]:void 0}}s(Gf,"rawScript");var Ve=class{static find(e){return this.scripts(e).map(t=>new Y(t.src))}static scripts(e){let n=["bootstrap.js","/paperboy/","/identity-service/confirm"].map(a=>`script[src*="${a}"][src*="triptease.io"]`);n.push('script[src*="triptease.net"]');let i=n.join(", ");return e.querySelectorAll(i)}};s(Ve,"ScriptsFinder");var Ur=class{static difference(e,t){return Array.from(e).reduce((n,i)=>t.has(i)?n:n.add(i),new Set)}};s(Ur,"Sets");var $r=O("events"),wi=class{constructor(e,t){this.timers=e;this.handle=t;this.finders=new Set;this.keepers=new Set;this.handleEvent=s(e=>f(this,null,function*(){try{$r.debug("CreatedOrDeletedEvents: Checking for new created items");let t=new Set(Array.from(this.finders).flatMap(a=>a())),n=Ur.difference(t,this.keepers),i=Ur.difference(this.keepers,t);this.keepers=t,(n.size>0||i.size>0)&&($r.log(`CreatedOrDeletedEvents: ${n.size} created, ${i.size} deleted element detected - firing event`),yield this.handle(e))}catch(t){$r.error("CreatedOrDeletedEvents.handleEvent threw while polling",t)}}),"handleEvent")}start(){return f(this,null,function*(){$r.log("Start polling for created items"),this.id=this.timers.setInterval(this.handleEvent,1e3)})}stop(){return f(this,null,function*(){$r.log("Stop polling for created items"),this.id&&(this.timers.clearInterval(this.id),this.id=void 0)})}watch(e){e().forEach(n=>this.keepers.add(n)),this.finders.add(e)}};s(wi,"CreatedOrDeletedEvents");function Lu(r,e){return()=>Array.from(r.querySelectorAll(e))}s(Lu,"selectorFinder");var db=te.getProperty("Date");var Di=class{now(){return new Date}};s(Di,"SystemClock");function Ku(r){return new Promise(e=>{this.setTimeout(()=>{e()},r)})}s(Ku,"delay");var De=class{constructor(e=new Di){this.clock=e;this.delay=Ku.bind(this);this.delay=Ku}task(e){return f(this,null,function*(){return yield this.delay(0),e()})}setTimeout(e,t){return setTimeout(e,t)}clearTimeout(e){clearTimeout(e)}setInterval(e,t){return setInterval(e,t)}clearInterval(e){clearInterval(e)}requestIdleCallback(e,t){let n=t?t.timeout:1,i=this.clock.now().getTime()+n,a=this;return this.setTimeout(()=>{e({didTimeout:!1,timeRemaining(){return Math.max(0,50-(a.clock.now().getTime()-i))}})},n)}cancelIdleCallback(e){this.clearTimeout(e)}};s(De,"SystemTimers");var yb=new De;var zf=O("events"),Si=class{constructor(e,t){this.window=e;this.delegate=t;this.first=!0;this.fire=s(e=>f(this,null,function*(){if(this.window.document.hidden&&!this.first){zf.log("Document hidden - skipping",e);return}yield this.delegate.fire(e),this.first=!1}),"fire")}listen(e){return f(this,null,function*(){yield this.delegate.listen(e)})}removeListener(e){this.delegate.removeListener(e)}};s(Si,"VisibilityGuard");var va=O("events"),Pi=class{constructor(e,t){this.delegate=e;this.running=t;this.fire=s(e=>f(this,null,function*(){if(this.running.value){va.log("Already running - skipping",e);return}this.running.value=!0,yield this.delegate.fire(e),this.running.value=!1}),"fire")}listen(e){return f(this,null,function*(){if(yield this.delegate.listen(e),this.running.value){va.log("Already running - firing immediately");try{yield e()}catch(t){va.log(t)}}})}removeListener(e){this.delegate.removeListener(e)}};s(Pi,"EventsGuard");var Uu=O("events"),Ai=class{constructor(){this.handlers=[];this.fire=s(e=>f(this,null,function*(){Uu.log(`Firing handlers(${this.handlers.length})`,e),yield Promise.all(this.handlers.map(t=>f(this,null,function*(){try{yield t()}catch(n){Uu.log("Error while firing handler",n)}})))}),"fire")}listen(e){return f(this,null,function*(){this.handlers.push(e)})}removeListener(e){this.handlers=this.handlers.filter(t=>t!==e)}};s(Ai,"EventsMultiplexer");var $u=O("events"),Ti=class{constructor(e,t){this.timers=e;this.delegate=t;this.timeoutMs=1e3;this.timerId=0;this.fire=s(e=>f(this,null,function*(){$u.log(`Event observed, waiting for ${this.timeoutMs} ms quiet`,e),this.timers.clearInterval(this.timerId),this.timerId=this.timers.setTimeout(()=>f(this,null,function*(){$u.log("Event quiet period ended, firing event",e),yield this.delegate(e)}),this.timeoutMs)}),"fire")}};s(Ti,"EventCollapser");var Wf=O("events"),Ci=class{constructor(e,t,n=.2,i=new De){this.handle=e;this.running=t;this.idleThreshold=n;this.timers=i;this.lastState=!1;this.busy=!1;this.average=new Xt;this.idleHandler=s(e=>{let t=e.timeRemaining();this.running.value?this.busy=!1:t===0?this.busy=!0:(this.average=this.average.calculate(t),this.busy=this.average.percentage<-this.idleThreshold),this.busy?this.idleId=void 0:this.idleId=this.timers.requestIdleCallback(this.idleHandler,t===0?void 0:{timeout:t})},"idleHandler");this.intervalHandler=s(()=>f(this,null,function*(){this.stateHasChanged()&&this.isIdle()&&(Wf.log("Browser idle"),yield this.handle("Idle")),this.average=new Xt,this.lastState=this.busy,this.idleId||(this.idleId=this.timers.requestIdleCallback(this.idleHandler))}),"intervalHandler")}start(){return f(this,null,function*(){this.intervalId=this.timers.setInterval(this.intervalHandler,1e3),this.idleId=this.timers.requestIdleCallback(this.idleHandler)})}stop(){return f(this,null,function*(){this.intervalId&&this.timers.clearInterval(this.intervalId),this.idleId&&this.timers.cancelIdleCallback(this.idleId)})}isIdle(){return!this.busy}stateHasChanged(){return this.lastState!==this.busy}};s(Ci,"IdleEvents");var Xt=class{constructor(e=0,t=0,n=0,i=0){this.value=e;this.count=t;this.difference=n;this.percentage=i}calculate(e){let t=this.count+1,n=e-this.value,i=n/this.value,a=this.value+n/t;return new Xt(a,t,n,i)}};s(Xt,"StreamingAverage");var _i=class{constructor(e,t){this.window=e;this.handle=t}start(){return f(this,null,function*(){this.window.addEventListener("visibilitychange",this.handle),this.window.addEventListener("popstate",this.handle),this.window.addEventListener("hashchange",this.handle),this.window.addEventListener("pageshow",this.handle),this.window.addEventListener("pagehide",this.handle),this.window.document.readyState!=="complete"?this.window.document.addEventListener("DOMContentLoaded",this.handle):yield this.handle("Document already loaded")})}stop(){return f(this,null,function*(){this.window.removeEventListener("visibilitychange",this.handle),this.window.removeEventListener("popstate",this.handle),this.window.removeEventListener("hashchange",this.handle),this.window.removeEventListener("pageshow",this.handle),this.window.removeEventListener("pagehide",this.handle),this.window.document.removeEventListener("DOMContentLoaded",this.handle)})}};s(_i,"WindowEvents");var Oi=class{constructor(){this.value=!1}};s(Oi,"Running");var xa=class{constructor(e,t=new De){this.window=e;let n=new Oi;this.sink=new Si(e,new Pi(new Ai,n)),this.fire=new Ti(t,this.sink.fire).fire,this.mutation=new Qt(this.fire),this.created=new wi(t,this.fire),this.sources=[new Ci(this.fire,n),this.mutation,this.created,new _i(e,this.fire)]}watch(e){this.created.watch(e)}listen(e){return f(this,null,function*(){yield this.sink.listen(e)})}start(){return f(this,null,function*(){yield Promise.all(this.sources.map(e=>e.start()))})}stop(){return f(this,null,function*(){this.sources.forEach(e=>e.stop())})}removeListener(e){this.sink.removeListener(e)}};s(xa,"DefaultEvents");function Ii(r){let e=ce(r).triptease;return e.events=e.events||new xa(r)}s(Ii,"defaultEvents");var Vf={characterData:!0,attributes:!0,childList:!0},Qt=class{constructor(e){this.handle=e;this.observer=new MutationObserver(this.handle)}start(){return f(this,null,function*(){})}stop(){return f(this,null,function*(){this.observer.disconnect()})}static observe(e,t=Vf){if(!("MutationObserver"in X))return e;let n=Ii(X).mutation;return e instanceof HTMLInputElement||e instanceof HTMLSelectElement?e.addEventListener("change",n.handle):n.observer.observe(e,t),e}};s(Qt,"MutationEvents");function wa(r,e=X){return d(()=>Ii(e).watch(Lu(e.document,r))),r}s(wa,"watch");var er=class{constructor(e){this.parent=e}querySelector(e,t){let n=this.parent.querySelector(e);return n||void 0}querySelectorAll(e,t){return Array.from(this.parent.querySelectorAll(e))}};s(er,"DomSelectorApi");var ct=class{constructor(e){this.parent=e}querySelector(e,t){var i;wa(e,(i=this.parent.ownerDocument)==null?void 0:i.defaultView);let n=this.parent.querySelector(e);return n?Qt.observe(n,t):void 0}querySelectorAll(e,t){var n;return wa(e,(n=this.parent.ownerDocument)==null?void 0:n.defaultView),Array.from(this.parent.querySelectorAll(e)).map(i=>Qt.observe(i,t)).filter(Boolean)}};s(ct,"ObservableSelectorApi");var Je=class{constructor(e){this.window=e}scrape(){let e=Ve.find(new er(this.window.document)),t=Zt.create(this.window).get();return Je.extract([...e,...t])}static extract(e){return p.removeEmpty(e.reduce((t,n)=>{let i=t.integrationId?[t.integrationId]:[],a=t.clientKey?[t.clientKey]:[],o=t.apiKey?[t.apiKey]:[],c=t.identifiers?t.identifiers:[],u=ve(n.query,!1),l=Je.pathClientKey(n);l&&a.unshift(l),u.clientKey&&a.unshift(u.clientKey),i.unshift(u.integrationId);let h=Je.queryApiKey(u),D=Kr(h);D.apiKey&&o.unshift(D.apiKey),D.clientKey&&a.unshift(D.clientKey),D.identifiers&&c.unshift(D.identifiers[0]);let[g]=i.filter(Boolean),[_]=a.filter(Boolean),[re]=o.filter(Boolean),q=c.filter(Boolean);return{integrationId:g,clientKey:_,apiKey:re,identifiers:q}},{}))}static queryApiKey(e){return e.apiKey||e.hotelkey||e.hotelKey||e["api-key"]||e.token}static pathClientKey(e){if(e.host==="paperboy.triptease.net"){let[,n]=e.path.match(/\/+([^/.]+)(?:\.js)?$/)||[];return n}let[,t=""]=e.path.match(/\/paperboy\/+([^/.]+)(?:\.js)?$/)||[];if(t!="paperboy"&&t!="confirm")return t}};s(Je,"ScriptScraper");function Hu(r,e){if(e){let t=d(()=>r.tt_apiKeys[e])||d(()=>r.ttApiKeys[e])||d(()=>r.document.apiKeys[e])||d(()=>r.document.ttApiKeys[e]);if(t)return Da(t)}return Da(d(()=>r.ttData.apiKey)||r.ttApiKey||r.document.ttApiKey)}s(Hu,"getApiKey");function Bu(r){return Da(r.tt_clientKey||r.document.ttClientKey||r.document.tt_clientKey)}s(Bu,"getClientKey");var Jf=["CLIENT_KEY","API_KEY"];function Da(r){if(!!r&&!Jf.includes(r))return r}s(Da,"cleanKey");var Ri=class{constructor(e){this.window=e}scrape(){let e=Hu(this.window),t=Kr(e);return p.removeEmpty(S(m({},t),{clientKey:Bu(this.window)}))}};s(Ri,"LegacyScraper");var ki=class{constructor(e){this.pageData=e}scrape(){return xi(this.pageData)}};s(ki,"PageScraper");var Li=P(G());var Yf=O("integration-executor"),Ei=class{process(e){var i;let t=(i=e.reservations)==null?void 0:i.filter(p.isObject).map(a=>m({reservationStatus:"confirmed"},a)),n=S(m({},e),{basePrice:Gu(e.price,e.basePrice),reservations:t,reservationStatus:Qf(S(m({},e),{reservations:t}))});if(n.reservations=em(n),n.basePrice=n.basePrice||zu("basePrice",n.reservations),n.adults===void 0&&n.children===void 0){let a=Zf(n);n.adults=a.adults,n.children=a.children}return p.removeEmpty(n)}};s(Ei,"ConfirmationProcessor");function Zf(r){return!Array.isArray(r.reservations)||r.reservations.length===0?{}:r.reservations.some(e=>e.adults===void 0||e.children===void 0)?{}:r.reservations.reduce((e,t)=>{var n,i;return e.adults+=(n=t.adults)!=null?n:0,e.children+=(i=t.children)!=null?i:0,e},{adults:0,children:0})}s(Zf,"calculateOccupancy");function Xf(r,e){return e?r?r>e:!0:!1}s(Xf,"isBasePriceValid");function Gu(r,e){return Xf(r,e)?e:void 0}s(Gu,"validatedBasePrice");function Qf(r){let{reservationStatus:e,reservations:t}=r;if(e)return e;if(!t||t.length===0)return"confirmed";let n=new Set(t.map(i=>i.reservationStatus));return n.size===1?Array.from(n)[0]:n.has("pending")?"pending":"modified"}s(Qf,"calculateReservationStatus");function em(r){let{reference:e,price:t,currency:n,basePrice:i,reservationStatus:a}=r;if(!r.reservations)return[p.removeEmpty({reference:e,price:t,currency:n,basePrice:i,reservationStatus:a})];let o=r.reservations.map(u=>p.removeEmpty(S(m({},u),{basePrice:Gu(u.price,u.basePrice)}))),c=zu("basePrice",o);return c!==void 0&&c===t?tm("basePrice","price",o):o}s(em,"calculateReservations");function zu(r,e){if(e.every(t=>t[r]))return e.reduce((t,n)=>n.reservationStatus==="confirmed"?(t!=null?t:0)+n[r]:t,void 0)}s(zu,"sumOfConfirmedReservations");function tm(r,e,t){return t.every(n=>!n[e])?(Yf.log(`Changing label from ${r} to ${e} in reservations`),t.map(n=>p.removeEmpty(S(m({},n),{[e]:n[r],[r]:void 0})))):t}s(tm,"changeLabel");var Vu=P(ne()),Mi=P(z());var Hr;(function(n){n.Unknown="Unknown",n.Total="Total",n.Nightly="Nightly"})(Hr||(Hr={}));function Wu(r){return r===!0?Hr.Total:r===!1?Hr.Nightly:Hr.Unknown}s(Wu,"asPriceType");var rm=O("integration-executor"),qi=class{constructor(e,t){this.window=e;this.history=t}process(e){let t=p.removeEmpty(S(m({},e),{type:x.RoomsAndRates}));return t.rateDetails=ku(ma(e)),t.ratesModified=this.calculateRatesModified(t),t.priceType=Wu(t.total),t}calculateRatesModified(e){let{ratesModified:t,promoCodes:n}=e;return t||(this.hasSearchChangedWithoutRatesChanging(e)||this.hasCurrencyChangedWithoutPricesChanging(e)?"untrusted":this.hasRatesChangedWithoutSearchChanging(e)?"roomOrRateFiltered":n&&n.length>0?"discountCode":"none")}hasCurrencyChangedWithoutPricesChanging(e){let t=this.history.find(i=>Nr(i));return!((t==null?void 0:t.rateDetails)&&(e==null?void 0:e.rateDetails)&&t.rateDetails.length===e.rateDetails.length&&e.rateDetails.length>0)||!!E.same(Ju(e.rateDetails,"currency"),Ju(t.rateDetails,"currency"))?!1:E.same(Sa(e.rateDetails,"currency"),Sa(t.rateDetails,"currency"))}hasSearchChangedWithoutRatesChanging(e){let t=this.history.find(n=>Nr(n));if(!t)return!1;if(!E.same(Fi(e),Fi(t)))return E.same(ji(e.rateDetails),ji(t.rateDetails))}hasRatesChangedWithoutSearchChanging(e){let t=this.history.find(o=>Nr(o));if(!t||!E.same(Fi(e),Fi(t)))return!1;let{rateDetails:n,ratesModified:i}=t;if(i==="roomOrRateFiltered")return!0;if(i==="searchInProgress"||i==="untrusted")return!1;let{rateDetails:a}=e;return!(ma(t).length===0&&a&&a.length>0||E.isSuperset(ji(n),ji(a))||im(n,a)||nm(n,a))}};s(qi,"RoomsAndRatesProcessor");function Fi(r){let{apiKey:e,checkin:t,checkout:n,rooms:i,adults:a,children:o,total:c}=r;return p.removeEmpty({apiKey:e,checkin:t,checkout:n,rooms:i,adults:a,children:o,total:c})}s(Fi,"searchParameters");function ji(r){return Sa(r,"rateName","roomName","rateCode","roomCode")}s(ji,"excludeNames");function Sa(r,...e){if(!r)return;let t=e.reduce((n,i)=>(n[i]=void 0,n),{});return r.map(n=>p.removeEmpty(m(m({},n),t)))}s(Sa,"excludeKeys");function Ju(r,...e){if(!!r)return r.map(t=>p.removeEmpty(e.reduce((n,i)=>(n[i]=t[i],n),{})))}s(Ju,"pickKeys");function nm(r,e){if(r.length===0||e.length===0||r.length!==e.length||r[0].currency===e[0].currency)return!1;let t=(0,Vu.array)(r.map(o=>o.price),(0,Mi.zip)(e.map(o=>o.price)),(0,Mi.map)(([o,c])=>c/o)),n=Math.min(...t),i=Math.max(...t),a=(i-n)/i;return rm.debug(`Currency changed percentDifference ${a}`),a<.01}s(nm,"currencyChanged");function Yu(r,e){return e.reduce((t,n)=>{let i=n[r];return i&&(t[i]=t[i]===void 0||n.price<t[i]?n.price:t[i]),t},{})}s(Yu,"cheapestPrices");function im(r,e){let t=["rateName","roomName"];for(let n of t){let i=Yu(n,r),a=Yu(n,e);if(Object.keys(a).length>0&&E.same(i,a))return!0}return!1}s(im,"isCollapsed");var Zu=P(qe()),Ni=P(qe());function Xu(r,e){return d(()=>Ni.Days.between(Ni.Days.startOf(r),Ni.Days.startOf(e)))}s(Xu,"nights");var Ki=class{constructor(e,t,n=new qi(e,t),i=new Ei){this.window=e;this.history=t;this.roomsAndRatesProcessor=n;this.confirmationProcessor=i}process(e){return this.additionalProcessing((()=>{switch(e.type){case x.RoomsAndRates:return this.roomsAndRatesProcessor.process(e);case x.Confirmation:return this.addDatesFromSearch(this.confirmationProcessor.process(e));case x.Checkout:return this.addOccupancyFromSearch(this.addDatesFromSearch(e));default:return e}})())}additionalProcessing(e){let t=m({},e);qa(e)&&(t.nights=Xu(e.checkout,e.checkin)),"rateDetails"in e&&e.rateDetails.length>0&&(t.rateSummary=sm(e.rateDetails));let n=am(e.promoCodes);return n&&(t.promoCodes=n),t}addDatesFromSearch(e){let{checkin:t,checkout:n}=e;if(t&&n)return e;let i=this.history.find(a=>a.type===x.RoomsAndRates);return p.removeEmpty(S(m({},e),{checkin:i==null?void 0:i.checkin,checkout:i==null?void 0:i.checkout}))}addOccupancyFromSearch(e){let{adults:t,children:n}=e;if(t!==void 0&&n!==void 0)return e;let i=this.history.find(a=>a.type===x.RoomsAndRates);return p.removeEmpty(S(m({},e),{adults:i==null?void 0:i.adults,children:i==null?void 0:i.children}))}};s(Ki,"IntegrationDataProcessor");function sm(r){if(!r||r.length===0)return;let e=[...r].sort((0,Li.by)("price",Li.ascending)),[t]=e;return{count:r.length,currency:t.currency,min:t,max:C.last(e)}}s(sm,"rateSummary");function am(r){if(!r)return;let e=new Set(["undefined","null"]);return r.map(t=>t==null?void 0:t.trim()).filter(Boolean).filter(t=>!e.has(t))}s(am,"validCodes");var Ui=class{constructor(e){this.rules=e}clean(e){return typeof e=="string"?this.rules.reduce((t,n)=>typeof n=="function"?n(t):t.replace(n.search,n.replace),e):Array.isArray(e)?e.map(Ie):e&&typeof e=="object"?Object.keys(e).reduce((t,n)=>{let i=e[n];return t[n]=this.clean(i),t},{}):e}};s(Ui,"Cleaner");var Qu=s(r=>r.trim(),"trim"),om={"&amp;":"&","&lt;":"<","&gt;":">","&quot;":'"',"&#x27;":"'","&#x60;":"`","&nbsp;":" "},cm=s(function(r){let e="(?:"+Object.keys(r).join("|")+")",t=RegExp(e),n=RegExp(e,"g");return function(i){return t.test(i)?i.replace(n,a=>r[a]):i}},"createEscaper"),el=cm(om),um={search:/{{.*}}/g,replace:""},lm={search:/[,.\/#!$%^*;:{}\[\]()=_`~'\u201C\u201D\u2018\u2019]+/g,replace:""},tl={search:/\s+/g,replace:" "},dm={search:/\sand\s/gi,replace:" & "},pm={search:/\s*(?:Image|Logo)\s*/gi,replace:""},fm={search:/\s*(?:Uniquement\s+Adultes|Adults?\s*(?:Only)\s*)/gi,replace:""},mm={search:/\sAll\sInclusive\s*/gi,replace:""},ym={search:/\s*[(\[]?Official\s*(?:Hotel)?\s*(?:((?:Web)?Site)|Homepage|booking\s*engine)\s*(?:for|of)?[)\]]?\s*/gi,replace:""},gm={search:/\s&$/,replace:""},hm=new Ui([um,el,lm,tl,pm,fm,mm,ym,dm,gm,Wo,Qu]),rl=new Ui([el,tl,Qu]);function Ie(r){return hm.clean(r)}s(Ie,"clean");function Pa(r){if(r.hasOwnProperty("parentElement"))return r.parentElement;let e=r.parentNode;return e instanceof Element?e:e?Pa(e):null}s(Pa,"parentOf");var bm=/^\s*$/,vm=s(r=>r instanceof Text&&bm.test(r.data),"isWhiteSpace"),xm=["script","style","noscript","a"].map(r=>r.toUpperCase()),wm=s(r=>r&&xm.indexOf(r.tagName)!==-1,"isUninterestingTag"),Dm=s(r=>!vm(r)&&!wm(Pa(r)),"isValid");function $i(r){return r instanceof Element?r:Pa(r)}s($i,"elementOf");function Sm(r){let e=$i(r);if(!!e)return e.getBoundingClientRect()}s(Sm,"clientRectOf");function Pm(r,e){let t=e.documentElement.scrollWidth,n=e.documentElement.scrollHeight,i=e.documentElement.scrollLeft,a=e.documentElement.scrollTop;if(t==0||n==0)return;let o=Sm(r);if(!!o)return{x:(o.left+i)/t,y:(o.top+a)/n,width:o.width/t,height:o.height/n}}s(Pm,"positionOf");function Am(r){if(r instanceof Text)return r.data.trim();if(r instanceof Element)return r.getAttribute("aria-label")||r.getAttribute("title")||r.getAttribute("alt")||void 0}s(Am,"valueOf");function Tm(r,e=.8){return r.y<e&&r.width>0&&r.height>0}s(Tm,"isVisibleDefault");function nl(r,e=Tm){let t=r.document,n=[],i=t.createNodeIterator(t.documentElement,NodeFilter.SHOW_TEXT,null);for(;;){let c=i.nextNode();if(!c)break;Dm(c)&&n.push(c)}let a=t.querySelectorAll("[aria-label], img[title], img[alt]");for(let c=0;c<a.length;c++)n.push(a[c]);n.sort((c,u)=>{let l=$i(c).compareDocumentPosition($i(u));return l&Node.DOCUMENT_POSITION_PRECEDING?1:l&Node.DOCUMENT_POSITION_FOLLOWING?-1:0});let o=[];for(let c=0;c<n.length;c++){let u=n[c],l=Pm(u,t);if(l&&!e(l))continue;let h=Am(u);typeof h=="string"&&h.split(/[\r\n]/).forEach(D=>{if(D.length>2&&D.length<93){let g=$i(u);o.push({source:g?g.tagName.toLowerCase():"",type:"Untrusted",identifierType:"Unknown",identifier:Ie(D)})}})}return o}s(nl,"getDocumentIdentifierSources");var Cm=["context.hotelName","Cart.HName","propertyName","ihReservations.ihHotelName","ihHotelName","HName","transactionHotelName","ratequeryHotelName","hpr","strippedPropertyName","property_name","flipto.sessionData.propertyName","HotelName"];function _m(r){return d(()=>r.event.indexOf("gtm.")===0,!1)}s(_m,"isGtmEvent");function il(r){let e=Array.isArray(r)?r:r.dataLayer||[],t=C.safeReverse(e).filter(n=>!_m(n));return Cm.flatMap(n=>C.clean(C.unique(On(t,...n.split(".")))).map(i=>({source:"dataLayer."+n,identifier:Ie(i),type:"Trusted",identifierType:"HotelName"})))}s(il,"dataLayerIdentifiers");var Hi=class{constructor(e,t,n){this.scope=e;this.property=t;this.seed=n}parentScope(e){let[,...t]=_n.path(e);return C.find(t,n=>n.hasAttribute(this.scope))}getValue(e){return e.hasAttribute(this.scope)?this.processScope(e):e.getAttribute("content")||e.getAttribute("src")||e.getAttribute("href")||e.getAttribute("data")||e.getAttribute("value")||e.getAttribute("datetime")||e.textContent}processScope(e){return C.from(e.querySelectorAll(`*[${this.property}]`)).filter(t=>this.parentScope(t)===e).reduce((t,n)=>{let i=n.getAttribute(this.property);return i?In(t,i,rl.clean(this.getValue(n))):t},this.seed(e))}processDocument(e){return new ct(e).querySelectorAll(`*[${this.scope}]`).map(this.processScope.bind(this))}};s(Hi,"StructuredDataExtractor");var Om=new Hi("itemscope","itemprop",r=>{let t=(r.getAttribute("itemtype")||"Unknown").split("/");return Bi("microdata",{"@type":t.pop(),"@context":t.join("/")})}),Im=new Hi("typeof","property",r=>Bi("rdfa",{"@type":r.getAttribute("typeof"),"@context":r.getAttribute("vocab")})),Rm={processDocument(r){return C.flatten(new ct(r).querySelectorAll('script[type="application/ld+json"]').map(e=>{let n=(e.textContent||"").replace(/[\r\n]/g," ");try{let i=$.parse(n),a=i["@graph"]||i;return Array.isArray(a)?a.map(o=>Bi("json-ld",o)):Bi("json-ld",i)}catch(i){return{"@type":"Error",error:i.toString(),json:n}}}))}};function Bi(r,e){return S(m({},e),{"@format":r})}s(Bi,"addFormat");var sl={processDocument(r){return[...Rm.processDocument(r),...Om.processDocument(r),...Im.processDocument(r)]}};function km(r,e){return[...new Gi(Aa,"Trusted",e).from(r),...new Gi(ol,"Untrusted",e).from(r)].filter(t=>typeof t.identifier!="object")}s(km,"getMinimalIdentifiersFromStructuredData");function al(r,e){let t=sl.processDocument(r).filter(n=>Mm.indexOf(n["@type"])!==-1);return km(t,e)}s(al,"structuredDataIdentifiers");var Gi=class{constructor(e,t,n=!0){this.orderedStructuredDataTypes=e;this.type=t;this.appendBrand=n}from(e){return C.flatten(this.filterStructuredData(e).map(t=>{let n=(Array.isArray(t.name)?t.name:[t.name]).flatMap(a=>({source:`structuredData[@type='${t["@type"]}'].name`,identifier:Ie(this.addBrand(t.brand,a)),type:this.type,identifierType:qm(t["@type"])})),i=t.identifier;return i&&n.push({type:this.type,identifier:i,source:`structuredData[@type='${t["@type"]}'].identifier`,identifierType:"HotelCode"}),n}))}addBrand(e,t){return!this.appendBrand||!e||t.indexOf(e)>=0?t:`${e} ${t}`}filterStructuredData(e){return e?e.filter(Boolean).filter(t=>this.orderedStructuredDataTypes.indexOf(t["@type"])>=0).filter(t=>Boolean(t.name)).sort((t,n)=>this.orderedStructuredDataTypes.indexOf(t["@type"])-this.orderedStructuredDataTypes.indexOf(n["@type"])):[]}};s(Gi,"StructuredDataSources");var Aa=["Hotel","LodgingBusiness","BedAndBreakfast"],ol=["WebSite","LocalBusiness","Organization"],Em=["HotelRoom","LodgingReservation","Offer","SoftwareApplication"],Mm=[...Aa,...ol,...Em];function qm(r){return Aa.includes(r)?"HotelName":"Unknown"}s(qm,"inferIdentifierTypeFrom");function Fm(r){return r.identifier&&r.identifier.length>2&&r.identifier.length<110}s(Fm,"hasSensibleData");var zi=class{constructor(e,t=O("hotel-identifiers-scraper")){this.window=e;this.logger=t}scrape(){return{identifiers:this.identifierSources()}}identifierSources(){let e=[...il(this.window),...al(this.window.document),...Um(this.window.document),...Hm(this.window.document),...jm(this.window),...Nm(this.window.document),...Km(this.window)].filter(Fm);if(this.logger.log("Common identifiers",e),e.find(t=>Wr.has(t.identifierType)))return e;{let t=nl(this.window);return this.logger.log("Additional identifiers",t),[...e,...t]}}};s(zi,"HotelIdentifiersScraper");function Br(r){return r?lt(r)?!!r.apiKey||!!r.identifiers&&r.identifiers.length>0:Array.isArray(r)?r.reduce((e,t)=>e||Br(t),!1):r.constructor===Object?Br(p.values(r)):!1:!1}s(Br,"hasApiKeyOrIdentifier");function jm(r){if(r===void 0)return[];let{scheme:e,host:t,path:n,query:i}=d(()=>r instanceof Y?r:typeof r=="string"?new Y(r):new Y(r.location.href),{});if(e==="about")return[];let a=[t,n].filter(Boolean).flatMap(c=>c==null?void 0:c.split(/[./]/g)),o=Object.values(ve(i,!1));return[...a,...o].filter(c=>c&&c.length>3).map(c=>({identifier:c,type:"Untrusted",source:"url",identifierType:"PossibleIdentifier"}))}s(jm,"urlIdentifiers");function Nm(r){let{HotelCode:e}=Lm(r);return[{identifierType:"PossibleIdentifier",type:"Untrusted",identifier:e,source:"cookie"}]}s(Nm,"cookieIdentifiers");function Lm(r){return d(()=>r.cookie.split(";").reduce((e,t)=>{let[n,i]=t.trim().split("=").map(decodeURIComponent);return e[n]=i,e},{}),{})}s(Lm,"cookieObject");function Km(r){let e=r.explicitHotelIdentifier;return[{identifierType:"PossibleIdentifier",type:"Untrusted",identifier:e,source:"window"}]}s(Km,"miscIdentifiers");function Um(r){return r.title.split(/[|\-:]/).reverse().map(e=>({source:"title",identifier:Ie(e),type:"Untrusted",identifierType:"Unknown"}))}s(Um,"titles");function $m(r){return Array.from(r.getElementsByTagName("meta")).reduce((e,t)=>{let n=t.getAttribute("name")||t.getAttribute("property")||t.getAttribute("http-equiv"),i=t.getAttribute("content");return n&&(e[n]=i),e},{})}s($m,"metaObject");function Hm(r){let e=["site-id","og:title","og:site_name","twitter:title"],t=$m(r);return Object.keys(t).filter(n=>e.indexOf(n)!=-1).map(n=>({source:`meta.${n}`,identifier:Ie(t[n]),type:"Untrusted",identifierType:"Unknown"}))}s(Hm,"metaLabels");var Wi=class{constructor(e){this.storage=e}get(e){let t=this.storage.getItem(e);if(t)return $.parseWithDates(t)}set(e,t){return this.storage.setItem(e,JSON.stringify(t)),this}clear(){this.storage.clear()}};s(Wi,"JsonStorage");var Vi=class{constructor(){this.data=new Map}get(e){return this.data.get(e)}set(e,t){return this.data.set(e,t)}clear(){this.data.clear()}};s(Vi,"InMemoryTypedStorage");var Ji=class{constructor(e){this.stores=e}clear(){this.stores.forEach(e=>d(()=>e.clear()))}get(e){for(let t of this.stores){let n=d(()=>t.get(e));if(n)return n}}set(e,t){return this.stores.forEach(n=>d(()=>n.set(e,t))),this}};s(Ji,"CompositeTypedStorage");function cl(r){return f(this,null,function*(){if(typeof crypto!="undefined"&&crypto.subtle&&typeof TextEncoder!="undefined"){let e=new TextEncoder().encode(r),t=yield crypto.subtle.digest("SHA-256",e);return Array.from(new Uint8Array(t)).map(i=>i.toString(16).padStart(2,"0")).join("")}else{let e=5381;for(let t=0;t<r.length;t++)e=(e<<5)+e+r.charCodeAt(t);return e.toString(16)}})}s(cl,"digest");var rr=class{constructor(e,t=10){this.storage=e;this.LIMIT=t}static create(e,t){let n=new Ji([d(()=>new Wi(e.sessionStorage)),rr.backupStorage]);return new rr(n,t)}add(e){return f(this,null,function*(){let t=this.data(),n=S(m({},this.scrubData(e)),{digest:yield this.getDigest(e)});return t.unshift(n),this.storage.set(rr.storageKey,Vo(t,this.LIMIT)),n})}getDigest(e){return f(this,null,function*(){return yield cl($.stringify(Bm(e)))})}last(){let[e]=this.data();return e}data(){return this.storage.get(rr.storageKey)||[{type:x.Unknown}]}find(e){let t=C.find(this.data(),e);if(t){let n=t,{digest:i}=n;return Ma(n,["digest"])}}clear(){this.storage.clear()}isSameAsLastGeneration(e){return f(this,null,function*(){let t=this.last();return(t.digest||(yield this.getDigest(t)))===(yield this.getDigest(e))})}scrubData(e){let t=m({},e);return delete t.pii,t}},tr=rr;s(tr,"IntegrationHistory"),tr.storageKey="triptease.integration.previous-pages",tr.backupStorage=new Vi;function Bm(r){if(!r)return{};let e=m({},r);return e.hasOwnProperty("ratesModified")&&e.ratesModified!=="searchInProgress"&&delete e.ratesModified,delete e.stats,e}s(Bm,"exclude");var Ta=class{reset(){}summarise(){return{}}timeAsync(e,t){return t()}timeCall(e,t){return t}timeSync(e,t){return t()}};s(Ta,"StubReporter");function ul(){return typeof performance=="object"&&"now"in performance?new Ca:new Ta}s(ul,"createReporter");var Ca=class{constructor(e=[],t=new De){this.timings=e;this.timers=t}timeCall(e,t){let n=this;return function(...i){let a=performance.now(),o=t.apply(this,i),c=performance.now()-a;return n.timings.push({name:e,time:c}),o}}timeSync(e,t){let n=performance.now(),i=t(),a=performance.now()-n;return this.timings.push({name:e,time:a}),i}timeAsync(e,t){return f(this,null,function*(){let n=performance.now(),i=yield this.timers.task(t),a=performance.now()-n;return this.timings.push({name:e,time:a}),i})}summarise(){let e=this.timings.reduce((t,{name:n,time:i})=>{let a=t[n]||{count:0,avg:0,sum:0,min:Number.MAX_VALUE,max:Number.MIN_VALUE};return a.count++,a.min=Math.min(a.min,i),a.max=Math.max(a.max,i),a.sum+=i,a.avg+=(i-a.avg)/a.count,t[n]=a,t},{});return this.reset(),e}reset(){this.timings.length=0}};s(Ca,"RealReporter");var ll="triptease.onboard.response";function dl(r){return r&&typeof r=="object"&&r.type==="triptease.onboard.response"&&typeof r.correlationId=="string"}s(dl,"isOnboardResponse");var pl=O("messaging"),Yi=class{constructor(e){this.messageHandler=e;this.promises=new Map;e&&e.addListener(t=>{if(dl(t)){let{correlationId:n}=t,i=this.promises.get(n);i&&(pl.debug("Sender matched response",t),i.resolve(t),this.promises.delete(n))}})}handle(e){return f(this,null,function*(){return pl.debug("Sending request",e),this.messageHandler&&this.messageHandler.send(e),new Promise((t,n)=>{this.promises.set(e.correlationId,{resolve:t,reject:n})})})}};s(Yi,"Sender");function fl(r){return p.removeEmpty(S(m({},r),{lines:d(()=>r.lines.filter(Boolean).map(String))}))}s(fl,"cleanAddress");var Zi=class{constructor(e,t=60*1e3,n=new De){this.handler=e;this.timeout=t;this.timers=n}handle(e){return f(this,null,function*(){let t=yield Promise.race([this.handler.handle(e),this.timers.delay(this.timeout)]);return t||{type:ll,payload:new Error(`Request ${e.requestType} timed out after ${this.timeout}`),correlationId:e.correlationId}})}};s(Zi,"TimeoutMessageHandler");var vl=P(G());var _a=class{static parse(e){if(!!e)return _a.lookup.get(e.toLowerCase().trim())}},Gr=_a;s(Gr,"UserConsentParser"),Gr.lookup=["none","essential","functionality","performance","marketing","all","auto"].reduce((e,t)=>e.set(t,t),new Map);var Xi=class{constructor(e){this.name=e}},pe=Xi;s(pe,"ConsentManagerName"),pe.Cookiebot=new Xi("Cookiebot"),pe.Unknown=new Xi("Unknown");function ml(r){switch(r){case"essential":case"necessary":return"essential";case"functionality":case"personalisation":case"preferences":return"functionality";case"performance":case"statistics":case"analytics":return"performance";case"marketing":case"advertising":return"marketing"}}s(ml,"alias");function yl(r){var e;return!!((e=r.Cookiebot)==null?void 0:e.consent)}s(yl,"isCookieBot");var Qi=class{constructor(e){this.window=e}find(){let e=["necessary","preferences","statistics","marketing"].map(t=>d(()=>this.window.Cookiebot.consent[t])?ml(t):void 0).filter(Boolean);if(e.length>0)return{source:"cmp",values:e}}get name(){return pe.Cookiebot.name}};s(Qi,"CookieBotConsentFinder");function gl(r){return yl(r)?pe.Cookiebot:pe.Unknown}s(gl,"detectCMP");var hl=new Set(["all"]);function bl(r){let e=new Set(r.filter(Boolean));return e.size===0||e.has("all")?hl:(e.has("none")&&e.size!==1&&e.delete("none"),e.has("auto")&&e.size!==1&&e.delete("auto"),e)}s(bl,"collapseConsentTypes");var Gm=O("consent"),Oa=class{constructor(e){this.window=e}find(){let t=Ve.scripts(new ct(this.window.document)).map(n=>n.dataset.storageConsent).filter(Boolean).flatMap(n=>n.split(/\s*,\s*/g).map(i=>Gr.parse(i))).filter(Boolean);if(t.length>0)return{source:"script",values:t}}};s(Oa,"ScriptConsentFinder");var Ia=class{constructor(e){this.window=e;this.cmpMapper=new Map([[pe.Cookiebot,new Qi(e)]])}find(){var e;if(!this.cmpFinder){let t=gl(this.window);this.cmpFinder=t!==pe.Unknown?this.cmpMapper.get(t):void 0}return(e=this.cmpFinder)==null?void 0:e.find()}};s(Ia,"CMPConsentFinder");var es=class{constructor(e,t=[new Oa(e),new Ia(e)]){this.window=e;this.finders=t}find(){let e=this.finders.map(t=>t.find()).filter(Boolean);return Gm.log("individual consents",e),this.script=e.find(t=>t.source==="script"),this.cmp=e.find(t=>t.source==="cmp"),this.script?this.script.values.includes("auto")?this.overall=this.cmp?this.cleaned({source:"overall",values:this.cmp.values}):{source:"overall",values:["all"]}:this.overall=this.cleaned({source:"overall",values:this.script.values}):this.overall={source:"overall",values:["all"]},this.overall}findAll(){var e,t,n;return this.find(),{script:(e=this.script)==null?void 0:e.values,cmp:(t=this.cmp)==null?void 0:t.values,overall:(n=this.overall)==null?void 0:n.values}}cleaned(e){return{source:e.source,values:Array.from(bl(e.values))}}};s(es,"CompositeConsentFinder");var ts=class{constructor(e){this.window=e}scrape(){let t=new es(this.window).findAll();return{userConsent:t.overall,consent:t}}};s(ts,"UserConsentScraper");var nr=class{constructor(e){this.filteredFeatures=nr.getFeatureFilter(e)}static getFeatureFilter(e){let n=la(e,"triptease-features")||"auto",i=d(()=>{let[a]=Ve.find(new er(e.document)),{features:o}=ve(a.query);return o},n).toLowerCase();return i==="none"||i==="auto"?i:i.split(",").filter(a=>a!=="none"&&a!=="auto")}mergeFeatures(e,t){let n=d(()=>E.merge(e.features||{},t.features||{}),{});return this.filteredFeatures==="auto"?n:Object.entries(n).reduce((i,[a,o])=>(i[a]=o,this.filteredFeatures.includes(a.toLowerCase())&&(i[a].enabled=!0),this.filteredFeatures==="none"&&(i[a].enabled=!1),i),{})}};s(nr,"DefaultFeatureLoader");function zm(r,e){return f(this,null,function*(){let t=ce(r).triptease;O("integration-executor").log(`replaceExecutor old:${d(()=>t.integration.script.app().name)} new:${d(()=>e.script.app().name)}`),t.integration&&(yield t.integration.stop()),t.integration=e,yield e.start()})}s(zm,"replaceExecutor");var rs=class{constructor(e,t,n=Ii(e),i=O("integration-executor"),a=ce(e).onboard.messageBuilder,o=new Zi(new Yi(Mu(e))),c=new bi(o),u=hi(o),l=tr.create(e),h=new Ki(e,l),D=new nr(e),g=ul()){this.window=e;this.script=t;this.events=n;this.logger=i;this.messageBuilder=a;this.sender=o;this.kernel=c;this.kernelHost=u;this.history=l;this.processor=h;this.featureLoader=D;this.reporter=g;this.integrate=s(()=>f(this,null,function*(){this.logger.log("Begin integration executor");let e=yield this.reporter.timeAsync("page-scraping",()=>this.findPageData()),t=yield this.reporter.timeAsync("hotel-identification",()=>this.addIdentificationAndAdditionalData(e));t.language||(t.language=Xc(this.window));let n=this.processor.process(t);this.logger.log("Processed integration data",n);let i=this.lastPath!==this.window.location.pathname,a=!(yield this.history.isSameAsLastGeneration(n));return i||a?(this.logger.log("Integration data has changed - updating triptease.config"),this.window.triptease.config=n,yield this.history.add(n),yield this.sendToKernelHost(yield this.messageBuilder.buildMessage({type:"triptease.config",payload:Jm(n),context:{app:this.script.app()}})),this.lastPath=this.window.location.pathname):this.logger.log("No change in integration data - doing nothing"),n}),"integrate");zm(e,this)}start(){return f(this,null,function*(){this.logger.log(`IntegrationExecutor.start ${this.script.app().name}`),yield this.events.listen(this.integrate)})}stop(){return f(this,null,function*(){this.logger.log(`IntegrationExecutor.stop ${this.script.app().name}`),this.events.removeListener(this.integrate)})}addIdentificationAndAdditionalData(e){return f(this,null,function*(){let t=yield this.script.scrape(),n=yield new vi([new ts(this.window),new Ri(this.window),new Je(this.window),{scrape:()=>t},new ki(e)],this.logger).scrape();if(n.apiKey==="none")return this.logger.log('Skipping identification as apiKey is set to "none" - Only interested in page data for ARI feed'),e;if(n=S(m({},n),{type:Wm(e.type,t.type),integrationName:this.script.app().name}),this.logger.log("all identifiers",n),pa(e)&&Array.isArray(e.rateDetails)){e.rateDetails=yield this.processArrayIdentifiers(e.rateDetails,n);let o=this.getUniqueApiKey(e.rateDetails);o&&(n=S(m({},n),{apiKey:o}))}if(fa(e)&&Array.isArray(e.reservations)){e.reservations=yield this.processArrayIdentifiers(e.reservations,n);let o=this.getUniqueApiKey(e.reservations);o&&(n=S(m({},n),{apiKey:o}))}if(n.type===x.Group||n.disableDefaultHotelIdentification)this.logger.log("Disabling default hotel identification");else if(Br(n)||Br(e))this.logger.log("page data already contains identifiers (hotelName, hotelCode or apiKey) so skipping fallback identification");else{let o=new zi(this.window).scrape();this.logger.log("hotel identifiers",o),n=m(m({},n),o)}let i=yield this.kernel.generateConfig(n);this.logger.log("generatedConfig",i);let a=this.featureLoader.mergeFeatures(e,i);return this.logger.log("mergeFeatures",a),p.removeEmpty(S(m(m(m({},n),e),i),{features:a,address:fl(yield n.address),disableDefaultHotelIdentification:void 0,identifiers:this.filterOutPossibleUserData(n)}))})}filterOutPossibleUserData(e){return d(()=>e.identifiers.filter(t=>Wr.has(t.identifierType)))}getUniqueApiKey(e){let t=C.unique(e.map(n=>n.apiKey));if(t.length===1)return t[0]}processArrayIdentifiers(e,t){return f(this,null,function*(){return yield Promise.all(e.map(n=>f(this,null,function*(){return lt(n)?m(m({},n),yield this.kernel.generateConfig(m(S(m({},t),{apiKey:void 0}),xi(n)))):n})))})}sendToKernelHost(e){return f(this,null,function*(){this.logger.log("Sending triptease.config message to local kernel host",e);let t=S(m({},e),{context:S(m({},e.context),{stats:this.reporter.summarise()})});this.kernelHost.processConfig(t)})}findPageData(){return f(this,null,function*(){let e=[];for(let t of this.script.pages)try{let n=Eu(yield t.integrationData());if(n&&(n.pageClass=n.pageClass||Jo(t)),Iu(n))return this.logger.log("Found valid page",n),n;e.push(n)}catch(n){this.logger.debug("Page didn't parse due to error",n)}return this.logger.log("No valid pages found - finding partial page from",e),Ru(e)||{type:x.Unknown}})}};s(rs,"IntegrationExecutor");function Wm(...r){return C.first([...r,x.Unknown].filter(Boolean).sort((0,vl.by)(Fa)))}s(Wm,"calculatePageType");function Vm(r,e){var t,n;return!!((n=(t=r.features)==null?void 0:t[e])==null?void 0:n.enabled)}s(Vm,"isFeatureEnabled");function Jm(r){if(!r)return;let e=!Vm(r,"CartAbandonment"),t=m({},r);return e&&delete t.pii,t}s(Jm,"scrubPII");new rs(window,new di(window));})();
